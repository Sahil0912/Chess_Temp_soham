{"{\"assumptions\":{},\"sourceRoot\":\"/home/bayern/Chess_Temp/test/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/home/bayern/Chess_Temp\",\"filename\":\"/home/bayern/Chess_Temp/test/setup.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/bayern/Chess_Temp\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"transform-duplicate-named-capturing-groups-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-regexp-modifiers\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-unicode-sets-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/bayern/Chess_Temp/node_modules/@babel/preset-env/lib/index.js$3\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/bayern/Chess_Temp/node_modules/@babel/preset-env/lib/index.js$4\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/bayern/Chess_Temp/node_modules/@babel/preset-env/lib/index.js$5\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/bayern/Chess_Temp/node_modules/@babel/preset-env/lib/index.js$6\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/bayern/Chess_Temp/node_modules/@babel/preset-env/lib/index.js$7\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/bayern/Chess_Temp/node_modules/@babel/preset-env/lib/index.js$8\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/bayern/Chess_Temp/node_modules/@babel/preset-env/lib/index.js$9\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/bayern/Chess_Temp/node_modules/@babel/preset-env/lib/index.js$10\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/bayern/Chess_Temp/node_modules/@babel/preset-env/lib/index.js$11\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/bayern/Chess_Temp/node_modules/@babel/preset-env/lib/index.js$12\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/bayern/Chess_Temp/node_modules/@babel/preset-env/lib/index.js$16\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/bayern/Chess_Temp/node_modules/@babel/preset-env/lib/index.js$17\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.26.10:development":{"value":{"code":"\"use strict\";\n\nconst {\n  JSDOM\n} = require('jsdom');\nconst dom = new JSDOM(`\n  <!DOCTYPE html>\n  <html>\n    <body>\n      <button id=\"startGame\"></button>\n      <div id=\"chessboard\"></div>\n      <div id=\"promotionModal\"></div>\n      <!-- Add other required elements from your HTML -->\n    </body>\n  </html>\n`, {\n  url: 'http://localhost'\n});\nglobal.window = dom.window;\nglobal.document = dom.window.document;\nglobal.navigator = dom.window.navigator;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJKU0RPTSIsInJlcXVpcmUiLCJkb20iLCJ1cmwiLCJnbG9iYWwiLCJ3aW5kb3ciLCJkb2N1bWVudCIsIm5hdmlnYXRvciJdLCJzb3VyY2VSb290IjoiL2hvbWUvYmF5ZXJuL0NoZXNzX1RlbXAvdGVzdC8iLCJzb3VyY2VzIjpbInNldHVwLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHsgSlNET00gfSA9IHJlcXVpcmUoJ2pzZG9tJyk7XG5cbmNvbnN0IGRvbSA9IG5ldyBKU0RPTShgXG4gIDwhRE9DVFlQRSBodG1sPlxuICA8aHRtbD5cbiAgICA8Ym9keT5cbiAgICAgIDxidXR0b24gaWQ9XCJzdGFydEdhbWVcIj48L2J1dHRvbj5cbiAgICAgIDxkaXYgaWQ9XCJjaGVzc2JvYXJkXCI+PC9kaXY+XG4gICAgICA8ZGl2IGlkPVwicHJvbW90aW9uTW9kYWxcIj48L2Rpdj5cbiAgICAgIDwhLS0gQWRkIG90aGVyIHJlcXVpcmVkIGVsZW1lbnRzIGZyb20geW91ciBIVE1MIC0tPlxuICAgIDwvYm9keT5cbiAgPC9odG1sPlxuYCwgeyB1cmw6ICdodHRwOi8vbG9jYWxob3N0JyB9KTtcblxuZ2xvYmFsLndpbmRvdyA9IGRvbS53aW5kb3c7XG5nbG9iYWwuZG9jdW1lbnQgPSBkb20ud2luZG93LmRvY3VtZW50O1xuZ2xvYmFsLm5hdmlnYXRvciA9IGRvbS53aW5kb3cubmF2aWdhdG9yOyJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxNQUFNO0VBQUVBO0FBQU0sQ0FBQyxHQUFHQyxPQUFPLENBQUMsT0FBTyxDQUFDO0FBRWxDLE1BQU1DLEdBQUcsR0FBRyxJQUFJRixLQUFLLENBQUM7QUFDdEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxFQUFFO0VBQUVHLEdBQUcsRUFBRTtBQUFtQixDQUFDLENBQUM7QUFFL0JDLE1BQU0sQ0FBQ0MsTUFBTSxHQUFHSCxHQUFHLENBQUNHLE1BQU07QUFDMUJELE1BQU0sQ0FBQ0UsUUFBUSxHQUFHSixHQUFHLENBQUNHLE1BQU0sQ0FBQ0MsUUFBUTtBQUNyQ0YsTUFBTSxDQUFDRyxTQUFTLEdBQUdMLEdBQUcsQ0FBQ0csTUFBTSxDQUFDRSxTQUFTIiwiaWdub3JlTGlzdCI6W119","map":{"version":3,"names":["JSDOM","require","dom","url","global","window","document","navigator"],"sourceRoot":"/home/bayern/Chess_Temp/test/","sources":["setup.js"],"sourcesContent":["const { JSDOM } = require('jsdom');\n\nconst dom = new JSDOM(`\n  <!DOCTYPE html>\n  <html>\n    <body>\n      <button id=\"startGame\"></button>\n      <div id=\"chessboard\"></div>\n      <div id=\"promotionModal\"></div>\n      <!-- Add other required elements from your HTML -->\n    </body>\n  </html>\n`, { url: 'http://localhost' });\n\nglobal.window = dom.window;\nglobal.document = dom.window.document;\nglobal.navigator = dom.window.navigator;"],"mappings":";;AAAA,MAAM;EAAEA;AAAM,CAAC,GAAGC,OAAO,CAAC,OAAO,CAAC;AAElC,MAAMC,GAAG,GAAG,IAAIF,KAAK,CAAC;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,EAAE;EAAEG,GAAG,EAAE;AAAmB,CAAC,CAAC;AAE/BC,MAAM,CAACC,MAAM,GAAGH,GAAG,CAACG,MAAM;AAC1BD,MAAM,CAACE,QAAQ,GAAGJ,GAAG,CAACG,MAAM,CAACC,QAAQ;AACrCF,MAAM,CAACG,SAAS,GAAGL,GAAG,CAACG,MAAM,CAACE,SAAS","ignoreList":[]}},"mtime":1743325417691},"{\"assumptions\":{},\"sourceRoot\":\"/home/bayern/Chess_Temp/test/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/home/bayern/Chess_Temp\",\"filename\":\"/home/bayern/Chess_Temp/test/game.test.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/bayern/Chess_Temp\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"transform-duplicate-named-capturing-groups-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-regexp-modifiers\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-unicode-sets-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/bayern/Chess_Temp/node_modules/@babel/preset-env/lib/index.js$3\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/bayern/Chess_Temp/node_modules/@babel/preset-env/lib/index.js$4\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/bayern/Chess_Temp/node_modules/@babel/preset-env/lib/index.js$5\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/bayern/Chess_Temp/node_modules/@babel/preset-env/lib/index.js$6\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/bayern/Chess_Temp/node_modules/@babel/preset-env/lib/index.js$7\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/bayern/Chess_Temp/node_modules/@babel/preset-env/lib/index.js$8\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/bayern/Chess_Temp/node_modules/@babel/preset-env/lib/index.js$9\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/bayern/Chess_Temp/node_modules/@babel/preset-env/lib/index.js$10\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/bayern/Chess_Temp/node_modules/@babel/preset-env/lib/index.js$11\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/bayern/Chess_Temp/node_modules/@babel/preset-env/lib/index.js$12\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/bayern/Chess_Temp/node_modules/@babel/preset-env/lib/index.js$16\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/bayern/Chess_Temp/node_modules/@babel/preset-env/lib/index.js$17\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.26.10:development":{"value":{"code":"\"use strict\";\n\nconst {\n  expect\n} = require('chai');\nlet {\n  isPrime,\n  generateRookMoves,\n  generatePawnMoves,\n  isLegalMove,\n  initializeBoard,\n  checkForCheckmate,\n  isSquareAttacked,\n  serializeBoard,\n  cloneBoard,\n  getOpponent,\n  isInBounds,\n  isKingSafe,\n  performCastle,\n  canCastle,\n  isEnPassantMove,\n  generateMovesForPiece,\n  createPiece,\n  enPassantTarget\n} = require('../gameController');\ndescribe('Chess Game Tests', () => {\n  let testBoard;\n  before(() => {\n    // Create a fresh board with just the pieces we need for testing\n    testBoard = Array(8).fill().map(() => Array(8).fill(null));\n  });\n  beforeEach(() => {\n    testBoard = initializeBoard();\n  });\n  describe('Prime Number Validation', () => {\n    it('should identify prime numbers correctly', () => {\n      expect(isPrime(2)).to.be.true;\n      expect(isPrime(7)).to.be.true;\n      expect(isPrime(1)).to.be.false;\n      expect(isPrime(4)).to.be.false;\n      expect(isPrime(9)).to.be.false;\n    });\n  });\n  describe('Rook Movement', () => {\n    it('should only allow prime-numbered moves for all rooks', () => {\n      // Test both friendly and enemy rooks\n      testBoard = Array(8).fill().map(() => Array(8).fill(null));\n\n      // Friendly rook (white)\n      testBoard[3][3] = {\n        type: 'rook',\n        color: 'white',\n        hasMoved: false\n      };\n      const friendlyMoves = generateRookMoves(testBoard, {\n        row: 3,\n        col: 3\n      }, testBoard[3][3]);\n\n      // Enemy rook (black)\n      testBoard[4][4] = {\n        type: 'rook',\n        color: 'black',\n        hasMoved: false\n      };\n      const enemyMoves = generateRookMoves(testBoard, {\n        row: 4,\n        col: 4\n      }, testBoard[4][4]);\n      const allowedDistances = new Set([2, 3, 5, 7]);\n\n      // Verify both rooks follow prime movement rules\n      [...friendlyMoves, ...enemyMoves].forEach(move => {\n        const dx = Math.abs(move.to.col - move.from.col);\n        const dy = Math.abs(move.to.row - move.from.row);\n        const distance = dx + dy; // Since rook moves straight\n        expect(allowedDistances.has(distance)).to.be.true;\n      });\n    });\n  });\n  describe('Pawn Movement', () => {\n    let testBoard;\n    beforeEach(() => {\n      testBoard = Array(8).fill().map(() => Array(8).fill(null));\n      enPassantTarget = null; // Reset enPassant target\n    });\n\n    // it('should detect en passant opportunities', () => {\n    //   // Set up pawns\n    //   testBoard[3][3] = { type: 'pawn', color: 'white', hasMoved: true };\n    //   testBoard[3][4] = { type: 'pawn', color: 'black', hasMoved: true };\n\n    //   // Simulate the double-step pawn move that creates en passant opportunity\n    //   const move = {\n    //     from: { row: 1, col: 4 },\n    //     to: { row: 3, col: 4 },\n    //     piece: testBoard[3][4],\n    //     color: 'black'\n    //   };\n\n    //   // Update enPassantTarget as the game would\n    //   enPassantTarget = { row: 2, col: 4 };\n\n    //   // Get white pawn's moves\n    //   const whitePawnMoves = generatePawnMoves(testBoard, { row: 3, col: 3 }, testBoard[3][3]);\n\n    //   // Verify en passant move exists diagonally\n    //   expect(whitePawnMoves).to.deep.include({\n    //     from: { row: 3, col: 3 },\n    //     to: { row: 2, col: 4 },\n    //     piece: testBoard[3][3],\n    //     enPassant: true\n    //   });\n    // });\n\n    it('should trigger promotion on last rank', () => {\n      const pawn = {\n        type: 'pawn',\n        color: 'white',\n        hasMoved: true\n      };\n      testBoard[1][0] = pawn;\n      const moves = generatePawnMoves(testBoard, {\n        row: 1,\n        col: 0\n      }, pawn);\n      expect(moves.some(m => m.to.row === 0)).to.be.true;\n    });\n  });\n  describe('Check Detection', () => {\n    let testBoard;\n    beforeEach(() => {\n      testBoard = Array(8).fill().map(() => Array(8).fill(null));\n    });\n    it('should identify attacked squares', () => {\n      // Place black rook in same column as white king\n      testBoard[0][4] = createPiece('rook', 'black'); // Top of column 4\n      testBoard[4][4] = createPiece('king', 'white'); // Center king\n\n      expect(isSquareAttacked(testBoard, {\n        row: 4,\n        col: 4\n      }, 'black')).to.be.true;\n    });\n    it('should detect checkmate state', () => {\n      // Proper checkmate setup\n      testBoard[7][4] = createPiece('king', 'white'); // White king in corner\n      testBoard[6][3] = createPiece('queen', 'black'); // Queen attacking diagonally\n      testBoard[7][5] = createPiece('rook', 'black'); // Rook blocking escape\n\n      // Verify no legal moves\n      expect(checkForCheckmate(testBoard, 'white')).to.be.true;\n    });\n  });\n  describe('Castling', () => {\n    beforeEach(() => {\n      // Create fresh board with only necessary pieces\n      testBoard = Array(8).fill().map(() => Array(8).fill(null));\n\n      // Set up castling scenario\n      testBoard[7][4] = createPiece('king', 'white'); // White king\n      testBoard[7][7] = createPiece('rook', 'white'); // Kingside rook\n    });\n    it('should allow kingside castling when valid', () => {\n      testBoard[7][5] = null;\n      testBoard[7][6] = null;\n      const king = testBoard[7][4]; // Don't forget to define king\n\n      expect(canCastle(testBoard, king, {\n        side: 'kingside',\n        pos: {\n          row: 7,\n          col: 4\n        }\n      })).to.be.true;\n    });\n    it('should prevent castling through attacked squares', () => {\n      testBoard[7][5] = null;\n      testBoard[7][6] = null;\n      testBoard[6][5] = {\n        type: 'bishop',\n        color: 'black',\n        hasMoved: true\n      };\n      const king = testBoard[7][4]; // Don't forget to define king\n\n      expect(canCastle(testBoard, king, {\n        side: 'kingside',\n        pos: {\n          row: 7,\n          col: 4\n        }\n      })).to.be.false;\n    });\n  });\n  describe('Board State Management', () => {\n    // it('should clone board correctly', () => {\n    //   const cloned = cloneBoard(testBoard);\n    //   cloned[0][0].hasMoved = true;\n    //   expect(testBoard[0][0].hasMoved).to.be.false;\n    // });\n\n    // it('should serialize board state', () => {\n    //   const serialized = serializeBoard(testBoard);\n    //   expect(serialized).to.include('rw|bw'); // Rook white and bishop white\n    // });\n  });\n  describe('Helper Functions', () => {\n    it('should identify opponent color', () => {\n      testBoard = Array(8).fill().map(() => Array(8).fill(null));\n      expect(getOpponent('white')).to.equal('black');\n      expect(getOpponent('black')).to.equal('white');\n    });\n    it('should validate board boundaries', () => {\n      testBoard = Array(8).fill().map(() => Array(8).fill(null));\n      expect(isInBounds(7, 7)).to.be.true;\n      expect(isInBounds(-1, 3)).to.be.false;\n      expect(isInBounds(4, 8)).to.be.false;\n    });\n\n    // it('should generate all legal moves', () => {\n    //   testBoard = Array(8).fill().map(() => Array(8).fill(null));\n    //   const initialMoves = generateMovesForPiece(testBoard, { row: 6, col: 0 }, testBoard[6][0]);\n    //   expect(initialMoves).to.have.lengthOf(2); // Initial pawn move\n    // });\n  });\n  describe('Special Moves', () => {\n    let testBoard;\n    beforeEach(() => {\n      // Create fresh board with proper castling setup\n      testBoard = Array(8).fill().map(() => Array(8).fill(null));\n      testBoard[7][4] = {\n        type: 'king',\n        color: 'white',\n        hasMoved: false // Crucial for castling\n      };\n      testBoard[7][7] = {\n        type: 'rook',\n        color: 'white',\n        hasMoved: false // Crucial for castling\n      };\n      // Clear the castling path\n      testBoard[7][5] = null;\n      testBoard[7][6] = null;\n    });\n    it('should detect en passant moves', () => {\n      testBoard = Array(8).fill().map(() => Array(8).fill(null));\n      const move = {\n        piece: {\n          type: 'pawn',\n          color: 'black'\n        },\n        from: {\n          row: 1,\n          col: 3\n        },\n        to: {\n          row: 3,\n          col: 3\n        }\n      };\n      expect(isEnPassantMove(move)).to.be.false; // Should only be true in specific context\n    });\n\n    //   it('should execute castling correctly', () => {\n    //   const king = testBoard[7][4];\n    //   const castleMove = {\n    //     from: { row: 7, col: 4 },\n    //     to: { row: 7, col: 6 },\n    //     piece: king,\n    //     castle: 'kingside'\n    //   };\n\n    //   performCastle(castleMove);\n\n    //   // Verify king moved\n    //   expect(testBoard[7][6]).to.deep.equal({\n    //     type: 'king',\n    //     color: 'white',\n    //     hasMoved: true\n    //   });\n\n    //   // Verify rook moved\n    //   expect(testBoard[7][5]).to.deep.equal({\n    //     type: 'rook',\n    //     color: 'white',\n    //     hasMoved: true\n    //   });\n\n    //   // Verify original positions are empty\n    //   expect(testBoard[7][4]).to.be.null;\n    //   expect(testBoard[7][7]).to.be.null;\n    // });\n  });\n});\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleHBlY3QiLCJyZXF1aXJlIiwiaXNQcmltZSIsImdlbmVyYXRlUm9va01vdmVzIiwiZ2VuZXJhdGVQYXduTW92ZXMiLCJpc0xlZ2FsTW92ZSIsImluaXRpYWxpemVCb2FyZCIsImNoZWNrRm9yQ2hlY2ttYXRlIiwiaXNTcXVhcmVBdHRhY2tlZCIsInNlcmlhbGl6ZUJvYXJkIiwiY2xvbmVCb2FyZCIsImdldE9wcG9uZW50IiwiaXNJbkJvdW5kcyIsImlzS2luZ1NhZmUiLCJwZXJmb3JtQ2FzdGxlIiwiY2FuQ2FzdGxlIiwiaXNFblBhc3NhbnRNb3ZlIiwiZ2VuZXJhdGVNb3Zlc0ZvclBpZWNlIiwiY3JlYXRlUGllY2UiLCJlblBhc3NhbnRUYXJnZXQiLCJkZXNjcmliZSIsInRlc3RCb2FyZCIsImJlZm9yZSIsIkFycmF5IiwiZmlsbCIsIm1hcCIsImJlZm9yZUVhY2giLCJpdCIsInRvIiwiYmUiLCJ0cnVlIiwiZmFsc2UiLCJ0eXBlIiwiY29sb3IiLCJoYXNNb3ZlZCIsImZyaWVuZGx5TW92ZXMiLCJyb3ciLCJjb2wiLCJlbmVteU1vdmVzIiwiYWxsb3dlZERpc3RhbmNlcyIsIlNldCIsImZvckVhY2giLCJtb3ZlIiwiZHgiLCJNYXRoIiwiYWJzIiwiZnJvbSIsImR5IiwiZGlzdGFuY2UiLCJoYXMiLCJwYXduIiwibW92ZXMiLCJzb21lIiwibSIsImtpbmciLCJzaWRlIiwicG9zIiwiZXF1YWwiLCJwaWVjZSJdLCJzb3VyY2VSb290IjoiL2hvbWUvYmF5ZXJuL0NoZXNzX1RlbXAvdGVzdC8iLCJzb3VyY2VzIjpbImdhbWUudGVzdC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCB7IGV4cGVjdCB9ID0gcmVxdWlyZSgnY2hhaScpO1xubGV0IHtcbiAgaXNQcmltZSxcbiAgZ2VuZXJhdGVSb29rTW92ZXMsXG4gIGdlbmVyYXRlUGF3bk1vdmVzLFxuICBpc0xlZ2FsTW92ZSxcbiAgaW5pdGlhbGl6ZUJvYXJkLFxuICBjaGVja0ZvckNoZWNrbWF0ZSxcbiAgaXNTcXVhcmVBdHRhY2tlZCxcbiAgc2VyaWFsaXplQm9hcmQsXG4gIGNsb25lQm9hcmQsXG4gIGdldE9wcG9uZW50LFxuICBpc0luQm91bmRzLFxuICBpc0tpbmdTYWZlLFxuICBwZXJmb3JtQ2FzdGxlLFxuICBjYW5DYXN0bGUsXG4gIGlzRW5QYXNzYW50TW92ZSxcbiAgZ2VuZXJhdGVNb3Zlc0ZvclBpZWNlLFxuICBjcmVhdGVQaWVjZSxcbiAgZW5QYXNzYW50VGFyZ2V0XG59ID0gcmVxdWlyZSgnLi4vZ2FtZUNvbnRyb2xsZXInKTtcblxuZGVzY3JpYmUoJ0NoZXNzIEdhbWUgVGVzdHMnLCAoKSA9PiB7XG4gIGxldCB0ZXN0Qm9hcmQ7XG5cbiAgYmVmb3JlKCgpID0+IHtcbiAgICAvLyBDcmVhdGUgYSBmcmVzaCBib2FyZCB3aXRoIGp1c3QgdGhlIHBpZWNlcyB3ZSBuZWVkIGZvciB0ZXN0aW5nXG4gICAgdGVzdEJvYXJkID0gQXJyYXkoOCkuZmlsbCgpLm1hcCgoKSA9PiBBcnJheSg4KS5maWxsKG51bGwpKTtcbiAgfSk7XG5cbiAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgdGVzdEJvYXJkID0gaW5pdGlhbGl6ZUJvYXJkKCk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdQcmltZSBOdW1iZXIgVmFsaWRhdGlvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGlkZW50aWZ5IHByaW1lIG51bWJlcnMgY29ycmVjdGx5JywgKCkgPT4ge1xuICAgICAgZXhwZWN0KGlzUHJpbWUoMikpLnRvLmJlLnRydWU7XG4gICAgICBleHBlY3QoaXNQcmltZSg3KSkudG8uYmUudHJ1ZTtcbiAgICAgIGV4cGVjdChpc1ByaW1lKDEpKS50by5iZS5mYWxzZTtcbiAgICAgIGV4cGVjdChpc1ByaW1lKDQpKS50by5iZS5mYWxzZTtcbiAgICAgIGV4cGVjdChpc1ByaW1lKDkpKS50by5iZS5mYWxzZTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1Jvb2sgTW92ZW1lbnQnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBvbmx5IGFsbG93IHByaW1lLW51bWJlcmVkIG1vdmVzIGZvciBhbGwgcm9va3MnLCAoKSA9PiB7XG4gICAgICAvLyBUZXN0IGJvdGggZnJpZW5kbHkgYW5kIGVuZW15IHJvb2tzXG4gICAgICB0ZXN0Qm9hcmQgPSBBcnJheSg4KS5maWxsKCkubWFwKCgpID0+IEFycmF5KDgpLmZpbGwobnVsbCkpO1xuICAgICAgXG4gICAgICAvLyBGcmllbmRseSByb29rICh3aGl0ZSlcbiAgICAgIHRlc3RCb2FyZFszXVszXSA9IHsgdHlwZTogJ3Jvb2snLCBjb2xvcjogJ3doaXRlJywgaGFzTW92ZWQ6IGZhbHNlIH07XG4gICAgICBjb25zdCBmcmllbmRseU1vdmVzID0gZ2VuZXJhdGVSb29rTW92ZXModGVzdEJvYXJkLCB7IHJvdzogMywgY29sOiAzIH0sIHRlc3RCb2FyZFszXVszXSk7XG4gICAgICBcbiAgICAgIC8vIEVuZW15IHJvb2sgKGJsYWNrKVxuICAgICAgdGVzdEJvYXJkWzRdWzRdID0geyB0eXBlOiAncm9vaycsIGNvbG9yOiAnYmxhY2snLCBoYXNNb3ZlZDogZmFsc2UgfTtcbiAgICAgIGNvbnN0IGVuZW15TW92ZXMgPSBnZW5lcmF0ZVJvb2tNb3Zlcyh0ZXN0Qm9hcmQsIHsgcm93OiA0LCBjb2w6IDQgfSwgdGVzdEJvYXJkWzRdWzRdKTtcbiAgICAgIFxuICAgICAgY29uc3QgYWxsb3dlZERpc3RhbmNlcyA9IG5ldyBTZXQoWzIsIDMsIDUsIDddKTtcbiAgICAgIFxuICAgICAgLy8gVmVyaWZ5IGJvdGggcm9va3MgZm9sbG93IHByaW1lIG1vdmVtZW50IHJ1bGVzXG4gICAgICBbLi4uZnJpZW5kbHlNb3ZlcywgLi4uZW5lbXlNb3Zlc10uZm9yRWFjaChtb3ZlID0+IHtcbiAgICAgICAgY29uc3QgZHggPSBNYXRoLmFicyhtb3ZlLnRvLmNvbCAtIG1vdmUuZnJvbS5jb2wpO1xuICAgICAgICBjb25zdCBkeSA9IE1hdGguYWJzKG1vdmUudG8ucm93IC0gbW92ZS5mcm9tLnJvdyk7XG4gICAgICAgIGNvbnN0IGRpc3RhbmNlID0gZHggKyBkeTsgLy8gU2luY2Ugcm9vayBtb3ZlcyBzdHJhaWdodFxuICAgICAgICBleHBlY3QoYWxsb3dlZERpc3RhbmNlcy5oYXMoZGlzdGFuY2UpKS50by5iZS50cnVlO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdQYXduIE1vdmVtZW50JywgKCkgPT4ge1xuICAgIGxldCB0ZXN0Qm9hcmQ7XG4gIFxuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgICAgdGVzdEJvYXJkID0gQXJyYXkoOCkuZmlsbCgpLm1hcCgoKSA9PiBBcnJheSg4KS5maWxsKG51bGwpKTtcbiAgICAgIGVuUGFzc2FudFRhcmdldCA9IG51bGw7IC8vIFJlc2V0IGVuUGFzc2FudCB0YXJnZXRcbiAgICB9KTtcbiAgXG4gICAgLy8gaXQoJ3Nob3VsZCBkZXRlY3QgZW4gcGFzc2FudCBvcHBvcnR1bml0aWVzJywgKCkgPT4ge1xuICAgIC8vICAgLy8gU2V0IHVwIHBhd25zXG4gICAgLy8gICB0ZXN0Qm9hcmRbM11bM10gPSB7IHR5cGU6ICdwYXduJywgY29sb3I6ICd3aGl0ZScsIGhhc01vdmVkOiB0cnVlIH07XG4gICAgLy8gICB0ZXN0Qm9hcmRbM11bNF0gPSB7IHR5cGU6ICdwYXduJywgY29sb3I6ICdibGFjaycsIGhhc01vdmVkOiB0cnVlIH07XG4gIFxuICAgIC8vICAgLy8gU2ltdWxhdGUgdGhlIGRvdWJsZS1zdGVwIHBhd24gbW92ZSB0aGF0IGNyZWF0ZXMgZW4gcGFzc2FudCBvcHBvcnR1bml0eVxuICAgIC8vICAgY29uc3QgbW92ZSA9IHtcbiAgICAvLyAgICAgZnJvbTogeyByb3c6IDEsIGNvbDogNCB9LFxuICAgIC8vICAgICB0bzogeyByb3c6IDMsIGNvbDogNCB9LFxuICAgIC8vICAgICBwaWVjZTogdGVzdEJvYXJkWzNdWzRdLFxuICAgIC8vICAgICBjb2xvcjogJ2JsYWNrJ1xuICAgIC8vICAgfTtcbiAgICAgIFxuICAgIC8vICAgLy8gVXBkYXRlIGVuUGFzc2FudFRhcmdldCBhcyB0aGUgZ2FtZSB3b3VsZFxuICAgIC8vICAgZW5QYXNzYW50VGFyZ2V0ID0geyByb3c6IDIsIGNvbDogNCB9O1xuICBcbiAgICAvLyAgIC8vIEdldCB3aGl0ZSBwYXduJ3MgbW92ZXNcbiAgICAvLyAgIGNvbnN0IHdoaXRlUGF3bk1vdmVzID0gZ2VuZXJhdGVQYXduTW92ZXModGVzdEJvYXJkLCB7IHJvdzogMywgY29sOiAzIH0sIHRlc3RCb2FyZFszXVszXSk7XG4gICAgICBcbiAgICAvLyAgIC8vIFZlcmlmeSBlbiBwYXNzYW50IG1vdmUgZXhpc3RzIGRpYWdvbmFsbHlcbiAgICAvLyAgIGV4cGVjdCh3aGl0ZVBhd25Nb3ZlcykudG8uZGVlcC5pbmNsdWRlKHtcbiAgICAvLyAgICAgZnJvbTogeyByb3c6IDMsIGNvbDogMyB9LFxuICAgIC8vICAgICB0bzogeyByb3c6IDIsIGNvbDogNCB9LFxuICAgIC8vICAgICBwaWVjZTogdGVzdEJvYXJkWzNdWzNdLFxuICAgIC8vICAgICBlblBhc3NhbnQ6IHRydWVcbiAgICAvLyAgIH0pO1xuICAgIC8vIH0pO1xuICBcbiAgICBpdCgnc2hvdWxkIHRyaWdnZXIgcHJvbW90aW9uIG9uIGxhc3QgcmFuaycsICgpID0+IHtcbiAgICAgIGNvbnN0IHBhd24gPSB7IHR5cGU6ICdwYXduJywgY29sb3I6ICd3aGl0ZScsIGhhc01vdmVkOiB0cnVlIH07XG4gICAgICB0ZXN0Qm9hcmRbMV1bMF0gPSBwYXduO1xuICAgICAgXG4gICAgICBjb25zdCBtb3ZlcyA9IGdlbmVyYXRlUGF3bk1vdmVzKHRlc3RCb2FyZCwgeyByb3c6IDEsIGNvbDogMCB9LCBwYXduKTtcbiAgICAgIGV4cGVjdChtb3Zlcy5zb21lKG0gPT4gbS50by5yb3cgPT09IDApKS50by5iZS50cnVlO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnQ2hlY2sgRGV0ZWN0aW9uJywgKCkgPT4ge1xuICAgIGxldCB0ZXN0Qm9hcmQ7XG4gIFxuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgICAgdGVzdEJvYXJkID0gQXJyYXkoOCkuZmlsbCgpLm1hcCgoKSA9PiBBcnJheSg4KS5maWxsKG51bGwpKTtcbiAgICB9KTtcbiAgXG4gICAgaXQoJ3Nob3VsZCBpZGVudGlmeSBhdHRhY2tlZCBzcXVhcmVzJywgKCkgPT4ge1xuICAgICAgLy8gUGxhY2UgYmxhY2sgcm9vayBpbiBzYW1lIGNvbHVtbiBhcyB3aGl0ZSBraW5nXG4gICAgICB0ZXN0Qm9hcmRbMF1bNF0gPSBjcmVhdGVQaWVjZSgncm9vaycsICdibGFjaycpOyAvLyBUb3Agb2YgY29sdW1uIDRcbiAgICAgIHRlc3RCb2FyZFs0XVs0XSA9IGNyZWF0ZVBpZWNlKCdraW5nJywgJ3doaXRlJyk7IC8vIENlbnRlciBraW5nXG4gICAgICBcbiAgICAgIGV4cGVjdChpc1NxdWFyZUF0dGFja2VkKHRlc3RCb2FyZCwgeyByb3c6IDQsIGNvbDogNCB9LCAnYmxhY2snKSkudG8uYmUudHJ1ZTtcbiAgICB9KTtcbiAgXG4gICAgaXQoJ3Nob3VsZCBkZXRlY3QgY2hlY2ttYXRlIHN0YXRlJywgKCkgPT4ge1xuICAgICAgLy8gUHJvcGVyIGNoZWNrbWF0ZSBzZXR1cFxuICAgICAgdGVzdEJvYXJkWzddWzRdID0gY3JlYXRlUGllY2UoJ2tpbmcnLCAnd2hpdGUnKTsgLy8gV2hpdGUga2luZyBpbiBjb3JuZXJcbiAgICAgIHRlc3RCb2FyZFs2XVszXSA9IGNyZWF0ZVBpZWNlKCdxdWVlbicsICdibGFjaycpOyAvLyBRdWVlbiBhdHRhY2tpbmcgZGlhZ29uYWxseVxuICAgICAgdGVzdEJvYXJkWzddWzVdID0gY3JlYXRlUGllY2UoJ3Jvb2snLCAnYmxhY2snKTsgLy8gUm9vayBibG9ja2luZyBlc2NhcGVcbiAgICAgIFxuICAgICAgLy8gVmVyaWZ5IG5vIGxlZ2FsIG1vdmVzXG4gICAgICBleHBlY3QoY2hlY2tGb3JDaGVja21hdGUodGVzdEJvYXJkLCAnd2hpdGUnKSkudG8uYmUudHJ1ZTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0Nhc3RsaW5nJywgKCkgPT4ge1xuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgICAgLy8gQ3JlYXRlIGZyZXNoIGJvYXJkIHdpdGggb25seSBuZWNlc3NhcnkgcGllY2VzXG4gICAgICB0ZXN0Qm9hcmQgPSBBcnJheSg4KS5maWxsKCkubWFwKCgpID0+IEFycmF5KDgpLmZpbGwobnVsbCkpO1xuICAgICAgXG4gICAgICAvLyBTZXQgdXAgY2FzdGxpbmcgc2NlbmFyaW9cbiAgICAgIHRlc3RCb2FyZFs3XVs0XSA9IGNyZWF0ZVBpZWNlKCdraW5nJywgJ3doaXRlJyk7ICAvLyBXaGl0ZSBraW5nXG4gICAgICB0ZXN0Qm9hcmRbN11bN10gPSBjcmVhdGVQaWVjZSgncm9vaycsICd3aGl0ZScpOyAgLy8gS2luZ3NpZGUgcm9va1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBhbGxvdyBraW5nc2lkZSBjYXN0bGluZyB3aGVuIHZhbGlkJywgKCkgPT4ge1xuICAgICAgdGVzdEJvYXJkWzddWzVdID0gbnVsbDtcbiAgICAgIHRlc3RCb2FyZFs3XVs2XSA9IG51bGw7XG4gICAgICBjb25zdCBraW5nID0gdGVzdEJvYXJkWzddWzRdOyAvLyBEb24ndCBmb3JnZXQgdG8gZGVmaW5lIGtpbmdcbiAgICAgIFxuICAgICAgZXhwZWN0KGNhbkNhc3RsZSh0ZXN0Qm9hcmQsIGtpbmcsIHsgc2lkZTogJ2tpbmdzaWRlJywgcG9zOiB7IHJvdzogNywgY29sOiA0IH19KSkudG8uYmUudHJ1ZTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcHJldmVudCBjYXN0bGluZyB0aHJvdWdoIGF0dGFja2VkIHNxdWFyZXMnLCAoKSA9PiB7XG4gICAgICB0ZXN0Qm9hcmRbN11bNV0gPSBudWxsO1xuICAgICAgdGVzdEJvYXJkWzddWzZdID0gbnVsbDtcbiAgICAgIHRlc3RCb2FyZFs2XVs1XSA9IHsgdHlwZTogJ2Jpc2hvcCcsIGNvbG9yOiAnYmxhY2snLCBoYXNNb3ZlZDogdHJ1ZSB9O1xuICAgICAgY29uc3Qga2luZyA9IHRlc3RCb2FyZFs3XVs0XTsgLy8gRG9uJ3QgZm9yZ2V0IHRvIGRlZmluZSBraW5nXG4gICAgICBcbiAgICAgIGV4cGVjdChjYW5DYXN0bGUodGVzdEJvYXJkLCBraW5nLCB7IHNpZGU6ICdraW5nc2lkZScsIHBvczogeyByb3c6IDcsIGNvbDogNCB9fSkpLnRvLmJlLmZhbHNlO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnQm9hcmQgU3RhdGUgTWFuYWdlbWVudCcsICgpID0+IHtcbiAgICAvLyBpdCgnc2hvdWxkIGNsb25lIGJvYXJkIGNvcnJlY3RseScsICgpID0+IHtcbiAgICAvLyAgIGNvbnN0IGNsb25lZCA9IGNsb25lQm9hcmQodGVzdEJvYXJkKTtcbiAgICAvLyAgIGNsb25lZFswXVswXS5oYXNNb3ZlZCA9IHRydWU7XG4gICAgLy8gICBleHBlY3QodGVzdEJvYXJkWzBdWzBdLmhhc01vdmVkKS50by5iZS5mYWxzZTtcbiAgICAvLyB9KTtcblxuICAgIC8vIGl0KCdzaG91bGQgc2VyaWFsaXplIGJvYXJkIHN0YXRlJywgKCkgPT4ge1xuICAgIC8vICAgY29uc3Qgc2VyaWFsaXplZCA9IHNlcmlhbGl6ZUJvYXJkKHRlc3RCb2FyZCk7XG4gICAgLy8gICBleHBlY3Qoc2VyaWFsaXplZCkudG8uaW5jbHVkZSgncnd8YncnKTsgLy8gUm9vayB3aGl0ZSBhbmQgYmlzaG9wIHdoaXRlXG4gICAgLy8gfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdIZWxwZXIgRnVuY3Rpb25zJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaWRlbnRpZnkgb3Bwb25lbnQgY29sb3InLCAoKSA9PiB7XG4gICAgICB0ZXN0Qm9hcmQgPSBBcnJheSg4KS5maWxsKCkubWFwKCgpID0+IEFycmF5KDgpLmZpbGwobnVsbCkpO1xuICAgICAgZXhwZWN0KGdldE9wcG9uZW50KCd3aGl0ZScpKS50by5lcXVhbCgnYmxhY2snKTtcbiAgICAgIGV4cGVjdChnZXRPcHBvbmVudCgnYmxhY2snKSkudG8uZXF1YWwoJ3doaXRlJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHZhbGlkYXRlIGJvYXJkIGJvdW5kYXJpZXMnLCAoKSA9PiB7XG4gICAgICB0ZXN0Qm9hcmQgPSBBcnJheSg4KS5maWxsKCkubWFwKCgpID0+IEFycmF5KDgpLmZpbGwobnVsbCkpO1xuICAgICAgZXhwZWN0KGlzSW5Cb3VuZHMoNywgNykpLnRvLmJlLnRydWU7XG4gICAgICBleHBlY3QoaXNJbkJvdW5kcygtMSwgMykpLnRvLmJlLmZhbHNlO1xuICAgICAgZXhwZWN0KGlzSW5Cb3VuZHMoNCwgOCkpLnRvLmJlLmZhbHNlO1xuICAgIH0pO1xuXG4gICAgLy8gaXQoJ3Nob3VsZCBnZW5lcmF0ZSBhbGwgbGVnYWwgbW92ZXMnLCAoKSA9PiB7XG4gICAgLy8gICB0ZXN0Qm9hcmQgPSBBcnJheSg4KS5maWxsKCkubWFwKCgpID0+IEFycmF5KDgpLmZpbGwobnVsbCkpO1xuICAgIC8vICAgY29uc3QgaW5pdGlhbE1vdmVzID0gZ2VuZXJhdGVNb3Zlc0ZvclBpZWNlKHRlc3RCb2FyZCwgeyByb3c6IDYsIGNvbDogMCB9LCB0ZXN0Qm9hcmRbNl1bMF0pO1xuICAgIC8vICAgZXhwZWN0KGluaXRpYWxNb3ZlcykudG8uaGF2ZS5sZW5ndGhPZigyKTsgLy8gSW5pdGlhbCBwYXduIG1vdmVcbiAgICAvLyB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1NwZWNpYWwgTW92ZXMnLCAoKSA9PiB7XG4gICAgbGV0IHRlc3RCb2FyZDtcblxuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgICAgLy8gQ3JlYXRlIGZyZXNoIGJvYXJkIHdpdGggcHJvcGVyIGNhc3RsaW5nIHNldHVwXG4gICAgICB0ZXN0Qm9hcmQgPSBBcnJheSg4KS5maWxsKCkubWFwKCgpID0+IEFycmF5KDgpLmZpbGwobnVsbCkpO1xuICAgICAgdGVzdEJvYXJkWzddWzRdID0geyBcbiAgICAgICAgdHlwZTogJ2tpbmcnLCBcbiAgICAgICAgY29sb3I6ICd3aGl0ZScsIFxuICAgICAgICBoYXNNb3ZlZDogZmFsc2UgIC8vIENydWNpYWwgZm9yIGNhc3RsaW5nXG4gICAgICB9O1xuICAgICAgdGVzdEJvYXJkWzddWzddID0geyBcbiAgICAgICAgdHlwZTogJ3Jvb2snLCBcbiAgICAgICAgY29sb3I6ICd3aGl0ZScsIFxuICAgICAgICBoYXNNb3ZlZDogZmFsc2UgIC8vIENydWNpYWwgZm9yIGNhc3RsaW5nXG4gICAgICB9O1xuICAgICAgLy8gQ2xlYXIgdGhlIGNhc3RsaW5nIHBhdGhcbiAgICAgIHRlc3RCb2FyZFs3XVs1XSA9IG51bGw7XG4gICAgICB0ZXN0Qm9hcmRbN11bNl0gPSBudWxsO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBkZXRlY3QgZW4gcGFzc2FudCBtb3ZlcycsICgpID0+IHtcbiAgICAgIHRlc3RCb2FyZCA9IEFycmF5KDgpLmZpbGwoKS5tYXAoKCkgPT4gQXJyYXkoOCkuZmlsbChudWxsKSk7XG4gICAgICBjb25zdCBtb3ZlID0ge1xuICAgICAgICBwaWVjZTogeyB0eXBlOiAncGF3bicsIGNvbG9yOiAnYmxhY2snIH0sXG4gICAgICAgIGZyb206IHsgcm93OiAxLCBjb2w6IDMgfSxcbiAgICAgICAgdG86IHsgcm93OiAzLCBjb2w6IDMgfVxuICAgICAgfTtcbiAgICAgIGV4cGVjdChpc0VuUGFzc2FudE1vdmUobW92ZSkpLnRvLmJlLmZhbHNlOyAvLyBTaG91bGQgb25seSBiZSB0cnVlIGluIHNwZWNpZmljIGNvbnRleHRcbiAgICB9KTtcblxuICAvLyAgIGl0KCdzaG91bGQgZXhlY3V0ZSBjYXN0bGluZyBjb3JyZWN0bHknLCAoKSA9PiB7XG4gIC8vICAgY29uc3Qga2luZyA9IHRlc3RCb2FyZFs3XVs0XTtcbiAgLy8gICBjb25zdCBjYXN0bGVNb3ZlID0ge1xuICAvLyAgICAgZnJvbTogeyByb3c6IDcsIGNvbDogNCB9LFxuICAvLyAgICAgdG86IHsgcm93OiA3LCBjb2w6IDYgfSxcbiAgLy8gICAgIHBpZWNlOiBraW5nLFxuICAvLyAgICAgY2FzdGxlOiAna2luZ3NpZGUnXG4gIC8vICAgfTtcblxuICAvLyAgIHBlcmZvcm1DYXN0bGUoY2FzdGxlTW92ZSk7XG5cbiAgLy8gICAvLyBWZXJpZnkga2luZyBtb3ZlZFxuICAvLyAgIGV4cGVjdCh0ZXN0Qm9hcmRbN11bNl0pLnRvLmRlZXAuZXF1YWwoe1xuICAvLyAgICAgdHlwZTogJ2tpbmcnLFxuICAvLyAgICAgY29sb3I6ICd3aGl0ZScsXG4gIC8vICAgICBoYXNNb3ZlZDogdHJ1ZVxuICAvLyAgIH0pO1xuICAgIFxuICAvLyAgIC8vIFZlcmlmeSByb29rIG1vdmVkXG4gIC8vICAgZXhwZWN0KHRlc3RCb2FyZFs3XVs1XSkudG8uZGVlcC5lcXVhbCh7XG4gIC8vICAgICB0eXBlOiAncm9vaycsXG4gIC8vICAgICBjb2xvcjogJ3doaXRlJyxcbiAgLy8gICAgIGhhc01vdmVkOiB0cnVlXG4gIC8vICAgfSk7XG4gICAgXG4gIC8vICAgLy8gVmVyaWZ5IG9yaWdpbmFsIHBvc2l0aW9ucyBhcmUgZW1wdHlcbiAgLy8gICBleHBlY3QodGVzdEJvYXJkWzddWzRdKS50by5iZS5udWxsO1xuICAvLyAgIGV4cGVjdCh0ZXN0Qm9hcmRbN11bN10pLnRvLmJlLm51bGw7XG4gIC8vIH0pO1xufSk7XG59KTsiXSwibWFwcGluZ3MiOiI7O0FBQUEsTUFBTTtFQUFFQTtBQUFPLENBQUMsR0FBR0MsT0FBTyxDQUFDLE1BQU0sQ0FBQztBQUNsQyxJQUFJO0VBQ0ZDLE9BQU87RUFDUEMsaUJBQWlCO0VBQ2pCQyxpQkFBaUI7RUFDakJDLFdBQVc7RUFDWEMsZUFBZTtFQUNmQyxpQkFBaUI7RUFDakJDLGdCQUFnQjtFQUNoQkMsY0FBYztFQUNkQyxVQUFVO0VBQ1ZDLFdBQVc7RUFDWEMsVUFBVTtFQUNWQyxVQUFVO0VBQ1ZDLGFBQWE7RUFDYkMsU0FBUztFQUNUQyxlQUFlO0VBQ2ZDLHFCQUFxQjtFQUNyQkMsV0FBVztFQUNYQztBQUNGLENBQUMsR0FBR2xCLE9BQU8sQ0FBQyxtQkFBbUIsQ0FBQztBQUVoQ21CLFFB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TCxTQUFTLEdBQUdFLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQ0MsSUFBSSxDQUFDLENBQUMsQ0FBQ0MsR0FBRyxDQUFDLE1BQU1GLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQ0MsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO01BQzFESCxTQUFTLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUc7UUFDaEJXLElBQUksRUFBRSxNQUFNO1FBQ1pDLEtBQUssRUFBRSxPQUFPO1FBQ2RDLFFBQVEsRUFBRSxLQUFLLENBQUU7TUFDbkIsQ0FBQztNQUNEYixTQUFTLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUc7UUFDaEJXLElBQUksRUFBRSxNQUFNO1FBQ1pDLEtBQUssRUFBRSxPQUFPO1FBQ2RDLFFBQVEsRUFBRSxLQUFLLENBQUU7TUFDbkIsQ0FBQztNQUNEO01BQ0FiLFNBQVMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxJQUFJO01BQ3RCQSxTQUFTLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsSUFBSTtJQUN4QixDQUFDLENBQUM7SUFFRk0sRUFBRSxDQUFDLGdDQUFnQyxFQUFFLE1BQU07TUFDekNOLFNBQVMsR0FBR0UsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDQyxJQUFJLENBQUMsQ0FBQyxDQUFDQyxHQUFHLENBQUMsTUFBTUYsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7TUFDMUQsTUFBTWtCLElBQUksR0FBRztRQUNYZ0IsS0FBSyxFQUFFO1VBQUUxQixJQUFJLEVBQUUsTUFBTTtVQUFFQyxLQUFLLEVBQUU7UUFBUSxDQUFDO1FBQ3ZDYSxJQUFJLEVBQUU7VUFBRVYsR0FBRyxFQUFFLENBQUM7VUFBRUMsR0FBRyxFQUFFO1FBQUUsQ0FBQztRQUN4QlQsRUFBRSxFQUFFO1VBQUVRLEdBQUcsRUFBRSxDQUFDO1VBQUVDLEdBQUcsRUFBRTtRQUFFO01BQ3ZCLENBQUM7TUFDRHJDLE1BQU0sQ0FBQ2dCLGVBQWUsQ0FBQzBCLElBQUksQ0FBQyxDQUFDLENBQUNkLEVBQUUsQ0FBQ0MsRUFBRSxDQUFDRSxLQUFLLENBQUMsQ0FBQztJQUM3QyxDQUFDLENBQUM7O0lBRUo7SUFDQTtJQUNBO0lBQ0E7SUFDQTtJQUNBO0lBQ0E7SUFDQTs7SUFFQTs7SUFFQTtJQUNBO0lBQ0E7SUFDQTtJQUNBO0lBQ0E7O0lBRUE7SUFDQTtJQUNBO0lBQ0E7SUFDQTtJQUNBOztJQUVBO0lBQ0E7SUFDQTtJQUNBO0VBQ0YsQ0FBQyxDQUFDO0FBQ0YsQ0FBQyxDQUFDIiwiaWdub3JlTGlzdCI6W119","map":{"version":3,"names":["expect","require","isPrime","generateRookMoves","generatePawnMoves","isLegalMove","initializeBoard","checkForCheckmate","isSquareAttacked","serializeBoard","cloneBoard","getOpponent","isInBounds","isKingSafe","performCastle","canCastle","isEnPassantMove","generateMovesForPiece","createPiece","enPassantTarget","describe","testBoard","before","Array","fill","map","beforeEach","it","to","be","true","false","type","color","hasMoved","friendlyMoves","row","col","enemyMoves","allowedDistances","Set","forEach","move","dx","Math","abs","from","dy","distance","has","pawn","moves","some","m","king","side","pos","equal","piece"],"sourceRoot":"/home/bayern/Chess_Temp/test/","sources":["game.test.js"],"sourcesContent":["const { expect } = require('chai');\nlet {\n  isPrime,\n  generateRookMoves,\n  generatePawnMoves,\n  isLegalMove,\n  initializeBoard,\n  checkForCheckmate,\n  isSquareAttacked,\n  serializeBoard,\n  cloneBoard,\n  getOpponent,\n  isInBounds,\n  isKingSafe,\n  performCastle,\n  canCastle,\n  isEnPassantMove,\n  generateMovesForPiece,\n  createPiece,\n  enPassantTarget\n} = require('../gameController');\n\ndescribe('Chess Game Tests', () => {\n  let testBoard;\n\n  before(() => {\n    // Create a fresh board with just the pieces we need for testing\n    testBoard = Array(8).fill().map(() => Array(8).fill(null));\n  });\n\n  beforeEach(() => {\n    testBoard = initializeBoard();\n  });\n\n  describe('Prime Number Validation', () => {\n    it('should identify prime numbers correctly', () => {\n      expect(isPrime(2)).to.be.true;\n      expect(isPrime(7)).to.be.true;\n      expect(isPrime(1)).to.be.false;\n      expect(isPrime(4)).to.be.false;\n      expect(isPrime(9)).to.be.false;\n    });\n  });\n\n  describe('Rook Movement', () => {\n    it('should only allow prime-numbered moves for all rooks', () => {\n      // Test both friendly and enemy rooks\n      testBoard = Array(8).fill().map(() => Array(8).fill(null));\n      \n      // Friendly rook (white)\n      testBoard[3][3] = { type: 'rook', color: 'white', hasMoved: false };\n      const friendlyMoves = generateRookMoves(testBoard, { row: 3, col: 3 }, testBoard[3][3]);\n      \n      // Enemy rook (black)\n      testBoard[4][4] = { type: 'rook', color: 'black', hasMoved: false };\n      const enemyMoves = generateRookMoves(testBoard, { row: 4, col: 4 }, testBoard[4][4]);\n      \n      const allowedDistances = new Set([2, 3, 5, 7]);\n      \n      // Verify both rooks follow prime movement rules\n      [...friendlyMoves, ...enemyMoves].forEach(move => {\n        const dx = Math.abs(move.to.col - move.from.col);\n        const dy = Math.abs(move.to.row - move.from.row);\n        const distance = dx + dy; // Since rook moves straight\n        expect(allowedDistances.has(distance)).to.be.true;\n      });\n    });\n  });\n\n  describe('Pawn Movement', () => {\n    let testBoard;\n  \n    beforeEach(() => {\n      testBoard = Array(8).fill().map(() => Array(8).fill(null));\n      enPassantTarget = null; // Reset enPassant target\n    });\n  \n    // it('should detect en passant opportunities', () => {\n    //   // Set up pawns\n    //   testBoard[3][3] = { type: 'pawn', color: 'white', hasMoved: true };\n    //   testBoard[3][4] = { type: 'pawn', color: 'black', hasMoved: true };\n  \n    //   // Simulate the double-step pawn move that creates en passant opportunity\n    //   const move = {\n    //     from: { row: 1, col: 4 },\n    //     to: { row: 3, col: 4 },\n    //     piece: testBoard[3][4],\n    //     color: 'black'\n    //   };\n      \n    //   // Update enPassantTarget as the game would\n    //   enPassantTarget = { row: 2, col: 4 };\n  \n    //   // Get white pawn's moves\n    //   const whitePawnMoves = generatePawnMoves(testBoard, { row: 3, col: 3 }, testBoard[3][3]);\n      \n    //   // Verify en passant move exists diagonally\n    //   expect(whitePawnMoves).to.deep.include({\n    //     from: { row: 3, col: 3 },\n    //     to: { row: 2, col: 4 },\n    //     piece: testBoard[3][3],\n    //     enPassant: true\n    //   });\n    // });\n  \n    it('should trigger promotion on last rank', () => {\n      const pawn = { type: 'pawn', color: 'white', hasMoved: true };\n      testBoard[1][0] = pawn;\n      \n      const moves = generatePawnMoves(testBoard, { row: 1, col: 0 }, pawn);\n      expect(moves.some(m => m.to.row === 0)).to.be.true;\n    });\n  });\n\n  describe('Check Detection', () => {\n    let testBoard;\n  \n    beforeEach(() => {\n      testBoard = Array(8).fill().map(() => Array(8).fill(null));\n    });\n  \n    it('should identify attacked squares', () => {\n      // Place black rook in same column as white king\n      testBoard[0][4] = createPiece('rook', 'black'); // Top of column 4\n      testBoard[4][4] = createPiece('king', 'white'); // Center king\n      \n      expect(isSquareAttacked(testBoard, { row: 4, col: 4 }, 'black')).to.be.true;\n    });\n  \n    it('should detect checkmate state', () => {\n      // Proper checkmate setup\n      testBoard[7][4] = createPiece('king', 'white'); // White king in corner\n      testBoard[6][3] = createPiece('queen', 'black'); // Queen attacking diagonally\n      testBoard[7][5] = createPiece('rook', 'black'); // Rook blocking escape\n      \n      // Verify no legal moves\n      expect(checkForCheckmate(testBoard, 'white')).to.be.true;\n    });\n  });\n\n  describe('Castling', () => {\n    beforeEach(() => {\n      // Create fresh board with only necessary pieces\n      testBoard = Array(8).fill().map(() => Array(8).fill(null));\n      \n      // Set up castling scenario\n      testBoard[7][4] = createPiece('king', 'white');  // White king\n      testBoard[7][7] = createPiece('rook', 'white');  // Kingside rook\n    });\n\n    it('should allow kingside castling when valid', () => {\n      testBoard[7][5] = null;\n      testBoard[7][6] = null;\n      const king = testBoard[7][4]; // Don't forget to define king\n      \n      expect(canCastle(testBoard, king, { side: 'kingside', pos: { row: 7, col: 4 }})).to.be.true;\n    });\n\n    it('should prevent castling through attacked squares', () => {\n      testBoard[7][5] = null;\n      testBoard[7][6] = null;\n      testBoard[6][5] = { type: 'bishop', color: 'black', hasMoved: true };\n      const king = testBoard[7][4]; // Don't forget to define king\n      \n      expect(canCastle(testBoard, king, { side: 'kingside', pos: { row: 7, col: 4 }})).to.be.false;\n    });\n  });\n\n  describe('Board State Management', () => {\n    // it('should clone board correctly', () => {\n    //   const cloned = cloneBoard(testBoard);\n    //   cloned[0][0].hasMoved = true;\n    //   expect(testBoard[0][0].hasMoved).to.be.false;\n    // });\n\n    // it('should serialize board state', () => {\n    //   const serialized = serializeBoard(testBoard);\n    //   expect(serialized).to.include('rw|bw'); // Rook white and bishop white\n    // });\n  });\n\n  describe('Helper Functions', () => {\n    it('should identify opponent color', () => {\n      testBoard = Array(8).fill().map(() => Array(8).fill(null));\n      expect(getOpponent('white')).to.equal('black');\n      expect(getOpponent('black')).to.equal('white');\n    });\n\n    it('should validate board boundaries', () => {\n      testBoard = Array(8).fill().map(() => Array(8).fill(null));\n      expect(isInBounds(7, 7)).to.be.true;\n      expect(isInBounds(-1, 3)).to.be.false;\n      expect(isInBounds(4, 8)).to.be.false;\n    });\n\n    // it('should generate all legal moves', () => {\n    //   testBoard = Array(8).fill().map(() => Array(8).fill(null));\n    //   const initialMoves = generateMovesForPiece(testBoard, { row: 6, col: 0 }, testBoard[6][0]);\n    //   expect(initialMoves).to.have.lengthOf(2); // Initial pawn move\n    // });\n  });\n\n  describe('Special Moves', () => {\n    let testBoard;\n\n    beforeEach(() => {\n      // Create fresh board with proper castling setup\n      testBoard = Array(8).fill().map(() => Array(8).fill(null));\n      testBoard[7][4] = { \n        type: 'king', \n        color: 'white', \n        hasMoved: false  // Crucial for castling\n      };\n      testBoard[7][7] = { \n        type: 'rook', \n        color: 'white', \n        hasMoved: false  // Crucial for castling\n      };\n      // Clear the castling path\n      testBoard[7][5] = null;\n      testBoard[7][6] = null;\n    });\n\n    it('should detect en passant moves', () => {\n      testBoard = Array(8).fill().map(() => Array(8).fill(null));\n      const move = {\n        piece: { type: 'pawn', color: 'black' },\n        from: { row: 1, col: 3 },\n        to: { row: 3, col: 3 }\n      };\n      expect(isEnPassantMove(move)).to.be.false; // Should only be true in specific context\n    });\n\n  //   it('should execute castling correctly', () => {\n  //   const king = testBoard[7][4];\n  //   const castleMove = {\n  //     from: { row: 7, col: 4 },\n  //     to: { row: 7, col: 6 },\n  //     piece: king,\n  //     castle: 'kingside'\n  //   };\n\n  //   performCastle(castleMove);\n\n  //   // Verify king moved\n  //   expect(testBoard[7][6]).to.deep.equal({\n  //     type: 'king',\n  //     color: 'white',\n  //     hasMoved: true\n  //   });\n    \n  //   // Verify rook moved\n  //   expect(testBoard[7][5]).to.deep.equal({\n  //     type: 'rook',\n  //     color: 'white',\n  //     hasMoved: true\n  //   });\n    \n  //   // Verify original positions are empty\n  //   expect(testBoard[7][4]).to.be.null;\n  //   expect(testBoard[7][7]).to.be.null;\n  // });\n});\n});"],"mappings":";;AAAA,MAAM;EAAEA;AAAO,CAAC,GAAGC,OAAO,CAAC,MAAM,CAAC;AAClC,IAAI;EACFC,OAAO;EACPC,iBAAiB;EACjBC,iBAAiB;EACjBC,WAAW;EACXC,eAAe;EACfC,iBAAiB;EACjBC,gBAAgB;EAChBC,cAAc;EACdC,UAAU;EACVC,WAAW;EACXC,UAAU;EACVC,UAAU;EACVC,aAAa;EACbC,SAAS;EACTC,eAAe;EACfC,qBAAqB;EACrBC,WAAW;EACXC;AACF,CAAC,GAAGlB,OAAO,CAAC,mBAAmB,CAAC;AAEhCmB,QAAQ,CAAC,kBAAkB,EAAE,MAAM;EACjC,IAAIC,SAAS;EAEbC,MAAM,CAAC,MAAM;IACX;IACAD,SAAS,GAAGE,KAAK,CAAC,CAAC,CAAC,CAACC,IAAI,CAAC,CAAC,CAACC,GAAG,CAAC,MAAMF,KAAK,CAAC,CAAC,CAAC,CAACC,IAAI,CAAC,IAAI,CAAC,CAAC;EAC5D,CAAC,CAAC;EAEFE,UAAU,CAAC,MAAM;IACfL,SAAS,GAAGf,eAAe,CAAC,CAAC;EAC/B,CAAC,CAAC;EAEFc,QAAQ,CAAC,yBAAyB,EAAE,MAAM;IACxCO,EAAE,CAAC,yCAAyC,EAAE,MAAM;MAClD3B,MAAM,CAACE,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC0B,EAAE,CAACC,EAAE,CAACC,IAAI;MAC7B9B,MAAM,CAACE,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC0B,EAAE,CAACC,EAAE,CAACC,IAAI;MAC7B9B,MAAM,CAACE,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC0B,EAAE,CAACC,EAAE,CAACE,KAAK;MAC9B/B,MAAM,CAACE,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC0B,EAAE,CAACC,EAAE,CAACE,KAAK;MAC9B/B,MAAM,CAACE,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC0B,EAAE,CAACC,EAAE,CAACE,KAAK;IAChC,CAAC,CAAC;EACJ,CAAC,CAAC;EAEFX,QAAQ,CAAC,eAAe,EAAE,MAAM;IAC9BO,EAAE,CAAC,sDAAsD,EAAE,MAAM;MAC/D;MACAN,SAAS,GAAGE,KAAK,CAAC,CAAC,CAAC,CAACC,IAAI,CAAC,CAAC,CAACC,GAAG,CAAC,MAAMF,KAAK,CAAC,CAAC,CAAC,CAACC,IAAI,CAAC,IAAI,CAAC,CAAC;;MAE1D;MACAH,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG;QAAEW,IAAI,EAAE,MAAM;QAAEC,KAAK,EAAE,OAAO;QAAEC,QAAQ,EAAE;MAAM,CAAC;MACnE,MAAMC,aAAa,GAAGhC,iBAAiB,CAACkB,SAAS,EAAE;QAAEe,GAAG,EAAE,CAAC;QAAEC,GAAG,EAAE;MAAE,CAAC,EAAEhB,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;;MAEvF;MACAA,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG;QAAEW,IAAI,EAAE,MAAM;QAAEC,KAAK,EAAE,OAAO;QAAEC,QAAQ,EAAE;MAAM,CAAC;MACnE,MAAMI,UAAU,GAAGnC,iBAAiB,CAACkB,SAAS,EAAE;QAAEe,GAAG,EAAE,CAAC;QAAEC,GAAG,EAAE;MAAE,CAAC,EAAEhB,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;MAEpF,MAAMkB,gBAAgB,GAAG,IAAIC,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;;MAE9C;MACA,CAAC,GAAGL,aAAa,EAAE,GAAGG,UAAU,CAAC,CAACG,OAAO,CAACC,IAAI,IAAI;QAChD,MAAMC,EAAE,GAAGC,IAAI,CAACC,GAAG,CAACH,IAAI,CAACd,EAAE,CAACS,GAAG,GAAGK,IAAI,CAACI,IAAI,CAACT,GAAG,CAAC;QAChD,MAAMU,EAAE,GAAGH,IAAI,CAACC,GAAG,CAACH,IAAI,CAACd,EAAE,CAACQ,GAAG,GAAGM,IAAI,CAACI,IAAI,CAACV,GAAG,CAAC;QAChD,MAAMY,QAAQ,GAAGL,EAAE,GAAGI,EAAE,CAAC,CAAC;QAC1B/C,MAAM,CAACuC,gBAAgB,CAACU,GAAG,CAACD,QAAQ,CAAC,CAAC,CAACpB,EAAE,CAACC,EAAE,CAACC,IAAI;MACnD,CAAC,CAAC;IACJ,CAAC,CAAC;EACJ,CAAC,CAAC;EAEFV,QAAQ,CAAC,eAAe,EAAE,MAAM;IAC9B,IAAIC,SAAS;IAEbK,UAAU,CAAC,MAAM;MACfL,SAAS,GAAGE,KAAK,CAAC,CAAC,CAAC,CAACC,IAAI,CAAC,CAAC,CAACC,GAAG,CAAC,MAAMF,KAAK,CAAC,CAAC,CAAC,CAACC,IAAI,CAAC,IAAI,CAAC,CAAC;MAC1DL,eAAe,GAAG,IAAI,CAAC,CAAC;IAC1B,CAAC,CAAC;;IAEF;IACA;IACA;IACA;;IAEA;IACA;IACA;IACA;IACA;IACA;IACA;;IAEA;IACA;;IAEA;IACA;;IAEA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;;IAEAQ,EAAE,CAAC,uCAAuC,EAAE,MAAM;MAChD,MAAMuB,IAAI,GAAG;QAAElB,IAAI,EAAE,MAAM;QAAEC,KAAK,EAAE,OAAO;QAAEC,QAAQ,EAAE;MAAK,CAAC;MAC7Db,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG6B,IAAI;MAEtB,MAAMC,KAAK,GAAG/C,iBAAiB,CAACiB,SAAS,EAAE;QAAEe,GAAG,EAAE,CAAC;QAAEC,GAAG,EAAE;MAAE,CAAC,EAAEa,IAAI,CAAC;MACpElD,MAAM,CAACmD,KAAK,CAACC,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACzB,EAAE,CAACQ,GAAG,KAAK,CAAC,CAAC,CAAC,CAACR,EAAE,CAACC,EAAE,CAACC,IAAI;IACpD,CAAC,CAAC;EACJ,CAAC,CAAC;EAEFV,QAAQ,CAAC,iBAAiB,EAAE,MAAM;IAChC,IAAIC,SAAS;IAEbK,UAAU,CAAC,MAAM;MACfL,SAAS,GAAGE,KAAK,CAAC,CAAC,CAAC,CAACC,IAAI,CAAC,CAAC,CAACC,GAAG,CAAC,MAAMF,KAAK,CAAC,CAAC,CAAC,CAACC,IAAI,CAAC,IAAI,CAAC,CAAC;IAC5D,CAAC,CAAC;IAEFG,EAAE,CAAC,kCAAkC,EAAE,MAAM;MAC3C;MACAN,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGH,WAAW,CAAC,MAAM,EAAE,OAAO,CAAC,CAAC,CAAC;MAChDG,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGH,WAAW,CAAC,MAAM,EAAE,OAAO,CAAC,CAAC,CAAC;;MAEhDlB,MAAM,CAACQ,gBAAgB,CAACa,SAAS,EAAE;QAAEe,GAAG,EAAE,CAAC;QAAEC,GAAG,EAAE;MAAE,CAAC,EAAE,OAAO,CAAC,CAAC,CAACT,EAAE,CAACC,EAAE,CAACC,IAAI;IAC7E,CAAC,CAAC;IAEFH,EAAE,CAAC,+BAA+B,EAAE,MAAM;MACxC;MACAN,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGH,WAAW,CAAC,MAAM,EAAE,OAAO,CAAC,CAAC,CAAC;MAChDG,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGH,WAAW,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC,CAAC;MACjDG,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGH,WAAW,CAAC,MAAM,EAAE,OAAO,CAAC,CAAC,CAAC;;MAEhD;MACAlB,MAAM,CAACO,iBAAiB,CAACc,SAAS,EAAE,OAAO,CAAC,CAAC,CAACO,EAAE,CAACC,EAAE,CAACC,IAAI;IAC1D,CAAC,CAAC;EACJ,CAAC,CAAC;EAEFV,QAAQ,CAAC,UAAU,EAAE,MAAM;IACzBM,UAAU,CAAC,MAAM;MACf;MACAL,SAAS,GAAGE,KAAK,CAAC,CAAC,CAAC,CAACC,IAAI,CAAC,CAAC,CAACC,GAAG,CAAC,MAAMF,KAAK,CAAC,CAAC,CAAC,CAACC,IAAI,CAAC,IAAI,CAAC,CAAC;;MAE1D;MACAH,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGH,WAAW,CAAC,MAAM,EAAE,OAAO,CAAC,CAAC,CAAE;MACjDG,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGH,WAAW,CAAC,MAAM,EAAE,OAAO,CAAC,CAAC,CAAE;IACnD,CAAC,CAAC;IAEFS,EAAE,CAAC,2CAA2C,EAAE,MAAM;MACpDN,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,IAAI;MACtBA,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,IAAI;MACtB,MAAMiC,IAAI,GAAGjC,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;;MAE9BrB,MAAM,CAACe,SAAS,CAACM,SAAS,EAAEiC,IAAI,EAAE;QAAEC,IAAI,EAAE,UAAU;QAAEC,GAAG,EAAE;UAAEpB,GAAG,EAAE,CAAC;UAAEC,GAAG,EAAE;QAAE;MAAC,CAAC,CAAC,CAAC,CAACT,EAAE,CAACC,EAAE,CAACC,IAAI;IAC7F,CAAC,CAAC;IAEFH,EAAE,CAAC,kDAAkD,EAAE,MAAM;MAC3DN,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,IAAI;MACtBA,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,IAAI;MACtBA,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG;QAAEW,IAAI,EAAE,QAAQ;QAAEC,KAAK,EAAE,OAAO;QAAEC,QAAQ,EAAE;MAAK,CAAC;MACpE,MAAMoB,IAAI,GAAGjC,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;;MAE9BrB,MAAM,CAACe,SAAS,CAACM,SAAS,EAAEiC,IAAI,EAAE;QAAEC,IAAI,EAAE,UAAU;QAAEC,GAAG,EAAE;UAAEpB,GAAG,EAAE,CAAC;UAAEC,GAAG,EAAE;QAAE;MAAC,CAAC,CAAC,CAAC,CAACT,EAAE,CAACC,EAAE,CAACE,KAAK;IAC9F,CAAC,CAAC;EACJ,CAAC,CAAC;EAEFX,QAAQ,CAAC,wBAAwB,EAAE,MAAM;IACvC;IACA;IACA;IACA;IACA;;IAEA;IACA;IACA;IACA;EAAA,CACD,CAAC;EAEFA,QAAQ,CAAC,kBAAkB,EAAE,MAAM;IACjCO,EAAE,CAAC,gCAAgC,EAAE,MAAM;MACzCN,SAAS,GAAGE,KAAK,CAAC,CAAC,CAAC,CAACC,IAAI,CAAC,CAAC,CAACC,GAAG,CAAC,MAAMF,KAAK,CAAC,CAAC,CAAC,CAACC,IAAI,CAAC,IAAI,CAAC,CAAC;MAC1DxB,MAAM,CAACW,WAAW,CAAC,OAAO,CAAC,CAAC,CAACiB,EAAE,CAAC6B,KAAK,CAAC,OAAO,CAAC;MAC9CzD,MAAM,CAACW,WAAW,CAAC,OAAO,CAAC,CAAC,CAACiB,EAAE,CAAC6B,KAAK,CAAC,OAAO,CAAC;IAChD,CAAC,CAAC;IAEF9B,EAAE,CAAC,kCAAkC,EAAE,MAAM;MAC3CN,SAAS,GAAGE,KAAK,CAAC,CAAC,CAAC,CAACC,IAAI,CAAC,CAAC,CAACC,GAAG,CAAC,MAAMF,KAAK,CAAC,CAAC,CAAC,CAACC,IAAI,CAAC,IAAI,CAAC,CAAC;MAC1DxB,MAAM,CAACY,UAAU,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAACgB,EAAE,CAACC,EAAE,CAACC,IAAI;MACnC9B,MAAM,CAACY,UAAU,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAACgB,EAAE,CAACC,EAAE,CAACE,KAAK;MACrC/B,MAAM,CAACY,UAAU,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAACgB,EAAE,CAACC,EAAE,CAACE,KAAK;IACtC,CAAC,CAAC;;IAEF;IACA;IACA;IACA;IACA;EACF,CAAC,CAAC;EAEFX,QAAQ,CAAC,eAAe,EAAE,MAAM;IAC9B,IAAIC,SAAS;IAEbK,UAAU,CAAC,MAAM;MACf;MACAL,SAAS,GAAGE,KAAK,CAAC,CAAC,CAAC,CAACC,IAAI,CAAC,CAAC,CAACC,GAAG,CAAC,MAAMF,KAAK,CAAC,CAAC,CAAC,CAACC,IAAI,CAAC,IAAI,CAAC,CAAC;MAC1DH,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG;QAChBW,IAAI,EAAE,MAAM;QACZC,KAAK,EAAE,OAAO;QACdC,QAAQ,EAAE,KAAK,CAAE;MACnB,CAAC;MACDb,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG;QAChBW,IAAI,EAAE,MAAM;QACZC,KAAK,EAAE,OAAO;QACdC,QAAQ,EAAE,KAAK,CAAE;MACnB,CAAC;MACD;MACAb,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,IAAI;MACtBA,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,IAAI;IACxB,CAAC,CAAC;IAEFM,EAAE,CAAC,gCAAgC,EAAE,MAAM;MACzCN,SAAS,GAAGE,KAAK,CAAC,CAAC,CAAC,CAACC,IAAI,CAAC,CAAC,CAACC,GAAG,CAAC,MAAMF,KAAK,CAAC,CAAC,CAAC,CAACC,IAAI,CAAC,IAAI,CAAC,CAAC;MAC1D,MAAMkB,IAAI,GAAG;QACXgB,KAAK,EAAE;UAAE1B,IAAI,EAAE,MAAM;UAAEC,KAAK,EAAE;QAAQ,CAAC;QACvCa,IAAI,EAAE;UAAEV,GAAG,EAAE,CAAC;UAAEC,GAAG,EAAE;QAAE,CAAC;QACxBT,EAAE,EAAE;UAAEQ,GAAG,EAAE,CAAC;UAAEC,GAAG,EAAE;QAAE;MACvB,CAAC;MACDrC,MAAM,CAACgB,eAAe,CAAC0B,IAAI,CAAC,CAAC,CAACd,EAAE,CAACC,EAAE,CAACE,KAAK,CAAC,CAAC;IAC7C,CAAC,CAAC;;IAEJ;IACA;IACA;IACA;IACA;IACA;IACA;IACA;;IAEA;;IAEA;IACA;IACA;IACA;IACA;IACA;;IAEA;IACA;IACA;IACA;IACA;IACA;;IAEA;IACA;IACA;IACA;EACF,CAAC,CAAC;AACF,CAAC,CAAC","ignoreList":[]}},"mtime":1743349739795},"{\"assumptions\":{},\"sourceRoot\":\"/home/bayern/Chess_Temp/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/home/bayern/Chess_Temp\",\"filename\":\"/home/bayern/Chess_Temp/gameController.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/bayern/Chess_Temp\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"transform-duplicate-named-capturing-groups-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-regexp-modifiers\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-unicode-sets-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/bayern/Chess_Temp/node_modules/@babel/preset-env/lib/index.js$3\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/bayern/Chess_Temp/node_modules/@babel/preset-env/lib/index.js$4\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/bayern/Chess_Temp/node_modules/@babel/preset-env/lib/index.js$5\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/bayern/Chess_Temp/node_modules/@babel/preset-env/lib/index.js$6\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/bayern/Chess_Temp/node_modules/@babel/preset-env/lib/index.js$7\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/bayern/Chess_Temp/node_modules/@babel/preset-env/lib/index.js$8\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/bayern/Chess_Temp/node_modules/@babel/preset-env/lib/index.js$9\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/bayern/Chess_Temp/node_modules/@babel/preset-env/lib/index.js$10\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/bayern/Chess_Temp/node_modules/@babel/preset-env/lib/index.js$11\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/bayern/Chess_Temp/node_modules/@babel/preset-env/lib/index.js$12\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/bayern/Chess_Temp/node_modules/@babel/preset-env/lib/index.js$16\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/bayern/Chess_Temp/node_modules/@babel/preset-env/lib/index.js$17\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.26.10:development":{"value":{"code":"\"use strict\";\n\n/* \n  Modified Chess Game with Prime Rook Moves, Menu, Chess Clock, and Advanced Rules:\n  - Friendly rooks can only move a prime number of squares (allowed: 2, 3, 5, or 7).\n  - Queen moves remain standard.\n  - All other rules (castling, en passant, pawn promotion, etc.) remain unchanged.\n*/\n\n/* ----- DOM ELEMENTS ----- */\nconst boardElement = document.getElementById(\"chessboard\");\nconst promotionModal = document.getElementById(\"promotionModal\");\nconst promotionChoices = document.querySelectorAll(\".promotionChoice\");\nconst startGameBtn = document.getElementById(\"startGame\");\nconst gameModeSelect = document.getElementById(\"gameMode\");\nconst whiteClockEl = document.getElementById(\"whiteClock\");\nconst blackClockEl = document.getElementById(\"blackClock\");\nconst menuScreen = document.getElementById(\"menuScreen\");\nconst gameScreen = document.getElementById(\"gameScreen\");\n\n/* ----- GAME STATE VARIABLES ----- */\nlet board = [];\nlet currentPlayer = \"white\";\nlet selectedPiece = null;\nlet selectedPos = null;\nlet moveHistory = [];\nlet boardHistory = [];\nlet fiftyMoveCounter = 0;\nlet enPassantTarget = null;\n\n/* ----- CLOCK VARIABLES ----- */\nlet whiteTime = 0;\nlet blackTime = 0;\nlet clockInterval = null;\n\n/* ----- DRAGGING STATE ----- */\nlet draggingPieceEl = null;\nlet dragOffset = {\n  x: 0,\n  y: 0\n};\nlet dragStartPos = null;\n\n/* ----- HELPER: Check if number is prime ----- */\nfunction isPrime(n) {\n  if (n < 2) return false;\n  for (let i = 2; i <= Math.sqrt(n); i++) {\n    if (n % i === 0) return false;\n  }\n  return true;\n}\n\n/* ----- CLOCK FUNCTIONS ----- */\nfunction startClock() {\n  clearInterval(clockInterval);\n  clockInterval = setInterval(() => {\n    if (currentPlayer === \"white\") {\n      whiteTime--;\n      if (whiteTime <= 0) {\n        clearInterval(clockInterval);\n        alert(\"Time's up! Black wins!\");\n        resetGame();\n        return;\n      }\n    } else {\n      blackTime--;\n      if (blackTime <= 0) {\n        clearInterval(clockInterval);\n        alert(\"Time's up! White wins!\");\n        resetGame();\n        return;\n      }\n    }\n    updateClockDisplay();\n  }, 1000);\n}\nfunction updateClockDisplay() {\n  whiteClockEl.innerText = formatTime(whiteTime);\n  blackClockEl.innerText = formatTime(blackTime);\n}\nfunction formatTime(seconds) {\n  let m = Math.floor(seconds / 60);\n  let s = seconds % 60;\n  return (m < 10 ? \"0\" + m : m) + \":\" + (s < 10 ? \"0\" + s : s);\n}\n\n/* ----- MENU AND GAME START ----- */\nstartGameBtn.addEventListener(\"click\", () => {\n  let initialTime = parseInt(gameModeSelect.value);\n  whiteTime = initialTime;\n  blackTime = initialTime;\n  updateClockDisplay();\n  menuScreen.style.display = \"none\";\n  gameScreen.style.display = \"block\";\n  initializeBoard();\n  startClock();\n});\n\n/* ----- INITIALIZATION ----- */\nfunction initializeBoard() {\n  board = Array(8).fill(null).map(() => Array(8).fill(null));\n  for (let i = 0; i < 8; i++) {\n    board[1][i] = createPiece(\"pawn\", \"black\");\n    board[6][i] = createPiece(\"pawn\", \"white\");\n  }\n  board[0][0] = createPiece(\"rook\", \"black\");\n  board[0][7] = createPiece(\"rook\", \"black\");\n  board[7][0] = createPiece(\"rook\", \"white\");\n  board[7][7] = createPiece(\"rook\", \"white\");\n  board[0][1] = createPiece(\"knight\", \"black\");\n  board[0][6] = createPiece(\"knight\", \"black\");\n  board[7][1] = createPiece(\"knight\", \"white\");\n  board[7][6] = createPiece(\"knight\", \"white\");\n  board[0][2] = createPiece(\"bishop\", \"black\");\n  board[0][5] = createPiece(\"bishop\", \"black\");\n  board[7][2] = createPiece(\"bishop\", \"white\");\n  board[7][5] = createPiece(\"bishop\", \"white\");\n  board[0][3] = createPiece(\"queen\", \"black\");\n  board[7][3] = createPiece(\"queen\", \"white\");\n  board[0][4] = createPiece(\"king\", \"black\");\n  board[7][4] = createPiece(\"king\", \"white\");\n  moveHistory = [];\n  boardHistory = [];\n  fiftyMoveCounter = 0;\n  enPassantTarget = null;\n  selectedPiece = null;\n  selectedPos = null;\n  currentPlayer = \"white\";\n  drawBoard();\n  updateBoardHistory();\n}\nfunction resetGame() {\n  clearInterval(clockInterval);\n  menuScreen.style.display = \"block\";\n  gameScreen.style.display = \"none\";\n  initializeBoard();\n}\n\n/* ----- PIECE CREATION ----- */\nfunction createPiece(type, color) {\n  return {\n    type,\n    color,\n    hasMoved: false\n  };\n}\n\n/* ----- DRAWING THE BOARD ----- */\nfunction drawBoard() {\n  boardElement.innerHTML = \"\";\n  for (let row = 0; row < 8; row++) {\n    for (let col = 0; col < 8; col++) {\n      let square = document.createElement(\"div\");\n      square.classList.add(\"square\");\n      square.dataset.row = row;\n      square.dataset.col = col;\n      square.classList.add((row + col) % 2 === 0 ? \"light\" : \"dark\");\n      if (selectedPos && selectedPos.row === row && selectedPos.col === col) {\n        square.classList.add(\"selected\");\n      }\n      if (board[row][col] && board[row][col].type === \"king\") {\n        if (isSquareAttacked(board, {\n          row,\n          col\n        }, getOpponent(board[row][col].color))) {\n          square.classList.add(\"in-check\");\n        }\n      }\n      if (board[row][col]) {\n        let pieceEl = document.createElement(\"img\");\n        pieceEl.classList.add(\"piece-img\", board[row][col].color, board[row][col].type);\n        pieceEl.src = getPieceImageSrc(board[row][col]);\n        pieceEl.alt = board[row][col].type;\n        pieceEl.addEventListener(\"mousedown\", onPieceMouseDown);\n        square.appendChild(pieceEl);\n      }\n      square.addEventListener(\"click\", onSquareClick);\n      boardElement.appendChild(square);\n    }\n  }\n}\nfunction getPieceImageSrc(piece) {\n  return `assets/${piece.color}_${piece.type}.png`;\n}\n\n/* ----- CLICK HANDLING ----- */\nfunction onSquareClick(e) {\n  if (draggingPieceEl) return;\n  const row = parseInt(e.currentTarget.dataset.row);\n  const col = parseInt(e.currentTarget.dataset.col);\n  if (board[row][col] && board[row][col].color === currentPlayer) {\n    selectedPiece = board[row][col];\n    selectedPos = {\n      row,\n      col\n    };\n  } else if (selectedPiece) {\n    let move = {\n      from: {\n        row: selectedPos.row,\n        col: selectedPos.col\n      },\n      to: {\n        row,\n        col\n      },\n      piece: selectedPiece\n    };\n    if (isLegalMove(board, move, currentPlayer)) {\n      makeMove(move);\n    } else {\n      console.log(\"Illegal move attempted:\", move);\n    }\n    selectedPiece = null;\n    selectedPos = null;\n  }\n  drawBoard();\n}\n\n/* ----- DRAG-TO-MOVE HANDLING ----- */\nfunction onPieceMouseDown(e) {\n  const square = e.target.parentElement;\n  const row = parseInt(square.dataset.row);\n  const col = parseInt(square.dataset.col);\n  if (board[row][col].color !== currentPlayer) return;\n  selectedPiece = board[row][col];\n  selectedPos = {\n    row,\n    col\n  };\n  dragStartPos = {\n    row,\n    col\n  };\n  draggingPieceEl = e.target.cloneNode(true);\n  draggingPieceEl.classList.add(\"dragging\");\n  document.body.appendChild(draggingPieceEl);\n  const rect = e.target.getBoundingClientRect();\n  dragOffset.x = e.clientX - rect.left;\n  dragOffset.y = e.clientY - rect.top;\n  drawBoard();\n  document.addEventListener(\"mousemove\", onMouseMove);\n  document.addEventListener(\"mouseup\", onMouseUp);\n}\nfunction onMouseMove(e) {\n  if (draggingPieceEl) {\n    draggingPieceEl.style.left = e.clientX - dragOffset.x + \"px\";\n    draggingPieceEl.style.top = e.clientY - dragOffset.y + \"px\";\n  }\n}\nfunction onMouseUp(e) {\n  if (!draggingPieceEl) return;\n  const boardRect = boardElement.getBoundingClientRect();\n  const x = e.clientX - boardRect.left;\n  const y = e.clientY - boardRect.top;\n  const col = Math.floor(x / 80);\n  const row = Math.floor(y / 80);\n  if (row >= 0 && row < 8 && col >= 0 && col < 8) {\n    let move = {\n      from: {\n        row: dragStartPos.row,\n        col: dragStartPos.col\n      },\n      to: {\n        row,\n        col\n      },\n      piece: selectedPiece\n    };\n    // Detect castling: if king moves two squares horizontally\n    if (move.piece.type === \"king\" && Math.abs(move.to.col - move.from.col) === 2) {\n      move.castle = move.to.col > move.from.col ? \"kingside\" : \"queenside\";\n    }\n    if (isLegalMove(board, move, currentPlayer)) {\n      makeMove(move);\n    } else {\n      console.log(\"Illegal move attempted via drag:\", move);\n    }\n  }\n  document.body.removeChild(draggingPieceEl);\n  draggingPieceEl = null;\n  dragStartPos = null;\n  selectedPiece = null;\n  selectedPos = null;\n  document.removeEventListener(\"mousemove\", onMouseMove);\n  document.removeEventListener(\"mouseup\", onMouseUp);\n  drawBoard();\n}\n\n/* ----- MAKING MOVES ----- */\nfunction makeMove(move) {\n  if (isCastlingMove(move)) {\n    performCastle(move);\n  } else if (isEnPassantMove(move)) {\n    performEnPassant(move);\n  } else {\n    board[move.to.row][move.to.col] = move.piece;\n    board[move.from.row][move.from.col] = null;\n    if (move.piece.type === \"pawn\" && isLastRank(move.to, move.piece.color)) {\n      showPromotionModal(move);\n      return;\n    }\n  }\n  move.piece.hasMoved = true;\n  handlePawnDoubleStep(move);\n  moveHistory.push(move);\n  updateFiftyMoveCounter(move);\n  updateBoardHistory();\n\n  // Switch turn. currentPlayer becomes the player who is about to move.\n  currentPlayer = getOpponent(currentPlayer);\n  startClock();\n\n  // FIXED: Check for checkmate on the current player's turn\n  if (checkForCheckmate(board, currentPlayer)) {\n    alert(\"Checkmate! \" + getOpponent(currentPlayer) + \" wins.\");\n    clearInterval(clockInterval);\n    resetGame();\n    return;\n  } else if (checkForStalemate(board, currentPlayer)) {\n    alert(\"Stalemate!\");\n    clearInterval(clockInterval);\n    resetGame();\n    return;\n  } else if (isThreefoldRepetition()) {\n    alert(\"Draw by threefold repetition!\");\n    clearInterval(clockInterval);\n    resetGame();\n    return;\n  } else if (isFiftyMoveRule()) {\n    alert(\"Draw by fifty-move rule!\");\n    clearInterval(clockInterval);\n    resetGame();\n    return;\n  }\n  selectedPiece = null;\n  selectedPos = null;\n  drawBoard();\n}\n\n/* ----- MOVE GENERATION ----- */\nfunction generateMovesForPiece(board, pos) {\n  let piece = board[pos.row][pos.col];\n  if (!piece) return [];\n  let moves = [];\n  switch (piece.type) {\n    case \"pawn\":\n      moves = generatePawnMoves(board, pos, piece);\n      break;\n    case \"rook\":\n      // Friendly rooks: restrict moves to prime number of squares.\n      moves = generateRookMoves(board, pos, piece);\n      break;\n    case \"knight\":\n      moves = generateKnightMoves(board, pos, piece);\n      break;\n    case \"bishop\":\n      moves = generateBishopMoves(board, pos, piece);\n      break;\n    case \"queen\":\n      // For queen, use default rook moves (no prime restriction) plus bishop moves.\n      moves = generateRookMovesDefault(board, pos, piece).concat(generateBishopMoves(board, pos, piece));\n      break;\n    case \"king\":\n      moves = generateKingMoves(board, pos, piece);\n      moves = moves.concat(generateCastlingMoves(board, pos, piece));\n      break;\n  }\n  return moves;\n}\nfunction generatePawnMoves(board, pos, piece) {\n  let moves = [];\n  let direction = piece.color === \"white\" ? -1 : 1;\n  let startRow = piece.color === \"white\" ? 6 : 1;\n  let nextRow = pos.row + direction;\n  if (isInBounds(nextRow, pos.col) && board[nextRow][pos.col] === null) {\n    moves.push({\n      from: pos,\n      to: {\n        row: nextRow,\n        col: pos.col\n      },\n      piece\n    });\n    if (pos.row === startRow && isInBounds(nextRow + direction, pos.col) && board[nextRow + direction][pos.col] === null) {\n      moves.push({\n        from: pos,\n        to: {\n          row: nextRow + direction,\n          col: pos.col\n        },\n        piece\n      });\n    }\n  }\n  for (let dc of [-1, 1]) {\n    let newCol = pos.col + dc;\n    if (isInBounds(nextRow, newCol)) {\n      if (board[nextRow][newCol] && board[nextRow][newCol].color !== piece.color) {\n        moves.push({\n          from: pos,\n          to: {\n            row: nextRow,\n            col: newCol\n          },\n          piece\n        });\n      }\n      if (board[nextRow][newCol] === null && enPassantTarget && enPassantTarget.row === nextRow && enPassantTarget.col === newCol) {\n        moves.push({\n          from: pos,\n          to: {\n            row: nextRow,\n            col: newCol\n          },\n          piece,\n          enPassant: true\n        });\n      }\n    }\n  }\n  return moves;\n}\n\n/* Modified Rook Moves: For friendly rooks, allow moves only if the number of squares moved is prime (2, 3, 5, or 7) */\nfunction generateRookMoves(board, pos, piece) {\n  let moves = [];\n  let directions = [[1, 0], [-1, 0], [0, 1], [0, -1]];\n  directions.forEach(d => {\n    let r = pos.row;\n    let c = pos.col;\n    let steps = 0;\n    while (true) {\n      r += d[0];\n      c += d[1];\n      steps++;\n      if (!isInBounds(r, c)) break;\n      if (isPrime(steps)) {\n        if (board[r][c] === null) {\n          moves.push({\n            from: pos,\n            to: {\n              row: r,\n              col: c\n            },\n            piece\n          });\n        } else {\n          if (board[r][c].color !== piece.color) {\n            moves.push({\n              from: pos,\n              to: {\n                row: r,\n                col: c\n              },\n              piece\n            });\n          }\n          break;\n        }\n      } else {\n        if (board[r][c] !== null) break;\n      }\n    }\n  });\n  return moves;\n}\n\n/* Default Rook Moves for queen moves and enemy attack detection (no prime restriction) */\nfunction generateRookMovesDefault(board, pos, piece) {\n  let moves = [];\n  let directions = [[1, 0], [-1, 0], [0, 1], [0, -1]];\n  directions.forEach(d => {\n    let r = pos.row;\n    let c = pos.col;\n    while (true) {\n      r += d[0];\n      c += d[1];\n      if (!isInBounds(r, c)) break;\n      if (board[r][c] === null) {\n        moves.push({\n          from: pos,\n          to: {\n            row: r,\n            col: c\n          },\n          piece\n        });\n      } else {\n        moves.push({\n          from: pos,\n          to: {\n            row: r,\n            col: c\n          },\n          piece\n        });\n        break;\n      }\n    }\n  });\n  return moves;\n}\nfunction generateKnightMoves(board, pos, piece) {\n  let moves = [];\n  let offsets = [[-2, -1], [-2, 1], [-1, -2], [-1, 2], [1, -2], [1, 2], [2, -1], [2, 1]];\n  offsets.forEach(o => {\n    let r = pos.row + o[0];\n    let c = pos.col + o[1];\n    if (isInBounds(r, c) && (!board[r][c] || board[r][c].color !== piece.color)) {\n      moves.push({\n        from: pos,\n        to: {\n          row: r,\n          col: c\n        },\n        piece\n      });\n    }\n  });\n  return moves;\n}\nfunction generateBishopMoves(board, pos, piece) {\n  let moves = [];\n  let directions = [[1, 1], [1, -1], [-1, 1], [-1, -1]];\n  directions.forEach(d => {\n    for (let steps = 1; steps < 8; steps++) {\n      let r = pos.row + d[0] * steps;\n      let c = pos.col + d[1] * steps;\n      if (!isInBounds(r, c)) break;\n\n      // Skip if destination is occupied by a friendly piece\n      let destSquare = board[r][c];\n      if (destSquare && destSquare.color === piece.color) continue;\n      let standardPathValid = true;\n      let modifiedPawnCount = 0;\n      let modifiedPathValid = true;\n\n      // Check standard path validity (all intermediate squares empty)\n      for (let s = 1; s < steps; s++) {\n        let currentR = pos.row + d[0] * s;\n        let currentC = pos.col + d[1] * s;\n        if (board[currentR][currentC] !== null) {\n          standardPathValid = false;\n          break;\n        }\n      }\n\n      // Check modified path validity (exactly one pawn in intermediate squares)\n      for (let s = 1; s < steps; s++) {\n        let currentR = pos.row + d[0] * s;\n        let currentC = pos.col + d[1] * s;\n        let square = board[currentR][currentC];\n        if (square) {\n          if (square.type === 'pawn') {\n            modifiedPawnCount++;\n            if (modifiedPawnCount > 1) {\n              modifiedPathValid = false;\n              break;\n            }\n          } else {\n            modifiedPathValid = false;\n            break;\n          }\n        }\n      }\n      modifiedPathValid = modifiedPathValid && modifiedPawnCount === 1;\n\n      // Add move if either path is valid\n      if (standardPathValid || modifiedPathValid) {\n        moves.push({\n          from: pos,\n          to: {\n            row: r,\n            col: c\n          },\n          piece\n        });\n      }\n    }\n  });\n  return moves;\n}\nfunction generateQueenMoves(board, pos, piece) {\n  // Queen moves = default rook moves (no prime restriction) + bishop moves\n  return generateRookMovesDefault(board, pos, piece).concat(generateBishopMoves(board, pos, piece));\n}\nfunction generateKingMoves(board, pos, piece) {\n  let moves = [];\n  for (let r = pos.row - 1; r <= pos.row + 1; r++) {\n    for (let c = pos.col - 1; c <= pos.col + 1; c++) {\n      if (r === pos.row && c === pos.col) continue;\n      if (isInBounds(r, c) && (!board[r][c] || board[r][c].color !== piece.color)) {\n        moves.push({\n          from: pos,\n          to: {\n            row: r,\n            col: c\n          },\n          piece\n        });\n      }\n    }\n  }\n  return moves;\n}\nfunction generateCastlingMoves(board, pos, king) {\n  let moves = [];\n  if (king.hasMoved) return moves;\n  if (canCastle(board, king, {\n    side: \"kingside\",\n    pos\n  })) {\n    moves.push({\n      from: pos,\n      to: {\n        row: pos.row,\n        col: pos.col + 2\n      },\n      piece: king,\n      castle: \"kingside\"\n    });\n  }\n  if (canCastle(board, king, {\n    side: \"queenside\",\n    pos\n  })) {\n    moves.push({\n      from: pos,\n      to: {\n        row: pos.row,\n        col: pos.col - 2\n      },\n      piece: king,\n      castle: \"queenside\"\n    });\n  }\n  return moves;\n}\n\n/* ----- CASTLING LOGIC ----- */\nfunction canCastle(board, king, {\n  side,\n  pos\n}) {\n  let row = pos.row;\n  if (king.hasMoved) return false;\n  if (side === \"kingside\") {\n    let rook = board[row][7];\n    if (!rook || rook.type !== \"rook\" || rook.hasMoved) return false;\n    if (board[row][5] !== null || board[row][6] !== null) return false;\n    if (!isSquareSafeForKing(board, {\n      row,\n      col: 4\n    }, king.color) || !isSquareSafeForKing(board, {\n      row,\n      col: 5\n    }, king.color) || !isSquareSafeForKing(board, {\n      row,\n      col: 6\n    }, king.color)) return false;\n    return true;\n  } else if (side === \"queenside\") {\n    let rook = board[row][0];\n    if (!rook || rook.type !== \"rook\" || rook.hasMoved) return false;\n    if (board[row][1] !== null || board[row][2] !== null || board[row][3] !== null) return false;\n    if (!isSquareSafeForKing(board, {\n      row,\n      col: 4\n    }, king.color) || !isSquareSafeForKing(board, {\n      row,\n      col: 3\n    }, king.color) || !isSquareSafeForKing(board, {\n      row,\n      col: 2\n    }, king.color)) return false;\n    return true;\n  }\n  return false;\n}\nfunction isSquareSafeForKing(board, pos, color) {\n  let tempBoard = cloneBoard(board);\n  tempBoard[pos.row][pos.col] = {\n    type: \"king\",\n    color,\n    hasMoved: true\n  };\n  return isKingSafe(tempBoard, color);\n}\n\n/* ----- HELPER FUNCTIONS ----- */\nfunction isInBounds(row, col) {\n  return row >= 0 && row < 8 && col >= 0 && col < 8;\n}\nfunction cloneBoard(board) {\n  return board.map(row => row.map(cell => cell ? {\n    ...cell\n  } : null));\n}\nfunction isKingSafe(board, color) {\n  let kingPos = findKing(board, color);\n  if (!kingPos) return false;\n  return !isSquareAttacked(board, kingPos, getOpponent(color));\n}\nfunction findKing(board, color) {\n  for (let r = 0; r < 8; r++) {\n    for (let c = 0; c < 8; c++) {\n      let piece = board[r][c];\n      if (piece && piece.type === \"king\" && piece.color === color) {\n        return {\n          row: r,\n          col: c\n        };\n      }\n    }\n  }\n  return null;\n}\nfunction isSquareAttacked(board, pos, attackerColor) {\n  for (let r = 0; r < 8; r++) {\n    for (let c = 0; c < 8; c++) {\n      let piece = board[r][c];\n      if (piece && piece.color === attackerColor) {\n        let moves;\n        if (piece.type === \"rook\") {\n          // For enemy rooks, use full-range moves (default) for attack detection.\n          moves = generateRookMovesDefault(board, {\n            row: r,\n            col: c\n          }, piece);\n        } else {\n          moves = generateMovesForPiece(board, {\n            row: r,\n            col: c\n          });\n        }\n        for (let move of moves) {\n          if (move.to.row === pos.row && move.to.col === pos.col) return true;\n        }\n      }\n    }\n  }\n  return false;\n}\nfunction getOpponent(color) {\n  return color === \"white\" ? \"black\" : \"white\";\n}\n\n/* ----- EN PASSANT LOGIC ----- */\nfunction handlePawnDoubleStep(move) {\n  if (move.piece.type === \"pawn\" && Math.abs(move.from.row - move.to.row) === 2) {\n    enPassantTarget = {\n      row: (move.from.row + move.to.row) / 2,\n      col: move.from.col\n    };\n  } else {\n    enPassantTarget = null;\n  }\n}\nfunction isEnPassantMove(move) {\n  return move.piece.type === \"pawn\" && move.from.col !== move.to.col && board[move.to.row][move.to.col] === null;\n}\nfunction performEnPassant(move) {\n  board[move.to.row][move.to.col] = move.piece;\n  board[move.from.row][move.from.col] = null;\n  let captureRow = move.piece.color === \"white\" ? move.to.row + 1 : move.to.row - 1;\n  board[captureRow][move.to.col] = null;\n}\n\n/* ----- CASTLING HANDLING ----- */\nfunction isCastlingMove(move) {\n  return move.piece.type === \"king\" && Math.abs(move.to.col - move.from.col) === 2;\n}\nfunction performCastle(move) {\n  let row = move.from.row;\n  if (move.castle === \"kingside\") {\n    board[row][6] = move.piece;\n    board[row][4] = null;\n    let rook = board[row][7];\n    board[row][5] = rook;\n    board[row][7] = null;\n    rook.hasMoved = true;\n  } else if (move.castle === \"queenside\") {\n    board[row][2] = move.piece;\n    board[row][4] = null;\n    let rook = board[row][0];\n    board[row][3] = rook;\n    board[row][0] = null;\n    rook.hasMoved = true;\n  }\n}\n\n/* ----- PAWN PROMOTION ----- */\nfunction isLastRank(pos, color) {\n  return color === \"white\" && pos.row === 0 || color === \"black\" && pos.row === 7;\n}\nfunction showPromotionModal(move) {\n  promotionModal.style.display = \"block\";\n  promotionModal.dataset.fromRow = move.from.row;\n  promotionModal.dataset.fromCol = move.from.col;\n  promotionModal.dataset.toRow = move.to.row;\n  promotionModal.dataset.toCol = move.to.col;\n  promotionModal.dataset.color = move.piece.color;\n  promotionModal.dataset.pieceType = move.piece.type;\n}\npromotionChoices.forEach(choice => {\n  choice.addEventListener(\"click\", function () {\n    let selectedType = this.dataset.type;\n    let move = {\n      from: {\n        row: parseInt(promotionModal.dataset.fromRow),\n        col: parseInt(promotionModal.dataset.fromCol)\n      },\n      to: {\n        row: parseInt(promotionModal.dataset.toRow),\n        col: parseInt(promotionModal.dataset.toCol)\n      },\n      piece: {\n        type: promotionModal.dataset.pieceType,\n        color: promotionModal.dataset.color\n      }\n    };\n    board[move.to.row][move.to.col] = createPiece(selectedType, move.piece.color);\n    board[move.from.row][move.from.col] = null;\n    promotionModal.style.display = \"none\";\n    board[move.to.row][move.to.col].hasMoved = true;\n    moveHistory.push(move);\n    updateFiftyMoveCounter(move);\n    updateBoardHistory();\n    if (checkForCheckmate(board, getOpponent(currentPlayer))) {\n      alert(\"Checkmate! \" + getOpponent(currentPlayer) + \" wins.\");\n      clearInterval(clockInterval);\n      resetGame();\n      return;\n    } else if (checkForStalemate(board, getOpponent(currentPlayer))) {\n      alert(\"Stalemate!\");\n      clearInterval(clockInterval);\n      resetGame();\n      return;\n    }\n    currentPlayer = getOpponent(currentPlayer);\n    startClock();\n    selectedPiece = null;\n    selectedPos = null;\n    drawBoard();\n  });\n});\n\n/* ----- BOARD HISTORY & DRAWING RULES ----- */\nfunction serializeBoard(board) {\n  return board.map(row => row.map(cell => cell ? cell.type[0] + cell.color[0] : \"  \").join(\"\")).join(\"|\");\n}\nfunction updateBoardHistory() {\n  boardHistory.push(serializeBoard(board));\n}\nfunction isThreefoldRepetition() {\n  let counts = {};\n  boardHistory.forEach(state => {\n    counts[state] = (counts[state] || 0) + 1;\n  });\n  return Object.values(counts).some(count => count >= 3);\n}\nfunction updateFiftyMoveCounter(move) {\n  if (move.piece.type === \"pawn\" || board[move.to.row][move.to.col] !== null) {\n    fiftyMoveCounter = 0;\n  } else {\n    fiftyMoveCounter++;\n  }\n}\nfunction isFiftyMoveRule() {\n  return fiftyMoveCounter >= 50;\n}\n\n/* ----- CHECKMATE & STALEMATE ----- */\n// Checkmate: the current player's king is in check and has no legal moves.\nfunction checkForCheckmate(board, color) {\n  if (!isKingSafe(board, color)) {\n    let moves = generateAllMoves(board, color);\n    let legalMoves = moves.filter(m => isLegalMove(board, m, color));\n    if (legalMoves.length === 0) {\n      console.log(\"Checkmate detected for\", color);\n      return true;\n    }\n  }\n  return false;\n}\nfunction checkForStalemate(board, color) {\n  if (isKingSafe(board, color)) {\n    let moves = generateAllMoves(board, color);\n    let legalMoves = moves.filter(m => isLegalMove(board, m, color));\n    if (legalMoves.length === 0) return true;\n  }\n  return false;\n}\nfunction generateAllMoves(board, color) {\n  let moves = [];\n  for (let r = 0; r < 8; r++) {\n    for (let c = 0; c < 8; c++) {\n      let piece = board[r][c];\n      if (piece && piece.color === color) {\n        moves = moves.concat(generateMovesForPiece(board, {\n          row: r,\n          col: c\n        }));\n      }\n    }\n  }\n  return moves;\n}\n\n/* ----- MOVE VALIDATION ----- */\nfunction isLegalMove(board, move, color) {\n  let moves = generateMovesForPiece(board, move.from);\n  let legal = moves.some(m => m.to.row === move.to.row && m.to.col === move.to.col);\n  if (!legal) {\n    console.log(\"Move not in generated moves:\", move);\n    return false;\n  }\n  let newBoard = cloneBoard(board);\n  newBoard[move.to.row][move.to.col] = newBoard[move.from.row][move.from.col];\n  newBoard[move.from.row][move.from.col] = null;\n  let kingPos = findKing(newBoard, color);\n  if (!kingPos) {\n    console.log(\"King not found after move:\", move);\n    return false;\n  }\n  if (!isKingSafe(newBoard, color)) {\n    console.log(\"King would be in check after move:\", move, \"King at:\", kingPos);\n    return false;\n  }\n  return true;\n}\n\n/* ----- END GAME INITIALIZATION ----- */\n// Only initialize if running in browser\nif (typeof process === 'undefined' || !process.env.NODE_ENV === 'test') {\n  initializeBoard();\n}\n\n// Export for Jest testing while maintaining browser compatibility\nif (typeof module !== 'undefined' && module.exports) {\n  module.exports = {\n    isPrime,\n    generateRookMoves,\n    generatePawnMoves,\n    isLegalMove,\n    initializeBoard,\n    checkForCheckmate,\n    isSquareAttacked,\n    serializeBoard,\n    cloneBoard,\n    getOpponent,\n    performCastle,\n    canCastle,\n    isEnPassantMove,\n    generateMovesForPiece,\n    isInBounds,\n    isKingSafe,\n    createPiece,\n    enPassantTarget\n  };\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJib2FyZEVsZW1lbnQiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwicHJvbW90aW9uTW9kYWwiLCJwcm9tb3Rpb25DaG9pY2VzIiwicXVlcnlTZWxlY3RvckFsbCIsInN0YXJ0R2FtZUJ0biIsImdhbWVNb2RlU2VsZWN0Iiwid2hpdGVDbG9ja0VsIiwiYmxhY2tDbG9ja0VsIiwibWVudVNjcmVlbiIsImdhbWVTY3JlZW4iLCJib2FyZCIsImN1cnJlbnRQbGF5ZXIiLCJzZWxlY3RlZFBpZWNlIiwic2VsZWN0ZWRQb3MiLCJtb3ZlSGlzdG9yeSIsImJvYXJkSGlzdG9yeSIsImZpZnR5TW92ZUNvdW50ZXIiLCJlblBhc3NhbnRUYXJnZXQiLCJ3aGl0ZVRpbWUiLCJibGFja1RpbWUiLCJjbG9ja0ludGVydmFsIiwiZHJhZ2dpbmdQaWVjZUVsIiwiZHJhZ09mZnNldCIsIngiLCJ5IiwiZHJhZ1N0YXJ0UG9zIiwiaXNQcmltZSIsIm4iLCJpIiwiTWF0aCIsInNxcnQiLCJzdGFydENsb2NrIiwiY2xlYXJJbnRlcnZhbCIsInNldEludGVydmFsIiwiYWxlcnQiLCJyZXNldEdhbWUiLCJ1cGRhdGVDbG9ja0Rpc3BsYXkiLCJpbm5lclRleHQiLCJmb3JtYXRUaW1lIiwic2Vjb25kcyIsIm0iLCJmbG9vciIsInMiLCJhZGRFdmVudExpc3RlbmVyIiwiaW5pdGlhbFRpbWUiLCJwYXJzZUludCIsInZhbHVlIiwic3R5bGUiLCJkaXNwbGF5IiwiaW5pdGlhbGl6ZUJvYXJkIiwiQXJyYXkiLCJmaWxsIiwibWFwIiwiY3JlYXRlUGllY2UiLCJkcmF3Qm9hcmQiLCJ1cGRhdGVCb2FyZEhpc3RvcnkiLCJ0eXBlIiwiY29sb3IiLCJoYXNNb3ZlZCIsImlubmVySFRNTCIsInJvdyIsImNvbCIsInNxdWFyZSIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc0xpc3QiLCJhZGQiLCJkYXRhc2V0IiwiaXNTcXVhcmVBdHRhY2tlZCIsImdldE9wcG9uZW50IiwicGllY2VFbCIsInNyYyIsImdldFBpZWNlSW1hZ2VTcmMiLCJhbHQiLCJvblBpZWNlTW91c2VEb3duIiwiYXBwZW5kQ2hpbGQiLCJvblNxdWFyZUNsaWNrIiwicGllY2UiLCJlIiwiY3VycmVudFRhcmdldCIsIm1vdmUiLCJmcm9tIiwidG8iLCJpc0xlZ2FsTW92ZSIsIm1ha2VNb3ZlIiwiY29uc29sZSIsImxvZyIsInRhcmdldCIsInBhcmVudEVsZW1lbnQiLCJjbG9uZU5vZGUiLCJib2R5IiwicmVjdCIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsImNsaWVudFgiLCJsZWZ0IiwiY2xpZW50WSIsInRvcCIsIm9uTW91c2VNb3ZlIiwib25Nb3VzZVVwIiwiYm9hcmRSZWN0IiwiYWJzIiwiY2FzdGxlIiwicmVtb3ZlQ2hpbGQiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiaXNDYXN0bGluZ01vdmUiLCJwZXJmb3JtQ2FzdGxlIiwiaXNFblBhc3NhbnRNb3ZlIiwicGVyZm9ybUVuUGFzc2FudCIsImlzTGFzdFJhbmsiLCJzaG93UHJvbW90aW9uTW9kYWwiLCJoYW5kbGVQYXduRG91YmxlU3RlcCIsInB1c2giLCJ1cGRhdGVGaWZ0eU1vdmVDb3VudGVyIiwiY2hlY2tGb3JDaGVja21hdGUiLCJjaGVja0ZvclN0YWxlbWF0ZSIsImlzVGhyZWVmb2xkUmVwZXRpdGlvbiIsImlzRmlmdHlNb3ZlUnVsZSIsImdlbmVyYXRlTW92ZXNGb3JQaWVjZSIsInBvcyIsIm1vdmVzIiwiZ2VuZXJhdGVQYXduTW92ZXMiLCJnZW5lcmF0ZVJvb2tNb3ZlcyIsImdlbmVyYXRlS25pZ2h0TW92ZXMiLCJnZW5lcmF0ZUJpc2hvcE1vdmVzIiwiZ2VuZXJhdGVSb29rTW92ZXNEZWZhdWx0IiwiY29uY2F0IiwiZ2VuZXJhdGVLaW5nTW92ZXMiLCJnZW5lcmF0ZUNhc3RsaW5nTW92ZXMiLCJkaXJlY3Rpb24iLCJzdGFydFJvdyIsIm5leHRSb3ciLCJpc0luQm91bmRzIiwiZGMiLCJuZXdDb2wiLCJlblBhc3NhbnQiLCJkaXJlY3Rpb25zIiwiZm9yRWFjaCIsImQiLCJyIiwiYyIsInN0ZXBzIiwib2Zmc2V0cyIsIm8iLCJkZXN0U3F1YXJlIiwic3RhbmRhcmRQYXRoVmFsaWQiLCJtb2RpZmllZFBhd25Db3VudCIsIm1vZGlmaWVkUGF0aFZhbGlkIiwiY3VycmVudFIiLCJjdXJyZW50QyIsImdlbmVyYXRlUXVlZW5Nb3ZlcyIsImtpbmciLCJjYW5DYXN0bGUiLCJzaWRlIiwicm9vayIsImlzU3F1YXJlU2FmZUZvcktpbmciLCJ0ZW1wQm9hcmQiLCJjbG9uZUJvYXJkIiwiaXNLaW5nU2FmZSIsImNlbGwiLCJraW5nUG9zIiwiZmluZEtpbmciLCJhdHRhY2tlckNvbG9yIiwiY2FwdHVyZVJvdyIsImZyb21Sb3ciLCJmcm9tQ29sIiwidG9Sb3ciLCJ0b0NvbCIsInBpZWNlVHlwZSIsImNob2ljZSIsInNlbGVjdGVkVHlwZSIsInNlcmlhbGl6ZUJvYXJkIiwiam9pbiIsImNvdW50cyIsInN0YXRlIiwiT2JqZWN0IiwidmFsdWVzIiwic29tZSIsImNvdW50IiwiZ2VuZXJhdGVBbGxNb3ZlcyIsImxlZ2FsTW92ZXMiLCJmaWx0ZXIiLCJsZW5ndGgiLCJsZWdhbCIsIm5ld0JvYXJkIiwicHJvY2VzcyIsImVudiIsIk5PREVfRU5WIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL2hvbWUvYmF5ZXJuL0NoZXNzX1RlbXAvIiwic291cmNlcyI6WyJnYW1lQ29udHJvbGxlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKiBcbiAgTW9kaWZpZWQgQ2hlc3MgR2FtZSB3aXRoIFByaW1lIFJvb2sgTW92ZXMsIE1lbnUsIENoZXNzIENsb2NrLCBhbmQgQWR2YW5jZWQgUnVsZXM6XG4gIC0gRnJpZW5kbHkgcm9va3MgY2FuIG9ubHkgbW92ZSBhIHByaW1lIG51bWJlciBvZiBzcXVhcmVzIChhbGxvd2VkOiAyLCAzLCA1LCBvciA3KS5cbiAgLSBRdWVlbiBtb3ZlcyByZW1haW4gc3RhbmRhcmQuXG4gIC0gQWxsIG90aGVyIHJ1bGVzIChjYXN0bGluZywgZW4gcGFzc2FudCwgcGF3biBwcm9tb3Rpb24sIGV0Yy4pIHJlbWFpbiB1bmNoYW5nZWQuXG4qL1xuXG4vKiAtLS0tLSBET00gRUxFTUVOVFMgLS0tLS0gKi9cbmNvbnN0IGJvYXJkRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY2hlc3Nib2FyZFwiKTtcbmNvbnN0IHByb21vdGlvbk1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwcm9tb3Rpb25Nb2RhbFwiKTtcbmNvbnN0IHByb21vdGlvbkNob2ljZXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnByb21vdGlvbkNob2ljZVwiKTtcbmNvbnN0IHN0YXJ0R2FtZUJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic3RhcnRHYW1lXCIpO1xuY29uc3QgZ2FtZU1vZGVTZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImdhbWVNb2RlXCIpO1xuY29uc3Qgd2hpdGVDbG9ja0VsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ3aGl0ZUNsb2NrXCIpO1xuY29uc3QgYmxhY2tDbG9ja0VsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJibGFja0Nsb2NrXCIpO1xuY29uc3QgbWVudVNjcmVlbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibWVudVNjcmVlblwiKTtcbmNvbnN0IGdhbWVTY3JlZW4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImdhbWVTY3JlZW5cIik7XG5cbi8qIC0tLS0tIEdBTUUgU1RBVEUgVkFSSUFCTEVTIC0tLS0tICovXG5sZXQgYm9hcmQgPSBbXTtcbmxldCBjdXJyZW50UGxheWVyID0gXCJ3aGl0ZVwiO1xubGV0IHNlbGVjdGVkUGllY2UgPSBudWxsO1xubGV0IHNlbGVjdGVkUG9zID0gbnVsbDtcbmxldCBtb3ZlSGlzdG9yeSA9IFtdO1xubGV0IGJvYXJkSGlzdG9yeSA9IFtdO1xubGV0IGZpZnR5TW92ZUNvdW50ZXIgPSAwO1xubGV0IGVuUGFzc2FudFRhcmdldCA9IG51bGw7XG5cbi8qIC0tLS0tIENMT0NLIFZBUklBQkxFUyAtLS0tLSAqL1xubGV0IHdoaXRlVGltZSA9IDA7XG5sZXQgYmxhY2tUaW1lID0gMDtcbmxldCBjbG9ja0ludGVydmFsID0gbnVsbDtcblxuLyogLS0tLS0gRFJBR0dJTkcgU1RBVEUgLS0tLS0gKi9cbmxldCBkcmFnZ2luZ1BpZWNlRWwgPSBudWxsO1xubGV0IGRyYWdPZmZzZXQgPSB7IHg6IDAsIHk6IDAgfTtcbmxldCBkcmFnU3RhcnRQb3MgPSBudWxsO1xuXG4vKiAtLS0tLSBIRUxQRVI6IENoZWNrIGlmIG51bWJlciBpcyBwcmltZSAtLS0tLSAqL1xuZnVuY3Rpb24gaXNQcmltZShuKSB7XG4gIGlmIChuIDwgMikgcmV0dXJuIGZhbHNlO1xuICBmb3IgKGxldCBpID0gMjsgaSA8PSBNYXRoLnNxcnQobik7IGkrKykge1xuICAgIGlmIChuICUgaSA9PT0gMCkgcmV0dXJuIGZhbHNlO1xuICB9XG4gIHJldHVybiB0cnVlO1xufVxuXG4vKiAtLS0tLSBDTE9DSyBGVU5DVElPTlMgLS0tLS0gKi9cbmZ1bmN0aW9uIHN0YXJ0Q2xvY2soKSB7XG4gIGNsZWFySW50ZXJ2YWwoY2xvY2tJbnRlcnZhbCk7XG4gIGNsb2NrSW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgaWYgKGN1cnJlbnRQbGF5ZXIgPT09IFwid2hpdGVcIikge1xuICAgICAgd2hpdGVUaW1lLS07XG4gICAgICBpZiAod2hpdGVUaW1lIDw9IDApIHtcbiAgICAgICAgY2xlYXJJbnRlcnZhbChjbG9ja0ludGVydmFsKTtcbiAgICAgICAgYWxlcnQoXCJUaW1lJ3MgdXAhIEJsYWNrIHdpbnMhXCIpO1xuICAgICAgICByZXNldEdhbWUoKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBibGFja1RpbWUtLTtcbiAgICAgIGlmIChibGFja1RpbWUgPD0gMCkge1xuICAgICAgICBjbGVhckludGVydmFsKGNsb2NrSW50ZXJ2YWwpO1xuICAgICAgICBhbGVydChcIlRpbWUncyB1cCEgV2hpdGUgd2lucyFcIik7XG4gICAgICAgIHJlc2V0R2FtZSgpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgfVxuICAgIHVwZGF0ZUNsb2NrRGlzcGxheSgpO1xuICB9LCAxMDAwKTtcbn1cblxuZnVuY3Rpb24gdXBkYXRlQ2xvY2tEaXNwbGF5KCkge1xuICB3aGl0ZUNsb2NrRWwuaW5uZXJUZXh0ID0gZm9ybWF0VGltZSh3aGl0ZVRpbWUpO1xuICBibGFja0Nsb2NrRWwuaW5uZXJUZXh0ID0gZm9ybWF0VGltZShibGFja1RpbWUpO1xufVxuXG5mdW5jdGlvbiBmb3JtYXRUaW1lKHNlY29uZHMpIHtcbiAgbGV0IG0gPSBNYXRoLmZsb29yKHNlY29uZHMgLyA2MCk7XG4gIGxldCBzID0gc2Vjb25kcyAlIDYwO1xuICByZXR1cm4gKG0gPCAxMCA/IFwiMFwiICsgbSA6IG0pICsgXCI6XCIgKyAocyA8IDEwID8gXCIwXCIgKyBzIDogcyk7XG59XG5cbi8qIC0tLS0tIE1FTlUgQU5EIEdBTUUgU1RBUlQgLS0tLS0gKi9cbnN0YXJ0R2FtZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBsZXQgaW5pdGlhbFRpbWUgPSBwYXJzZUludChnYW1lTW9kZVNlbGVjdC52YWx1ZSk7XG4gIHdoaXRlVGltZSA9IGluaXRpYWxUaW1lO1xuICBibGFja1RpbWUgPSBpbml0aWFsVGltZTtcbiAgdXBkYXRlQ2xvY2tEaXNwbGF5KCk7XG4gIG1lbnVTY3JlZW4uc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuICBnYW1lU2NyZWVuLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XG4gIGluaXRpYWxpemVCb2FyZCgpO1xuICBzdGFydENsb2NrKCk7XG59KTtcblxuLyogLS0tLS0gSU5JVElBTElaQVRJT04gLS0tLS0gKi9cbmZ1bmN0aW9uIGluaXRpYWxpemVCb2FyZCgpIHtcbiAgYm9hcmQgPSBBcnJheSg4KVxuICAgIC5maWxsKG51bGwpXG4gICAgLm1hcCgoKSA9PiBBcnJheSg4KS5maWxsKG51bGwpKTtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCA4OyBpKyspIHtcbiAgICBib2FyZFsxXVtpXSA9IGNyZWF0ZVBpZWNlKFwicGF3blwiLCBcImJsYWNrXCIpO1xuICAgIGJvYXJkWzZdW2ldID0gY3JlYXRlUGllY2UoXCJwYXduXCIsIFwid2hpdGVcIik7XG4gIH1cbiAgYm9hcmRbMF1bMF0gPSBjcmVhdGVQaWVjZShcInJvb2tcIiwgXCJibGFja1wiKTtcbiAgYm9hcmRbMF1bN10gPSBjcmVhdGVQaWVjZShcInJvb2tcIiwgXCJibGFja1wiKTtcbiAgYm9hcmRbN11bMF0gPSBjcmVhdGVQaWVjZShcInJvb2tcIiwgXCJ3aGl0ZVwiKTtcbiAgYm9hcmRbN11bN10gPSBjcmVhdGVQaWVjZShcInJvb2tcIiwgXCJ3aGl0ZVwiKTtcbiAgYm9hcmRbMF1bMV0gPSBjcmVhdGVQaWVjZShcImtuaWdodFwiLCBcImJsYWNrXCIpO1xuICBib2FyZFswXVs2XSA9IGNyZWF0ZVBpZWNlKFwia25pZ2h0XCIsIFwiYmxhY2tcIik7XG4gIGJvYXJkWzddWzFdID0gY3JlYXRlUGllY2UoXCJrbmlnaHRcIiwgXCJ3aGl0ZVwiKTtcbiAgYm9hcmRbN11bNl0gPSBjcmVhdGVQaWVjZShcImtuaWdodFwiLCBcIndoaXRlXCIpO1xuICBib2FyZFswXVsyXSA9IGNyZWF0ZVBpZWNlKFwiYmlzaG9wXCIsIFwiYmxhY2tcIik7XG4gIGJvYXJkWzBdWzVdID0gY3JlYXRlUGllY2UoXCJiaXNob3BcIiwgXCJibGFja1wiKTtcbiAgYm9hcmRbN11bMl0gPSBjcmVhdGVQaWVjZShcImJpc2hvcFwiLCBcIndoaXRlXCIpO1xuICBib2FyZFs3XVs1XSA9IGNyZWF0ZVBpZWNlKFwiYmlzaG9wXCIsIFwid2hpdGVcIik7XG4gIGJvYXJkWzBdWzNdID0gY3JlYXRlUGllY2UoXCJxdWVlblwiLCBcImJsYWNrXCIpO1xuICBib2FyZFs3XVszXSA9IGNyZWF0ZVBpZWNlKFwicXVlZW5cIiwgXCJ3aGl0ZVwiKTtcbiAgYm9hcmRbMF1bNF0gPSBjcmVhdGVQaWVjZShcImtpbmdcIiwgXCJibGFja1wiKTtcbiAgYm9hcmRbN11bNF0gPSBjcmVhdGVQaWVjZShcImtpbmdcIiwgXCJ3aGl0ZVwiKTtcblxuICBtb3ZlSGlzdG9yeSA9IFtdO1xuICBib2FyZEhpc3RvcnkgPSBbXTtcbiAgZmlmdHlNb3ZlQ291bnRlciA9IDA7XG4gIGVuUGFzc2FudFRhcmdldCA9IG51bGw7XG4gIHNlbGVjdGVkUGllY2UgPSBudWxsO1xuICBzZWxlY3RlZFBvcyA9IG51bGw7XG4gIGN1cnJlbnRQbGF5ZXIgPSBcIndoaXRlXCI7XG5cbiAgZHJhd0JvYXJkKCk7XG4gIHVwZGF0ZUJvYXJkSGlzdG9yeSgpO1xufVxuXG5mdW5jdGlvbiByZXNldEdhbWUoKSB7XG4gIGNsZWFySW50ZXJ2YWwoY2xvY2tJbnRlcnZhbCk7XG4gIG1lbnVTY3JlZW4uc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcbiAgZ2FtZVNjcmVlbi5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG4gIGluaXRpYWxpemVCb2FyZCgpO1xufVxuXG4vKiAtLS0tLSBQSUVDRSBDUkVBVElPTiAtLS0tLSAqL1xuZnVuY3Rpb24gY3JlYXRlUGllY2UodHlwZSwgY29sb3IpIHtcbiAgcmV0dXJuIHsgdHlwZSwgY29sb3IsIGhhc01vdmVkOiBmYWxzZSB9O1xufVxuXG4vKiAtLS0tLSBEUkFXSU5HIFRIRSBCT0FSRCAtLS0tLSAqL1xuZnVuY3Rpb24gZHJhd0JvYXJkKCkge1xuICBib2FyZEVsZW1lbnQuaW5uZXJIVE1MID0gXCJcIjtcbiAgZm9yIChsZXQgcm93ID0gMDsgcm93IDwgODsgcm93KyspIHtcbiAgICBmb3IgKGxldCBjb2wgPSAwOyBjb2wgPCA4OyBjb2wrKykge1xuICAgICAgbGV0IHNxdWFyZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICBzcXVhcmUuY2xhc3NMaXN0LmFkZChcInNxdWFyZVwiKTtcbiAgICAgIHNxdWFyZS5kYXRhc2V0LnJvdyA9IHJvdztcbiAgICAgIHNxdWFyZS5kYXRhc2V0LmNvbCA9IGNvbDtcbiAgICAgIHNxdWFyZS5jbGFzc0xpc3QuYWRkKChyb3cgKyBjb2wpICUgMiA9PT0gMCA/IFwibGlnaHRcIiA6IFwiZGFya1wiKTtcblxuICAgICAgaWYgKHNlbGVjdGVkUG9zICYmIHNlbGVjdGVkUG9zLnJvdyA9PT0gcm93ICYmIHNlbGVjdGVkUG9zLmNvbCA9PT0gY29sKSB7XG4gICAgICAgIHNxdWFyZS5jbGFzc0xpc3QuYWRkKFwic2VsZWN0ZWRcIik7XG4gICAgICB9XG5cbiAgICAgIGlmIChib2FyZFtyb3ddW2NvbF0gJiYgYm9hcmRbcm93XVtjb2xdLnR5cGUgPT09IFwia2luZ1wiKSB7XG4gICAgICAgIGlmIChpc1NxdWFyZUF0dGFja2VkKGJvYXJkLCB7IHJvdywgY29sIH0sIGdldE9wcG9uZW50KGJvYXJkW3Jvd11bY29sXS5jb2xvcikpKSB7XG4gICAgICAgICAgc3F1YXJlLmNsYXNzTGlzdC5hZGQoXCJpbi1jaGVja1wiKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAoYm9hcmRbcm93XVtjb2xdKSB7XG4gICAgICAgIGxldCBwaWVjZUVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImltZ1wiKTtcbiAgICAgICAgcGllY2VFbC5jbGFzc0xpc3QuYWRkKFwicGllY2UtaW1nXCIsIGJvYXJkW3Jvd11bY29sXS5jb2xvciwgYm9hcmRbcm93XVtjb2xdLnR5cGUpO1xuICAgICAgICBwaWVjZUVsLnNyYyA9IGdldFBpZWNlSW1hZ2VTcmMoYm9hcmRbcm93XVtjb2xdKTtcbiAgICAgICAgcGllY2VFbC5hbHQgPSBib2FyZFtyb3ddW2NvbF0udHlwZTtcbiAgICAgICAgcGllY2VFbC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIG9uUGllY2VNb3VzZURvd24pO1xuICAgICAgICBzcXVhcmUuYXBwZW5kQ2hpbGQocGllY2VFbCk7XG4gICAgICB9XG4gICAgICBzcXVhcmUuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIG9uU3F1YXJlQ2xpY2spO1xuICAgICAgYm9hcmRFbGVtZW50LmFwcGVuZENoaWxkKHNxdWFyZSk7XG4gICAgfVxuICB9XG59XG5cbmZ1bmN0aW9uIGdldFBpZWNlSW1hZ2VTcmMocGllY2UpIHtcbiAgcmV0dXJuIGBhc3NldHMvJHtwaWVjZS5jb2xvcn1fJHtwaWVjZS50eXBlfS5wbmdgO1xufVxuXG4vKiAtLS0tLSBDTElDSyBIQU5ETElORyAtLS0tLSAqL1xuZnVuY3Rpb24gb25TcXVhcmVDbGljayhlKSB7XG4gIGlmIChkcmFnZ2luZ1BpZWNlRWwpIHJldHVybjtcblxuICBjb25zdCByb3cgPSBwYXJzZUludChlLmN1cnJlbnRUYXJnZXQuZGF0YXNldC5yb3cpO1xuICBjb25zdCBjb2wgPSBwYXJzZUludChlLmN1cnJlbnRUYXJnZXQuZGF0YXNldC5jb2wpO1xuXG4gIGlmIChib2FyZFtyb3ddW2NvbF0gJiYgYm9hcmRbcm93XVtjb2xdLmNvbG9yID09PSBjdXJyZW50UGxheWVyKSB7XG4gICAgc2VsZWN0ZWRQaWVjZSA9IGJvYXJkW3Jvd11bY29sXTtcbiAgICBzZWxlY3RlZFBvcyA9IHsgcm93LCBjb2wgfTtcbiAgfSBlbHNlIGlmIChzZWxlY3RlZFBpZWNlKSB7XG4gICAgbGV0IG1vdmUgPSB7XG4gICAgICBmcm9tOiB7IHJvdzogc2VsZWN0ZWRQb3Mucm93LCBjb2w6IHNlbGVjdGVkUG9zLmNvbCB9LFxuICAgICAgdG86IHsgcm93LCBjb2wgfSxcbiAgICAgIHBpZWNlOiBzZWxlY3RlZFBpZWNlLFxuICAgIH07XG4gICAgaWYgKGlzTGVnYWxNb3ZlKGJvYXJkLCBtb3ZlLCBjdXJyZW50UGxheWVyKSkge1xuICAgICAgbWFrZU1vdmUobW92ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnNvbGUubG9nKFwiSWxsZWdhbCBtb3ZlIGF0dGVtcHRlZDpcIiwgbW92ZSk7XG4gICAgfVxuICAgIHNlbGVjdGVkUGllY2UgPSBudWxsO1xuICAgIHNlbGVjdGVkUG9zID0gbnVsbDtcbiAgfVxuICBkcmF3Qm9hcmQoKTtcbn1cblxuLyogLS0tLS0gRFJBRy1UTy1NT1ZFIEhBTkRMSU5HIC0tLS0tICovXG5mdW5jdGlvbiBvblBpZWNlTW91c2VEb3duKGUpIHtcbiAgY29uc3Qgc3F1YXJlID0gZS50YXJnZXQucGFyZW50RWxlbWVudDtcbiAgY29uc3Qgcm93ID0gcGFyc2VJbnQoc3F1YXJlLmRhdGFzZXQucm93KTtcbiAgY29uc3QgY29sID0gcGFyc2VJbnQoc3F1YXJlLmRhdGFzZXQuY29sKTtcblxuICBpZiAoYm9hcmRbcm93XVtjb2xdLmNvbG9yICE9PSBjdXJyZW50UGxheWVyKSByZXR1cm47XG5cbiAgc2VsZWN0ZWRQaWVjZSA9IGJvYXJkW3Jvd11bY29sXTtcbiAgc2VsZWN0ZWRQb3MgPSB7IHJvdywgY29sIH07XG4gIGRyYWdTdGFydFBvcyA9IHsgcm93LCBjb2wgfTtcblxuICBkcmFnZ2luZ1BpZWNlRWwgPSBlLnRhcmdldC5jbG9uZU5vZGUodHJ1ZSk7XG4gIGRyYWdnaW5nUGllY2VFbC5jbGFzc0xpc3QuYWRkKFwiZHJhZ2dpbmdcIik7XG4gIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZHJhZ2dpbmdQaWVjZUVsKTtcblxuICBjb25zdCByZWN0ID0gZS50YXJnZXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gIGRyYWdPZmZzZXQueCA9IGUuY2xpZW50WCAtIHJlY3QubGVmdDtcbiAgZHJhZ09mZnNldC55ID0gZS5jbGllbnRZIC0gcmVjdC50b3A7XG5cbiAgZHJhd0JvYXJkKCk7XG5cbiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlbW92ZVwiLCBvbk1vdXNlTW92ZSk7XG4gIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZXVwXCIsIG9uTW91c2VVcCk7XG59XG5cbmZ1bmN0aW9uIG9uTW91c2VNb3ZlKGUpIHtcbiAgaWYgKGRyYWdnaW5nUGllY2VFbCkge1xuICAgIGRyYWdnaW5nUGllY2VFbC5zdHlsZS5sZWZ0ID0gZS5jbGllbnRYIC0gZHJhZ09mZnNldC54ICsgXCJweFwiO1xuICAgIGRyYWdnaW5nUGllY2VFbC5zdHlsZS50b3AgPSBlLmNsaWVudFkgLSBkcmFnT2Zmc2V0LnkgKyBcInB4XCI7XG4gIH1cbn1cblxuZnVuY3Rpb24gb25Nb3VzZVVwKGUpIHtcbiAgaWYgKCFkcmFnZ2luZ1BpZWNlRWwpIHJldHVybjtcblxuICBjb25zdCBib2FyZFJlY3QgPSBib2FyZEVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gIGNvbnN0IHggPSBlLmNsaWVudFggLSBib2FyZFJlY3QubGVmdDtcbiAgY29uc3QgeSA9IGUuY2xpZW50WSAtIGJvYXJkUmVjdC50b3A7XG4gIGNvbnN0IGNvbCA9IE1hdGguZmxvb3IoeCAvIDgwKTtcbiAgY29uc3Qgcm93ID0gTWF0aC5mbG9vcih5IC8gODApO1xuXG4gIGlmIChyb3cgPj0gMCAmJiByb3cgPCA4ICYmIGNvbCA+PSAwICYmIGNvbCA8IDgpIHtcbiAgICBsZXQgbW92ZSA9IHtcbiAgICAgIGZyb206IHsgcm93OiBkcmFnU3RhcnRQb3Mucm93LCBjb2w6IGRyYWdTdGFydFBvcy5jb2wgfSxcbiAgICAgIHRvOiB7IHJvdywgY29sIH0sXG4gICAgICBwaWVjZTogc2VsZWN0ZWRQaWVjZSxcbiAgICB9O1xuICAgIC8vIERldGVjdCBjYXN0bGluZzogaWYga2luZyBtb3ZlcyB0d28gc3F1YXJlcyBob3Jpem9udGFsbHlcbiAgICBpZiAoXG4gICAgICBtb3ZlLnBpZWNlLnR5cGUgPT09IFwia2luZ1wiICYmXG4gICAgICBNYXRoLmFicyhtb3ZlLnRvLmNvbCAtIG1vdmUuZnJvbS5jb2wpID09PSAyXG4gICAgKSB7XG4gICAgICBtb3ZlLmNhc3RsZSA9IG1vdmUudG8uY29sID4gbW92ZS5mcm9tLmNvbCA/IFwia2luZ3NpZGVcIiA6IFwicXVlZW5zaWRlXCI7XG4gICAgfVxuICAgIGlmIChpc0xlZ2FsTW92ZShib2FyZCwgbW92ZSwgY3VycmVudFBsYXllcikpIHtcbiAgICAgIG1ha2VNb3ZlKG1vdmUpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zb2xlLmxvZyhcIklsbGVnYWwgbW92ZSBhdHRlbXB0ZWQgdmlhIGRyYWc6XCIsIG1vdmUpO1xuICAgIH1cbiAgfVxuXG4gIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoZHJhZ2dpbmdQaWVjZUVsKTtcbiAgZHJhZ2dpbmdQaWVjZUVsID0gbnVsbDtcbiAgZHJhZ1N0YXJ0UG9zID0gbnVsbDtcbiAgc2VsZWN0ZWRQaWVjZSA9IG51bGw7XG4gIHNlbGVjdGVkUG9zID0gbnVsbDtcbiAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1vdXNlbW92ZVwiLCBvbk1vdXNlTW92ZSk7XG4gIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZXVwXCIsIG9uTW91c2VVcCk7XG4gIGRyYXdCb2FyZCgpO1xufVxuXG4vKiAtLS0tLSBNQUtJTkcgTU9WRVMgLS0tLS0gKi9cbmZ1bmN0aW9uIG1ha2VNb3ZlKG1vdmUpIHtcbiAgaWYgKGlzQ2FzdGxpbmdNb3ZlKG1vdmUpKSB7XG4gICAgcGVyZm9ybUNhc3RsZShtb3ZlKTtcbiAgfSBlbHNlIGlmIChpc0VuUGFzc2FudE1vdmUobW92ZSkpIHtcbiAgICBwZXJmb3JtRW5QYXNzYW50KG1vdmUpO1xuICB9IGVsc2Uge1xuICAgIGJvYXJkW21vdmUudG8ucm93XVttb3ZlLnRvLmNvbF0gPSBtb3ZlLnBpZWNlO1xuICAgIGJvYXJkW21vdmUuZnJvbS5yb3ddW21vdmUuZnJvbS5jb2xdID0gbnVsbDtcbiAgICBpZiAobW92ZS5waWVjZS50eXBlID09PSBcInBhd25cIiAmJiBpc0xhc3RSYW5rKG1vdmUudG8sIG1vdmUucGllY2UuY29sb3IpKSB7XG4gICAgICBzaG93UHJvbW90aW9uTW9kYWwobW92ZSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICB9XG4gIG1vdmUucGllY2UuaGFzTW92ZWQgPSB0cnVlO1xuICBoYW5kbGVQYXduRG91YmxlU3RlcChtb3ZlKTtcbiAgbW92ZUhpc3RvcnkucHVzaChtb3ZlKTtcbiAgdXBkYXRlRmlmdHlNb3ZlQ291bnRlcihtb3ZlKTtcbiAgdXBkYXRlQm9hcmRIaXN0b3J5KCk7XG5cbiAgLy8gU3dpdGNoIHR1cm4uIGN1cnJlbnRQbGF5ZXIgYmVjb21lcyB0aGUgcGxheWVyIHdobyBpcyBhYm91dCB0byBtb3ZlLlxuICBjdXJyZW50UGxheWVyID0gZ2V0T3Bwb25lbnQoY3VycmVudFBsYXllcik7XG4gIHN0YXJ0Q2xvY2soKTtcblxuICAvLyBGSVhFRDogQ2hlY2sgZm9yIGNoZWNrbWF0ZSBvbiB0aGUgY3VycmVudCBwbGF5ZXIncyB0dXJuXG4gIGlmIChjaGVja0ZvckNoZWNrbWF0ZShib2FyZCwgY3VycmVudFBsYXllcikpIHtcbiAgICBhbGVydChcIkNoZWNrbWF0ZSEgXCIgKyBnZXRPcHBvbmVudChjdXJyZW50UGxheWVyKSArIFwiIHdpbnMuXCIpO1xuICAgIGNsZWFySW50ZXJ2YWwoY2xvY2tJbnRlcnZhbCk7XG4gICAgcmVzZXRHYW1lKCk7XG4gICAgcmV0dXJuO1xuICB9IGVsc2UgaWYgKGNoZWNrRm9yU3RhbGVtYXRlKGJvYXJkLCBjdXJyZW50UGxheWVyKSkge1xuICAgIGFsZXJ0KFwiU3RhbGVtYXRlIVwiKTtcbiAgICBjbGVhckludGVydmFsKGNsb2NrSW50ZXJ2YWwpO1xuICAgIHJlc2V0R2FtZSgpO1xuICAgIHJldHVybjtcbiAgfSBlbHNlIGlmIChpc1RocmVlZm9sZFJlcGV0aXRpb24oKSkge1xuICAgIGFsZXJ0KFwiRHJhdyBieSB0aHJlZWZvbGQgcmVwZXRpdGlvbiFcIik7XG4gICAgY2xlYXJJbnRlcnZhbChjbG9ja0ludGVydmFsKTtcbiAgICByZXNldEdhbWUoKTtcbiAgICByZXR1cm47XG4gIH0gZWxzZSBpZiAoaXNGaWZ0eU1vdmVSdWxlKCkpIHtcbiAgICBhbGVydChcIkRyYXcgYnkgZmlmdHktbW92ZSBydWxlIVwiKTtcbiAgICBjbGVhckludGVydmFsKGNsb2NrSW50ZXJ2YWwpO1xuICAgIHJlc2V0R2FtZSgpO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHNlbGVjdGVkUGllY2UgPSBudWxsO1xuICBzZWxlY3RlZFBvcyA9IG51bGw7XG4gIGRyYXdCb2FyZCgpO1xufVxuXG4vKiAtLS0tLSBNT1ZFIEdFTkVSQVRJT04gLS0tLS0gKi9cbmZ1bmN0aW9uIGdlbmVyYXRlTW92ZXNGb3JQaWVjZShib2FyZCwgcG9zKSB7XG4gIGxldCBwaWVjZSA9IGJvYXJkW3Bvcy5yb3ddW3Bvcy5jb2xdO1xuICBpZiAoIXBpZWNlKSByZXR1cm4gW107XG4gIGxldCBtb3ZlcyA9IFtdO1xuICBzd2l0Y2ggKHBpZWNlLnR5cGUpIHtcbiAgICBjYXNlIFwicGF3blwiOlxuICAgICAgbW92ZXMgPSBnZW5lcmF0ZVBhd25Nb3Zlcyhib2FyZCwgcG9zLCBwaWVjZSk7XG4gICAgICBicmVhaztcbiAgICBjYXNlIFwicm9va1wiOlxuICAgICAgLy8gRnJpZW5kbHkgcm9va3M6IHJlc3RyaWN0IG1vdmVzIHRvIHByaW1lIG51bWJlciBvZiBzcXVhcmVzLlxuICAgICAgbW92ZXMgPSBnZW5lcmF0ZVJvb2tNb3Zlcyhib2FyZCwgcG9zLCBwaWVjZSk7XG4gICAgICBicmVhaztcbiAgICBjYXNlIFwia25pZ2h0XCI6XG4gICAgICBtb3ZlcyA9IGdlbmVyYXRlS25pZ2h0TW92ZXMoYm9hcmQsIHBvcywgcGllY2UpO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSBcImJpc2hvcFwiOlxuICAgICAgbW92ZXMgPSBnZW5lcmF0ZUJpc2hvcE1vdmVzKGJvYXJkLCBwb3MsIHBpZWNlKTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgXCJxdWVlblwiOlxuICAgICAgLy8gRm9yIHF1ZWVuLCB1c2UgZGVmYXVsdCByb29rIG1vdmVzIChubyBwcmltZSByZXN0cmljdGlvbikgcGx1cyBiaXNob3AgbW92ZXMuXG4gICAgICBtb3ZlcyA9IGdlbmVyYXRlUm9va01vdmVzRGVmYXVsdChib2FyZCwgcG9zLCBwaWVjZSkuY29uY2F0KFxuICAgICAgICBnZW5lcmF0ZUJpc2hvcE1vdmVzKGJvYXJkLCBwb3MsIHBpZWNlKVxuICAgICAgKTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgXCJraW5nXCI6XG4gICAgICBtb3ZlcyA9IGdlbmVyYXRlS2luZ01vdmVzKGJvYXJkLCBwb3MsIHBpZWNlKTtcbiAgICAgIG1vdmVzID0gbW92ZXMuY29uY2F0KGdlbmVyYXRlQ2FzdGxpbmdNb3Zlcyhib2FyZCwgcG9zLCBwaWVjZSkpO1xuICAgICAgYnJlYWs7XG4gIH1cbiAgcmV0dXJuIG1vdmVzO1xufVxuXG5mdW5jdGlvbiBnZW5lcmF0ZVBhd25Nb3Zlcyhib2FyZCwgcG9zLCBwaWVjZSkge1xuICBsZXQgbW92ZXMgPSBbXTtcbiAgbGV0IGRpcmVjdGlvbiA9IHBpZWNlLmNvbG9yID09PSBcIndoaXRlXCIgPyAtMSA6IDE7XG4gIGxldCBzdGFydFJvdyA9IHBpZWNlLmNvbG9yID09PSBcIndoaXRlXCIgPyA2IDogMTtcbiAgbGV0IG5leHRSb3cgPSBwb3Mucm93ICsgZGlyZWN0aW9uO1xuICBpZiAoaXNJbkJvdW5kcyhuZXh0Um93LCBwb3MuY29sKSAmJiBib2FyZFtuZXh0Um93XVtwb3MuY29sXSA9PT0gbnVsbCkge1xuICAgIG1vdmVzLnB1c2goeyBmcm9tOiBwb3MsIHRvOiB7IHJvdzogbmV4dFJvdywgY29sOiBwb3MuY29sIH0sIHBpZWNlIH0pO1xuICAgIGlmIChcbiAgICAgIHBvcy5yb3cgPT09IHN0YXJ0Um93ICYmXG4gICAgICBpc0luQm91bmRzKG5leHRSb3cgKyBkaXJlY3Rpb24sIHBvcy5jb2wpICYmXG4gICAgICBib2FyZFtuZXh0Um93ICsgZGlyZWN0aW9uXVtwb3MuY29sXSA9PT0gbnVsbFxuICAgICkge1xuICAgICAgbW92ZXMucHVzaCh7XG4gICAgICAgIGZyb206IHBvcyxcbiAgICAgICAgdG86IHsgcm93OiBuZXh0Um93ICsgZGlyZWN0aW9uLCBjb2w6IHBvcy5jb2wgfSxcbiAgICAgICAgcGllY2UsXG4gICAgICB9KTtcbiAgICB9XG4gIH1cbiAgZm9yIChsZXQgZGMgb2YgWy0xLCAxXSkge1xuICAgIGxldCBuZXdDb2wgPSBwb3MuY29sICsgZGM7XG4gICAgaWYgKGlzSW5Cb3VuZHMobmV4dFJvdywgbmV3Q29sKSkge1xuICAgICAgaWYgKGJvYXJkW25leHRSb3ddW25ld0NvbF0gJiYgYm9hcmRbbmV4dFJvd11bbmV3Q29sXS5jb2xvciAhPT0gcGllY2UuY29sb3IpIHtcbiAgICAgICAgbW92ZXMucHVzaCh7IGZyb206IHBvcywgdG86IHsgcm93OiBuZXh0Um93LCBjb2w6IG5ld0NvbCB9LCBwaWVjZSB9KTtcbiAgICAgIH1cbiAgICAgIGlmIChcbiAgICAgICAgYm9hcmRbbmV4dFJvd11bbmV3Q29sXSA9PT0gbnVsbCAmJlxuICAgICAgICBlblBhc3NhbnRUYXJnZXQgJiZcbiAgICAgICAgZW5QYXNzYW50VGFyZ2V0LnJvdyA9PT0gbmV4dFJvdyAmJlxuICAgICAgICBlblBhc3NhbnRUYXJnZXQuY29sID09PSBuZXdDb2xcbiAgICAgICkge1xuICAgICAgICBtb3Zlcy5wdXNoKHsgZnJvbTogcG9zLCB0bzogeyByb3c6IG5leHRSb3csIGNvbDogbmV3Q29sIH0sIHBpZWNlLCBlblBhc3NhbnQ6IHRydWUgfSk7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIHJldHVybiBtb3Zlcztcbn1cblxuLyogTW9kaWZpZWQgUm9vayBNb3ZlczogRm9yIGZyaWVuZGx5IHJvb2tzLCBhbGxvdyBtb3ZlcyBvbmx5IGlmIHRoZSBudW1iZXIgb2Ygc3F1YXJlcyBtb3ZlZCBpcyBwcmltZSAoMiwgMywgNSwgb3IgNykgKi9cbmZ1bmN0aW9uIGdlbmVyYXRlUm9va01vdmVzKGJvYXJkLCBwb3MsIHBpZWNlKSB7XG4gIGxldCBtb3ZlcyA9IFtdO1xuICBsZXQgZGlyZWN0aW9ucyA9IFtcbiAgICBbMSwgMF0sXG4gICAgWy0xLCAwXSxcbiAgICBbMCwgMV0sXG4gICAgWzAsIC0xXSxcbiAgXTtcbiAgZGlyZWN0aW9ucy5mb3JFYWNoKChkKSA9PiB7XG4gICAgbGV0IHIgPSBwb3Mucm93O1xuICAgIGxldCBjID0gcG9zLmNvbDtcbiAgICBsZXQgc3RlcHMgPSAwO1xuICAgIHdoaWxlICh0cnVlKSB7XG4gICAgICByICs9IGRbMF07XG4gICAgICBjICs9IGRbMV07XG4gICAgICBzdGVwcysrO1xuICAgICAgaWYgKCFpc0luQm91bmRzKHIsIGMpKSBicmVhaztcbiAgICAgIGlmIChpc1ByaW1lKHN0ZXBzKSkge1xuICAgICAgICBpZiAoYm9hcmRbcl1bY10gPT09IG51bGwpIHtcbiAgICAgICAgICBtb3Zlcy5wdXNoKHsgZnJvbTogcG9zLCB0bzogeyByb3c6IHIsIGNvbDogYyB9LCBwaWVjZSB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpZiAoYm9hcmRbcl1bY10uY29sb3IgIT09IHBpZWNlLmNvbG9yKSB7XG4gICAgICAgICAgICBtb3Zlcy5wdXNoKHsgZnJvbTogcG9zLCB0bzogeyByb3c6IHIsIGNvbDogYyB9LCBwaWVjZSB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmIChib2FyZFtyXVtjXSAhPT0gbnVsbCkgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuICB9KTtcbiAgcmV0dXJuIG1vdmVzO1xufVxuXG4vKiBEZWZhdWx0IFJvb2sgTW92ZXMgZm9yIHF1ZWVuIG1vdmVzIGFuZCBlbmVteSBhdHRhY2sgZGV0ZWN0aW9uIChubyBwcmltZSByZXN0cmljdGlvbikgKi9cbmZ1bmN0aW9uIGdlbmVyYXRlUm9va01vdmVzRGVmYXVsdChib2FyZCwgcG9zLCBwaWVjZSkge1xuICBsZXQgbW92ZXMgPSBbXTtcbiAgbGV0IGRpcmVjdGlvbnMgPSBbXG4gICAgWzEsIDBdLFxuICAgIFstMSwgMF0sXG4gICAgWzAsIDFdLFxuICAgIFswLCAtMV0sXG4gIF07XG4gIGRpcmVjdGlvbnMuZm9yRWFjaCgoZCkgPT4ge1xuICAgIGxldCByID0gcG9zLnJvdztcbiAgICBsZXQgYyA9IHBvcy5jb2w7XG4gICAgd2hpbGUgKHRydWUpIHtcbiAgICAgIHIgKz0gZFswXTtcbiAgICAgIGMgKz0gZFsxXTtcbiAgICAgIGlmICghaXNJbkJvdW5kcyhyLCBjKSkgYnJlYWs7XG4gICAgICBpZiAoYm9hcmRbcl1bY10gPT09IG51bGwpIHtcbiAgICAgICAgbW92ZXMucHVzaCh7IGZyb206IHBvcywgdG86IHsgcm93OiByLCBjb2w6IGMgfSwgcGllY2UgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBtb3Zlcy5wdXNoKHsgZnJvbTogcG9zLCB0bzogeyByb3c6IHIsIGNvbDogYyB9LCBwaWVjZSB9KTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuICB9KTtcbiAgcmV0dXJuIG1vdmVzO1xufVxuXG5mdW5jdGlvbiBnZW5lcmF0ZUtuaWdodE1vdmVzKGJvYXJkLCBwb3MsIHBpZWNlKSB7XG4gIGxldCBtb3ZlcyA9IFtdO1xuICBsZXQgb2Zmc2V0cyA9IFtcbiAgICBbLTIsIC0xXSxcbiAgICBbLTIsIDFdLFxuICAgIFstMSwgLTJdLFxuICAgIFstMSwgMl0sXG4gICAgWzEsIC0yXSxcbiAgICBbMSwgMl0sXG4gICAgWzIsIC0xXSxcbiAgICBbMiwgMV0sXG4gIF07XG4gIG9mZnNldHMuZm9yRWFjaCgobykgPT4ge1xuICAgIGxldCByID0gcG9zLnJvdyArIG9bMF07XG4gICAgbGV0IGMgPSBwb3MuY29sICsgb1sxXTtcbiAgICBpZiAoaXNJbkJvdW5kcyhyLCBjKSAmJiAoIWJvYXJkW3JdW2NdIHx8IGJvYXJkW3JdW2NdLmNvbG9yICE9PSBwaWVjZS5jb2xvcikpIHtcbiAgICAgIG1vdmVzLnB1c2goeyBmcm9tOiBwb3MsIHRvOiB7IHJvdzogciwgY29sOiBjIH0sIHBpZWNlIH0pO1xuICAgIH1cbiAgfSk7XG4gIHJldHVybiBtb3Zlcztcbn1cblxuZnVuY3Rpb24gZ2VuZXJhdGVCaXNob3BNb3Zlcyhib2FyZCwgcG9zLCBwaWVjZSkge1xuICBsZXQgbW92ZXMgPSBbXTtcbiAgbGV0IGRpcmVjdGlvbnMgPSBbXG4gICAgWzEsIDFdLFxuICAgIFsxLCAtMV0sXG4gICAgWy0xLCAxXSxcbiAgICBbLTEsIC0xXSxcbiAgXTtcbiAgZGlyZWN0aW9ucy5mb3JFYWNoKChkKSA9PiB7XG4gICAgZm9yIChsZXQgc3RlcHMgPSAxOyBzdGVwcyA8IDg7IHN0ZXBzKyspIHtcbiAgICAgIGxldCByID0gcG9zLnJvdyArIGRbMF0gKiBzdGVwcztcbiAgICAgIGxldCBjID0gcG9zLmNvbCArIGRbMV0gKiBzdGVwcztcbiAgICAgIGlmICghaXNJbkJvdW5kcyhyLCBjKSkgYnJlYWs7XG5cbiAgICAgIC8vIFNraXAgaWYgZGVzdGluYXRpb24gaXMgb2NjdXBpZWQgYnkgYSBmcmllbmRseSBwaWVjZVxuICAgICAgbGV0IGRlc3RTcXVhcmUgPSBib2FyZFtyXVtjXTtcbiAgICAgIGlmIChkZXN0U3F1YXJlICYmIGRlc3RTcXVhcmUuY29sb3IgPT09IHBpZWNlLmNvbG9yKSBjb250aW51ZTtcblxuICAgICAgbGV0IHN0YW5kYXJkUGF0aFZhbGlkID0gdHJ1ZTtcbiAgICAgIGxldCBtb2RpZmllZFBhd25Db3VudCA9IDA7XG4gICAgICBsZXQgbW9kaWZpZWRQYXRoVmFsaWQgPSB0cnVlO1xuXG4gICAgICAvLyBDaGVjayBzdGFuZGFyZCBwYXRoIHZhbGlkaXR5IChhbGwgaW50ZXJtZWRpYXRlIHNxdWFyZXMgZW1wdHkpXG4gICAgICBmb3IgKGxldCBzID0gMTsgcyA8IHN0ZXBzOyBzKyspIHtcbiAgICAgICAgbGV0IGN1cnJlbnRSID0gcG9zLnJvdyArIGRbMF0gKiBzO1xuICAgICAgICBsZXQgY3VycmVudEMgPSBwb3MuY29sICsgZFsxXSAqIHM7XG4gICAgICAgIGlmIChib2FyZFtjdXJyZW50Ul1bY3VycmVudENdICE9PSBudWxsKSB7XG4gICAgICAgICAgc3RhbmRhcmRQYXRoVmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBDaGVjayBtb2RpZmllZCBwYXRoIHZhbGlkaXR5IChleGFjdGx5IG9uZSBwYXduIGluIGludGVybWVkaWF0ZSBzcXVhcmVzKVxuICAgICAgZm9yIChsZXQgcyA9IDE7IHMgPCBzdGVwczsgcysrKSB7XG4gICAgICAgIGxldCBjdXJyZW50UiA9IHBvcy5yb3cgKyBkWzBdICogcztcbiAgICAgICAgbGV0IGN1cnJlbnRDID0gcG9zLmNvbCArIGRbMV0gKiBzO1xuICAgICAgICBsZXQgc3F1YXJlID0gYm9hcmRbY3VycmVudFJdW2N1cnJlbnRDXTtcbiAgICAgICAgaWYgKHNxdWFyZSkge1xuICAgICAgICAgIGlmIChzcXVhcmUudHlwZSA9PT0gJ3Bhd24nKSB7XG4gICAgICAgICAgICBtb2RpZmllZFBhd25Db3VudCsrO1xuICAgICAgICAgICAgaWYgKG1vZGlmaWVkUGF3bkNvdW50ID4gMSkge1xuICAgICAgICAgICAgICBtb2RpZmllZFBhdGhWYWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbW9kaWZpZWRQYXRoVmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgbW9kaWZpZWRQYXRoVmFsaWQgPSBtb2RpZmllZFBhdGhWYWxpZCAmJiBtb2RpZmllZFBhd25Db3VudCA9PT0gMTtcblxuICAgICAgLy8gQWRkIG1vdmUgaWYgZWl0aGVyIHBhdGggaXMgdmFsaWRcbiAgICAgIGlmIChzdGFuZGFyZFBhdGhWYWxpZCB8fCBtb2RpZmllZFBhdGhWYWxpZCkge1xuICAgICAgICBtb3Zlcy5wdXNoKHsgZnJvbTogcG9zLCB0bzogeyByb3c6IHIsIGNvbDogYyB9LCBwaWVjZSB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuICByZXR1cm4gbW92ZXM7XG59XG5cbmZ1bmN0aW9uIGdlbmVyYXRlUXVlZW5Nb3Zlcyhib2FyZCwgcG9zLCBwaWVjZSkge1xuICAvLyBRdWVlbiBtb3ZlcyA9IGRlZmF1bHQgcm9vayBtb3ZlcyAobm8gcHJpbWUgcmVzdHJpY3Rpb24pICsgYmlzaG9wIG1vdmVzXG4gIHJldHVybiBnZW5lcmF0ZVJvb2tNb3Zlc0RlZmF1bHQoYm9hcmQsIHBvcywgcGllY2UpLmNvbmNhdChcbiAgICBnZW5lcmF0ZUJpc2hvcE1vdmVzKGJvYXJkLCBwb3MsIHBpZWNlKVxuICApO1xufVxuXG5mdW5jdGlvbiBnZW5lcmF0ZUtpbmdNb3Zlcyhib2FyZCwgcG9zLCBwaWVjZSkge1xuICBsZXQgbW92ZXMgPSBbXTtcbiAgZm9yIChsZXQgciA9IHBvcy5yb3cgLSAxOyByIDw9IHBvcy5yb3cgKyAxOyByKyspIHtcbiAgICBmb3IgKGxldCBjID0gcG9zLmNvbCAtIDE7IGMgPD0gcG9zLmNvbCArIDE7IGMrKykge1xuICAgICAgaWYgKHIgPT09IHBvcy5yb3cgJiYgYyA9PT0gcG9zLmNvbCkgY29udGludWU7XG4gICAgICBpZiAoaXNJbkJvdW5kcyhyLCBjKSAmJiAoIWJvYXJkW3JdW2NdIHx8IGJvYXJkW3JdW2NdLmNvbG9yICE9PSBwaWVjZS5jb2xvcikpIHtcbiAgICAgICAgbW92ZXMucHVzaCh7IGZyb206IHBvcywgdG86IHsgcm93OiByLCBjb2w6IGMgfSwgcGllY2UgfSk7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIHJldHVybiBtb3Zlcztcbn1cblxuZnVuY3Rpb24gZ2VuZXJhdGVDYXN0bGluZ01vdmVzKGJvYXJkLCBwb3MsIGtpbmcpIHtcbiAgbGV0IG1vdmVzID0gW107XG4gIGlmIChraW5nLmhhc01vdmVkKSByZXR1cm4gbW92ZXM7XG4gIGlmIChjYW5DYXN0bGUoYm9hcmQsIGtpbmcsIHsgc2lkZTogXCJraW5nc2lkZVwiLCBwb3MgfSkpIHtcbiAgICBtb3Zlcy5wdXNoKHtcbiAgICAgIGZyb206IHBvcyxcbiAgICAgIHRvOiB7IHJvdzogcG9zLnJvdywgY29sOiBwb3MuY29sICsgMiB9LFxuICAgICAgcGllY2U6IGtpbmcsXG4gICAgICBjYXN0bGU6IFwia2luZ3NpZGVcIixcbiAgICB9KTtcbiAgfVxuICBpZiAoY2FuQ2FzdGxlKGJvYXJkLCBraW5nLCB7IHNpZGU6IFwicXVlZW5zaWRlXCIsIHBvcyB9KSkge1xuICAgIG1vdmVzLnB1c2goe1xuICAgICAgZnJvbTogcG9zLFxuICAgICAgdG86IHsgcm93OiBwb3Mucm93LCBjb2w6IHBvcy5jb2wgLSAyIH0sXG4gICAgICBwaWVjZToga2luZyxcbiAgICAgIGNhc3RsZTogXCJxdWVlbnNpZGVcIixcbiAgICB9KTtcbiAgfVxuICByZXR1cm4gbW92ZXM7XG59XG5cbi8qIC0tLS0tIENBU1RMSU5HIExPR0lDIC0tLS0tICovXG5mdW5jdGlvbiBjYW5DYXN0bGUoYm9hcmQsIGtpbmcsIHsgc2lkZSwgcG9zIH0pIHtcbiAgbGV0IHJvdyA9IHBvcy5yb3c7XG4gIGlmIChraW5nLmhhc01vdmVkKSByZXR1cm4gZmFsc2U7XG4gIGlmIChzaWRlID09PSBcImtpbmdzaWRlXCIpIHtcbiAgICBsZXQgcm9vayA9IGJvYXJkW3Jvd11bN107XG4gICAgaWYgKCFyb29rIHx8IHJvb2sudHlwZSAhPT0gXCJyb29rXCIgfHwgcm9vay5oYXNNb3ZlZCkgcmV0dXJuIGZhbHNlO1xuICAgIGlmIChib2FyZFtyb3ddWzVdICE9PSBudWxsIHx8IGJvYXJkW3Jvd11bNl0gIT09IG51bGwpIHJldHVybiBmYWxzZTtcbiAgICBpZiAoXG4gICAgICAhaXNTcXVhcmVTYWZlRm9yS2luZyhib2FyZCwgeyByb3csIGNvbDogNCB9LCBraW5nLmNvbG9yKSB8fFxuICAgICAgIWlzU3F1YXJlU2FmZUZvcktpbmcoYm9hcmQsIHsgcm93LCBjb2w6IDUgfSwga2luZy5jb2xvcikgfHxcbiAgICAgICFpc1NxdWFyZVNhZmVGb3JLaW5nKGJvYXJkLCB7IHJvdywgY29sOiA2IH0sIGtpbmcuY29sb3IpXG4gICAgKVxuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIHJldHVybiB0cnVlO1xuICB9IGVsc2UgaWYgKHNpZGUgPT09IFwicXVlZW5zaWRlXCIpIHtcbiAgICBsZXQgcm9vayA9IGJvYXJkW3Jvd11bMF07XG4gICAgaWYgKCFyb29rIHx8IHJvb2sudHlwZSAhPT0gXCJyb29rXCIgfHwgcm9vay5oYXNNb3ZlZCkgcmV0dXJuIGZhbHNlO1xuICAgIGlmIChib2FyZFtyb3ddWzFdICE9PSBudWxsIHx8IGJvYXJkW3Jvd11bMl0gIT09IG51bGwgfHwgYm9hcmRbcm93XVszXSAhPT0gbnVsbClcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICBpZiAoXG4gICAgICAhaXNTcXVhcmVTYWZlRm9yS2luZyhib2FyZCwgeyByb3csIGNvbDogNCB9LCBraW5nLmNvbG9yKSB8fFxuICAgICAgIWlzU3F1YXJlU2FmZUZvcktpbmcoYm9hcmQsIHsgcm93LCBjb2w6IDMgfSwga2luZy5jb2xvcikgfHxcbiAgICAgICFpc1NxdWFyZVNhZmVGb3JLaW5nKGJvYXJkLCB7IHJvdywgY29sOiAyIH0sIGtpbmcuY29sb3IpXG4gICAgKVxuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIHJldHVybiB0cnVlO1xuICB9XG4gIHJldHVybiBmYWxzZTtcbn1cblxuZnVuY3Rpb24gaXNTcXVhcmVTYWZlRm9yS2luZyhib2FyZCwgcG9zLCBjb2xvcikge1xuICBsZXQgdGVtcEJvYXJkID0gY2xvbmVCb2FyZChib2FyZCk7XG4gIHRlbXBCb2FyZFtwb3Mucm93XVtwb3MuY29sXSA9IHsgdHlwZTogXCJraW5nXCIsIGNvbG9yLCBoYXNNb3ZlZDogdHJ1ZSB9O1xuICByZXR1cm4gaXNLaW5nU2FmZSh0ZW1wQm9hcmQsIGNvbG9yKTtcbn1cblxuLyogLS0tLS0gSEVMUEVSIEZVTkNUSU9OUyAtLS0tLSAqL1xuZnVuY3Rpb24gaXNJbkJvdW5kcyhyb3csIGNvbCkge1xuICByZXR1cm4gcm93ID49IDAgJiYgcm93IDwgOCAmJiBjb2wgPj0gMCAmJiBjb2wgPCA4O1xufVxuXG5mdW5jdGlvbiBjbG9uZUJvYXJkKGJvYXJkKSB7XG4gIHJldHVybiBib2FyZC5tYXAoKHJvdykgPT4gcm93Lm1hcCgoY2VsbCkgPT4gKGNlbGwgPyB7IC4uLmNlbGwgfSA6IG51bGwpKSk7XG59XG5cbmZ1bmN0aW9uIGlzS2luZ1NhZmUoYm9hcmQsIGNvbG9yKSB7XG4gIGxldCBraW5nUG9zID0gZmluZEtpbmcoYm9hcmQsIGNvbG9yKTtcbiAgaWYgKCFraW5nUG9zKSByZXR1cm4gZmFsc2U7XG4gIHJldHVybiAhaXNTcXVhcmVBdHRhY2tlZChib2FyZCwga2luZ1BvcywgZ2V0T3Bwb25lbnQoY29sb3IpKTtcbn1cblxuZnVuY3Rpb24gZmluZEtpbmcoYm9hcmQsIGNvbG9yKSB7XG4gIGZvciAobGV0IHIgPSAwOyByIDwgODsgcisrKSB7XG4gICAgZm9yIChsZXQgYyA9IDA7IGMgPCA4OyBjKyspIHtcbiAgICAgIGxldCBwaWVjZSA9IGJvYXJkW3JdW2NdO1xuICAgICAgaWYgKHBpZWNlICYmIHBpZWNlLnR5cGUgPT09IFwia2luZ1wiICYmIHBpZWNlLmNvbG9yID09PSBjb2xvcikge1xuICAgICAgICByZXR1cm4geyByb3c6IHIsIGNvbDogYyB9O1xuICAgICAgfVxuICAgIH1cbiAgfVxuICByZXR1cm4gbnVsbDtcbn1cblxuZnVuY3Rpb24gaXNTcXVhcmVBdHRhY2tlZChib2FyZCwgcG9zLCBhdHRhY2tlckNvbG9yKSB7XG4gIGZvciAobGV0IHIgPSAwOyByIDwgODsgcisrKSB7XG4gICAgZm9yIChsZXQgYyA9IDA7IGMgPCA4OyBjKyspIHtcbiAgICAgIGxldCBwaWVjZSA9IGJvYXJkW3JdW2NdO1xuICAgICAgaWYgKHBpZWNlICYmIHBpZWNlLmNvbG9yID09PSBhdHRhY2tlckNvbG9yKSB7XG4gICAgICAgIGxldCBtb3ZlcztcbiAgICAgICAgaWYgKHBpZWNlLnR5cGUgPT09IFwicm9va1wiKSB7XG4gICAgICAgICAgLy8gRm9yIGVuZW15IHJvb2tzLCB1c2UgZnVsbC1yYW5nZSBtb3ZlcyAoZGVmYXVsdCkgZm9yIGF0dGFjayBkZXRlY3Rpb24uXG4gICAgICAgICAgbW92ZXMgPSBnZW5lcmF0ZVJvb2tNb3Zlc0RlZmF1bHQoYm9hcmQsIHsgcm93OiByLCBjb2w6IGMgfSwgcGllY2UpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG1vdmVzID0gZ2VuZXJhdGVNb3Zlc0ZvclBpZWNlKGJvYXJkLCB7IHJvdzogciwgY29sOiBjIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZvciAobGV0IG1vdmUgb2YgbW92ZXMpIHtcbiAgICAgICAgICBpZiAobW92ZS50by5yb3cgPT09IHBvcy5yb3cgJiYgbW92ZS50by5jb2wgPT09IHBvcy5jb2wpIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG4gIHJldHVybiBmYWxzZTtcbn1cblxuZnVuY3Rpb24gZ2V0T3Bwb25lbnQoY29sb3IpIHtcbiAgcmV0dXJuIGNvbG9yID09PSBcIndoaXRlXCIgPyBcImJsYWNrXCIgOiBcIndoaXRlXCI7XG59XG5cbi8qIC0tLS0tIEVOIFBBU1NBTlQgTE9HSUMgLS0tLS0gKi9cbmZ1bmN0aW9uIGhhbmRsZVBhd25Eb3VibGVTdGVwKG1vdmUpIHtcbiAgaWYgKFxuICAgIG1vdmUucGllY2UudHlwZSA9PT0gXCJwYXduXCIgJiZcbiAgICBNYXRoLmFicyhtb3ZlLmZyb20ucm93IC0gbW92ZS50by5yb3cpID09PSAyXG4gICkge1xuICAgIGVuUGFzc2FudFRhcmdldCA9IHtcbiAgICAgIHJvdzogKG1vdmUuZnJvbS5yb3cgKyBtb3ZlLnRvLnJvdykgLyAyLFxuICAgICAgY29sOiBtb3ZlLmZyb20uY29sLFxuICAgIH07XG4gIH0gZWxzZSB7XG4gICAgZW5QYXNzYW50VGFyZ2V0ID0gbnVsbDtcbiAgfVxufVxuXG5mdW5jdGlvbiBpc0VuUGFzc2FudE1vdmUobW92ZSkge1xuICByZXR1cm4gKFxuICAgIG1vdmUucGllY2UudHlwZSA9PT0gXCJwYXduXCIgJiZcbiAgICBtb3ZlLmZyb20uY29sICE9PSBtb3ZlLnRvLmNvbCAmJlxuICAgIGJvYXJkW21vdmUudG8ucm93XVttb3ZlLnRvLmNvbF0gPT09IG51bGxcbiAgKTtcbn1cblxuZnVuY3Rpb24gcGVyZm9ybUVuUGFzc2FudChtb3ZlKSB7XG4gIGJvYXJkW21vdmUudG8ucm93XVttb3ZlLnRvLmNvbF0gPSBtb3ZlLnBpZWNlO1xuICBib2FyZFttb3ZlLmZyb20ucm93XVttb3ZlLmZyb20uY29sXSA9IG51bGw7XG4gIGxldCBjYXB0dXJlUm93ID0gbW92ZS5waWVjZS5jb2xvciA9PT0gXCJ3aGl0ZVwiID8gbW92ZS50by5yb3cgKyAxIDogbW92ZS50by5yb3cgLSAxO1xuICBib2FyZFtjYXB0dXJlUm93XVttb3ZlLnRvLmNvbF0gPSBudWxsO1xufVxuXG4vKiAtLS0tLSBDQVNUTElORyBIQU5ETElORyAtLS0tLSAqL1xuZnVuY3Rpb24gaXNDYXN0bGluZ01vdmUobW92ZSkge1xuICByZXR1cm4gKFxuICAgIG1vdmUucGllY2UudHlwZSA9PT0gXCJraW5nXCIgJiYgTWF0aC5hYnMobW92ZS50by5jb2wgLSBtb3ZlLmZyb20uY29sKSA9PT0gMlxuICApO1xufVxuXG5mdW5jdGlvbiBwZXJmb3JtQ2FzdGxlKG1vdmUpIHtcbiAgbGV0IHJvdyA9IG1vdmUuZnJvbS5yb3c7XG4gIGlmIChtb3ZlLmNhc3RsZSA9PT0gXCJraW5nc2lkZVwiKSB7XG4gICAgYm9hcmRbcm93XVs2XSA9IG1vdmUucGllY2U7XG4gICAgYm9hcmRbcm93XVs0XSA9IG51bGw7XG4gICAgbGV0IHJvb2sgPSBib2FyZFtyb3ddWzddO1xuICAgIGJvYXJkW3Jvd11bNV0gPSByb29rO1xuICAgIGJvYXJkW3Jvd11bN10gPSBudWxsO1xuICAgIHJvb2suaGFzTW92ZWQgPSB0cnVlO1xuICB9IGVsc2UgaWYgKG1vdmUuY2FzdGxlID09PSBcInF1ZWVuc2lkZVwiKSB7XG4gICAgYm9hcmRbcm93XVsyXSA9IG1vdmUucGllY2U7XG4gICAgYm9hcmRbcm93XVs0XSA9IG51bGw7XG4gICAgbGV0IHJvb2sgPSBib2FyZFtyb3ddWzBdO1xuICAgIGJvYXJkW3Jvd11bM10gPSByb29rO1xuICAgIGJvYXJkW3Jvd11bMF0gPSBudWxsO1xuICAgIHJvb2suaGFzTW92ZWQgPSB0cnVlO1xuICB9XG59XG5cbi8qIC0tLS0tIFBBV04gUFJPTU9USU9OIC0tLS0tICovXG5mdW5jdGlvbiBpc0xhc3RSYW5rKHBvcywgY29sb3IpIHtcbiAgcmV0dXJuIChjb2xvciA9PT0gXCJ3aGl0ZVwiICYmIHBvcy5yb3cgPT09IDApIHx8IChjb2xvciA9PT0gXCJibGFja1wiICYmIHBvcy5yb3cgPT09IDcpO1xufVxuXG5mdW5jdGlvbiBzaG93UHJvbW90aW9uTW9kYWwobW92ZSkge1xuICBwcm9tb3Rpb25Nb2RhbC5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xuICBwcm9tb3Rpb25Nb2RhbC5kYXRhc2V0LmZyb21Sb3cgPSBtb3ZlLmZyb20ucm93O1xuICBwcm9tb3Rpb25Nb2RhbC5kYXRhc2V0LmZyb21Db2wgPSBtb3ZlLmZyb20uY29sO1xuICBwcm9tb3Rpb25Nb2RhbC5kYXRhc2V0LnRvUm93ID0gbW92ZS50by5yb3c7XG4gIHByb21vdGlvbk1vZGFsLmRhdGFzZXQudG9Db2wgPSBtb3ZlLnRvLmNvbDtcbiAgcHJvbW90aW9uTW9kYWwuZGF0YXNldC5jb2xvciA9IG1vdmUucGllY2UuY29sb3I7XG4gIHByb21vdGlvbk1vZGFsLmRhdGFzZXQucGllY2VUeXBlID0gbW92ZS5waWVjZS50eXBlO1xufVxuXG5wcm9tb3Rpb25DaG9pY2VzLmZvckVhY2goKGNob2ljZSkgPT4ge1xuICBjaG9pY2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcbiAgICBsZXQgc2VsZWN0ZWRUeXBlID0gdGhpcy5kYXRhc2V0LnR5cGU7XG4gICAgbGV0IG1vdmUgPSB7XG4gICAgICBmcm9tOiB7XG4gICAgICAgIHJvdzogcGFyc2VJbnQocHJvbW90aW9uTW9kYWwuZGF0YXNldC5mcm9tUm93KSxcbiAgICAgICAgY29sOiBwYXJzZUludChwcm9tb3Rpb25Nb2RhbC5kYXRhc2V0LmZyb21Db2wpLFxuICAgICAgfSxcbiAgICAgIHRvOiB7XG4gICAgICAgIHJvdzogcGFyc2VJbnQocHJvbW90aW9uTW9kYWwuZGF0YXNldC50b1JvdyksXG4gICAgICAgIGNvbDogcGFyc2VJbnQocHJvbW90aW9uTW9kYWwuZGF0YXNldC50b0NvbCksXG4gICAgICB9LFxuICAgICAgcGllY2U6IHtcbiAgICAgICAgdHlwZTogcHJvbW90aW9uTW9kYWwuZGF0YXNldC5waWVjZVR5cGUsXG4gICAgICAgIGNvbG9yOiBwcm9tb3Rpb25Nb2RhbC5kYXRhc2V0LmNvbG9yLFxuICAgICAgfSxcbiAgICB9O1xuICAgIGJvYXJkW21vdmUudG8ucm93XVttb3ZlLnRvLmNvbF0gPSBjcmVhdGVQaWVjZShzZWxlY3RlZFR5cGUsIG1vdmUucGllY2UuY29sb3IpO1xuICAgIGJvYXJkW21vdmUuZnJvbS5yb3ddW21vdmUuZnJvbS5jb2xdID0gbnVsbDtcbiAgICBwcm9tb3Rpb25Nb2RhbC5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG4gICAgYm9hcmRbbW92ZS50by5yb3ddW21vdmUudG8uY29sXS5oYXNNb3ZlZCA9IHRydWU7XG4gICAgbW92ZUhpc3RvcnkucHVzaChtb3ZlKTtcbiAgICB1cGRhdGVGaWZ0eU1vdmVDb3VudGVyKG1vdmUpO1xuICAgIHVwZGF0ZUJvYXJkSGlzdG9yeSgpO1xuICAgIGlmIChjaGVja0ZvckNoZWNrbWF0ZShib2FyZCwgZ2V0T3Bwb25lbnQoY3VycmVudFBsYXllcikpKSB7XG4gICAgICBhbGVydChcIkNoZWNrbWF0ZSEgXCIgKyBnZXRPcHBvbmVudChjdXJyZW50UGxheWVyKSArIFwiIHdpbnMuXCIpO1xuICAgICAgY2xlYXJJbnRlcnZhbChjbG9ja0ludGVydmFsKTtcbiAgICAgIHJlc2V0R2FtZSgpO1xuICAgICAgcmV0dXJuO1xuICAgIH0gZWxzZSBpZiAoY2hlY2tGb3JTdGFsZW1hdGUoYm9hcmQsIGdldE9wcG9uZW50KGN1cnJlbnRQbGF5ZXIpKSkge1xuICAgICAgYWxlcnQoXCJTdGFsZW1hdGUhXCIpO1xuICAgICAgY2xlYXJJbnRlcnZhbChjbG9ja0ludGVydmFsKTtcbiAgICAgIHJlc2V0R2FtZSgpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjdXJyZW50UGxheWVyID0gZ2V0T3Bwb25lbnQoY3VycmVudFBsYXllcik7XG4gICAgc3RhcnRDbG9jaygpO1xuICAgIHNlbGVjdGVkUGllY2UgPSBudWxsO1xuICAgIHNlbGVjdGVkUG9zID0gbnVsbDtcbiAgICBkcmF3Qm9hcmQoKTtcbiAgfSk7XG59KTtcblxuLyogLS0tLS0gQk9BUkQgSElTVE9SWSAmIERSQVdJTkcgUlVMRVMgLS0tLS0gKi9cbmZ1bmN0aW9uIHNlcmlhbGl6ZUJvYXJkKGJvYXJkKSB7XG4gIHJldHVybiBib2FyZFxuICAgIC5tYXAoKHJvdykgPT5cbiAgICAgIHJvdy5tYXAoKGNlbGwpID0+IChjZWxsID8gY2VsbC50eXBlWzBdICsgY2VsbC5jb2xvclswXSA6IFwiICBcIikpLmpvaW4oXCJcIilcbiAgICApXG4gICAgLmpvaW4oXCJ8XCIpO1xufVxuXG5mdW5jdGlvbiB1cGRhdGVCb2FyZEhpc3RvcnkoKSB7XG4gIGJvYXJkSGlzdG9yeS5wdXNoKHNlcmlhbGl6ZUJvYXJkKGJvYXJkKSk7XG59XG5cbmZ1bmN0aW9uIGlzVGhyZWVmb2xkUmVwZXRpdGlvbigpIHtcbiAgbGV0IGNvdW50cyA9IHt9O1xuICBib2FyZEhpc3RvcnkuZm9yRWFjaCgoc3RhdGUpID0+IHtcbiAgICBjb3VudHNbc3RhdGVdID0gKGNvdW50c1tzdGF0ZV0gfHwgMCkgKyAxO1xuICB9KTtcbiAgcmV0dXJuIE9iamVjdC52YWx1ZXMoY291bnRzKS5zb21lKChjb3VudCkgPT4gY291bnQgPj0gMyk7XG59XG5cbmZ1bmN0aW9uIHVwZGF0ZUZpZnR5TW92ZUNvdW50ZXIobW92ZSkge1xuICBpZiAobW92ZS5waWVjZS50eXBlID09PSBcInBhd25cIiB8fCBib2FyZFttb3ZlLnRvLnJvd11bbW92ZS50by5jb2xdICE9PSBudWxsKSB7XG4gICAgZmlmdHlNb3ZlQ291bnRlciA9IDA7XG4gIH0gZWxzZSB7XG4gICAgZmlmdHlNb3ZlQ291bnRlcisrO1xuICB9XG59XG5cbmZ1bmN0aW9uIGlzRmlmdHlNb3ZlUnVsZSgpIHtcbiAgcmV0dXJuIGZpZnR5TW92ZUNvdW50ZXIgPj0gNTA7XG59XG5cbi8qIC0tLS0tIENIRUNLTUFURSAmIFNUQUxFTUFURSAtLS0tLSAqL1xuLy8gQ2hlY2ttYXRlOiB0aGUgY3VycmVudCBwbGF5ZXIncyBraW5nIGlzIGluIGNoZWNrIGFuZCBoYXMgbm8gbGVnYWwgbW92ZXMuXG5mdW5jdGlvbiBjaGVja0ZvckNoZWNrbWF0ZShib2FyZCwgY29sb3IpIHtcbiAgaWYgKCFpc0tpbmdTYWZlKGJvYXJkLCBjb2xvcikpIHtcbiAgICBsZXQgbW92ZXMgPSBnZW5lcmF0ZUFsbE1vdmVzKGJvYXJkLCBjb2xvcik7XG4gICAgbGV0IGxlZ2FsTW92ZXMgPSBtb3Zlcy5maWx0ZXIoKG0pID0+IGlzTGVnYWxNb3ZlKGJvYXJkLCBtLCBjb2xvcikpO1xuICAgIGlmIChsZWdhbE1vdmVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgY29uc29sZS5sb2coXCJDaGVja21hdGUgZGV0ZWN0ZWQgZm9yXCIsIGNvbG9yKTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgfVxuICByZXR1cm4gZmFsc2U7XG59XG5cbmZ1bmN0aW9uIGNoZWNrRm9yU3RhbGVtYXRlKGJvYXJkLCBjb2xvcikge1xuICBpZiAoaXNLaW5nU2FmZShib2FyZCwgY29sb3IpKSB7XG4gICAgbGV0IG1vdmVzID0gZ2VuZXJhdGVBbGxNb3Zlcyhib2FyZCwgY29sb3IpO1xuICAgIGxldCBsZWdhbE1vdmVzID0gbW92ZXMuZmlsdGVyKChtKSA9PiBpc0xlZ2FsTW92ZShib2FyZCwgbSwgY29sb3IpKTtcbiAgICBpZiAobGVnYWxNb3Zlcy5sZW5ndGggPT09IDApIHJldHVybiB0cnVlO1xuICB9XG4gIHJldHVybiBmYWxzZTtcbn1cblxuZnVuY3Rpb24gZ2VuZXJhdGVBbGxNb3Zlcyhib2FyZCwgY29sb3IpIHtcbiAgbGV0IG1vdmVzID0gW107XG4gIGZvciAobGV0IHIgPSAwOyByIDwgODsgcisrKSB7XG4gICAgZm9yIChsZXQgYyA9IDA7IGMgPCA4OyBjKyspIHtcbiAgICAgIGxldCBwaWVjZSA9IGJvYXJkW3JdW2NdO1xuICAgICAgaWYgKHBpZWNlICYmIHBpZWNlLmNvbG9yID09PSBjb2xvcikge1xuICAgICAgICBtb3ZlcyA9IG1vdmVzLmNvbmNhdChnZW5lcmF0ZU1vdmVzRm9yUGllY2UoYm9hcmQsIHsgcm93OiByLCBjb2w6IGMgfSkpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICByZXR1cm4gbW92ZXM7XG59XG5cbi8qIC0tLS0tIE1PVkUgVkFMSURBVElPTiAtLS0tLSAqL1xuZnVuY3Rpb24gaXNMZWdhbE1vdmUoYm9hcmQsIG1vdmUsIGNvbG9yKSB7XG4gIGxldCBtb3ZlcyA9IGdlbmVyYXRlTW92ZXNGb3JQaWVjZShib2FyZCwgbW92ZS5mcm9tKTtcbiAgbGV0IGxlZ2FsID0gbW92ZXMuc29tZShcbiAgICAobSkgPT4gbS50by5yb3cgPT09IG1vdmUudG8ucm93ICYmIG0udG8uY29sID09PSBtb3ZlLnRvLmNvbFxuICApO1xuICBpZiAoIWxlZ2FsKSB7XG4gICAgY29uc29sZS5sb2coXCJNb3ZlIG5vdCBpbiBnZW5lcmF0ZWQgbW92ZXM6XCIsIG1vdmUpO1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIGxldCBuZXdCb2FyZCA9IGNsb25lQm9hcmQoYm9hcmQpO1xuICBuZXdCb2FyZFttb3ZlLnRvLnJvd11bbW92ZS50by5jb2xdID0gbmV3Qm9hcmRbbW92ZS5mcm9tLnJvd11bbW92ZS5mcm9tLmNvbF07XG4gIG5ld0JvYXJkW21vdmUuZnJvbS5yb3ddW21vdmUuZnJvbS5jb2xdID0gbnVsbDtcblxuICBsZXQga2luZ1BvcyA9IGZpbmRLaW5nKG5ld0JvYXJkLCBjb2xvcik7XG4gIGlmICgha2luZ1Bvcykge1xuICAgIGNvbnNvbGUubG9nKFwiS2luZyBub3QgZm91bmQgYWZ0ZXIgbW92ZTpcIiwgbW92ZSk7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgaWYgKCFpc0tpbmdTYWZlKG5ld0JvYXJkLCBjb2xvcikpIHtcbiAgICBjb25zb2xlLmxvZyhcIktpbmcgd291bGQgYmUgaW4gY2hlY2sgYWZ0ZXIgbW92ZTpcIiwgbW92ZSwgXCJLaW5nIGF0OlwiLCBraW5nUG9zKTtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICByZXR1cm4gdHJ1ZTtcbn1cblxuLyogLS0tLS0gRU5EIEdBTUUgSU5JVElBTElaQVRJT04gLS0tLS0gKi9cbi8vIE9ubHkgaW5pdGlhbGl6ZSBpZiBydW5uaW5nIGluIGJyb3dzZXJcbmlmICh0eXBlb2YgcHJvY2VzcyA9PT0gJ3VuZGVmaW5lZCcgfHwgIXByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAndGVzdCcpIHtcbiAgaW5pdGlhbGl6ZUJvYXJkKCk7XG59XG5cblxuLy8gRXhwb3J0IGZvciBKZXN0IHRlc3Rpbmcgd2hpbGUgbWFpbnRhaW5pbmcgYnJvd3NlciBjb21wYXRpYmlsaXR5XG5pZiAodHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcgJiYgbW9kdWxlLmV4cG9ydHMpIHtcbiAgbW9kdWxlLmV4cG9ydHMgPSB7XG4gICAgaXNQcmltZSxcbiAgICBnZW5lcmF0ZVJvb2tNb3ZlcyxcbiAgICBnZW5lcmF0ZVBhd25Nb3ZlcyxcbiAgICBpc0xlZ2FsTW92ZSxcbiAgICBpbml0aWFsaXplQm9hcmQsXG4gICAgY2hlY2tGb3JDaGVja21hdGUsXG4gICAgaXNTcXVhcmVBdHRhY2tlZCxcbiAgICBzZXJpYWxpemVCb2FyZCxcbiAgICBjbG9uZUJvYXJkLFxuICAgIGdldE9wcG9uZW50LFxuICAgIHBlcmZvcm1DYXN0bGUsXG4gICAgY2FuQ2FzdGxlLFxuICAgIGlzRW5QYXNzYW50TW92ZSxcbiAgICBnZW5lcmF0ZU1vdmVzRm9yUGllY2UsXG4gICAgaXNJbkJvdW5kcyxcbiAgICBpc0tpbmdTYWZlLFxuICAgIGNyZWF0ZVBpZWNlLFxuICAgIGVuUGFzc2FudFRhcmdldFxuICB9O1xufSJdLCJtYXBwaW5ncyI6Ijs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxNQUFNQSxZQUFZLEdBQUdDLFFBQVEsQ0FBQ0MsY0FBYyxDQUFDLFlBQVksQ0FBQztBQUMxRCxNQUFNQyxjQUFjLEdBQUdGLFFBQVEsQ0FBQ0MsY0FBYyxDQUFDLGdCQUFnQixDQUFDO0FBQ2hFLE1BQU1FLGdCQUFnQixHQUFHSCxRQUFRLENBQUNJLGdCQUFnQixDQUFDLGtCQUFrQixDQUFDO0FBQ3RFLE1BQU1DLFlBQVksR0FBR0wsUUFBUSxDQUFDQyxjQUFjLENBQUMsV0FBVyxDQUFDO0FBQ3pELE1BQU1LLGNBQWMsR0FBR04sUUFBUSxDQUFDQyxjQUFjLENBQUMsVUFBVSxDQUFDO0FBQzFELE1BQU1NLFlBQVksR0FBR1AsUUFBUSxDQUFDQyxjQUFjLENBQUMsWUFBWSxDQUFDO0FBQzFELE1BQU1PLFlBQVksR0FBR1IsUUFBUSxDQUFDQyxjQUFjLENBQUMsWUFBWSxDQUFDO0FBQzFELE1BQU1RLFVBQVUsR0FBR1QsUUFBUSxDQUFDQyxjQUFjLENBQUMsWUFBWSxDQUFDO0FBQ3hELE1BQU1TLFVBQVUsR0FBR1YsUUFBUSxDQUFDQyxjQUFjLENBQUMsWUFBWSxDQUFDOztBQUV4RDtBQUNBLElBQUlVLEtBQUssR0FBRyxFQUFFO0FBQ2QsSUFBSUMsYUFBYSxHQUFHLE9BQU87QUFDM0IsSUFBSUMsYUFBYSxHQUFHLElBQUk7QUFDeEIsSUFBSUMsV0FBVyxHQUFHLElBQUk7QUFDdEIsSUFBSUMsV0FBVyxHQUFHLEVBQUU7QUFDcEIsSUFBSUMsWUFBWSxHQUFHLEVBQUU7QUFDckIsSUFBSUMsZ0JBQWdCLEdBQUcsQ0FBQztBQUN4QixJQUFJQyxlQUFlLEdBQUcsSUFBSTs7QUFFMUI7QUFDQSxJQUFJQyxTQUFTLEdBQUcsQ0FBQztBQUNqQixJQUFJQyxTQUFTLEdBQUcsQ0FBQztBQUNqQixJQUFJQyxhQUFhLEdBQUcsSUFBSTs7QUFFeEI7QUFDQSxJQUFJQyxlQUFlLEdBQUcsSUFBSTtBQUMxQixJQUFJQyxVQUFVLEdBQUc7RUFBRUMsQ0FBQyxFQUFFLENBQUM7RUFBRUMsQ0FBQyxFQUFFO0FBQUUsQ0FBQztBQUMvQixJQUFJQyxZQUFZLEdBQUcsSUFBSTs7QUFFdkI7QUFDQSxTQUFTQyxPQUFPQSxDQUFDQyxDQUFDLEVBQUU7RUFDbEIsSUFBSUEsQ0FBQyxHQUFHLENBQUMsRUFBRSxPQUFPLEtBQUs7RUFDdkIsS0FBSyxJQUFJQyxDQUFDLEdBQUcsQ0FBQyxFQUFFQSxDQUFDLElBQUlDLElBQUksQ0FBQ0MsSUFBSSxDQUFDSCxDQUFDLENBQUMsRUFBRUMsQ0FBQyxFQUFFLEVBQUU7SUFDdEMsSUFBSUQsQ0FBQyxHQUFHQyxDQUFDLEtBQUssQ0FBQyxFQUFFLE9BQU8sS0FBSztFQUMvQjtFQUNBLE9BQU8sSUFBSTtBQUNiOztBQUVBO0FBQ0EsU0FBU0csVUFBVUEsQ0FBQSxFQUFHO0VBQ3BCQyxhQUFhLENBQUNaLGFBQWEsQ0FBQztFQUM1QkEsYUFBYSxHQUFHYSxXQUFXLENBQUMsTUFBTTtJQUNoQyxJQUFJdEIsYUFBYSxLQUFLLE9BQU8sRUFBRTtNQUM3Qk8sU0FBUyxFQUFFO01BQ1gsSUFBSUEsU0FBUyxJQUFJLENBQUMsRUFBRTtRQUNsQmMsYUFBYSxDQUFDWixhQUFhLENBQUM7UUFDNUJjLEtBQUssQ0FBQyx3QkFBd0IsQ0FBQztRQUMvQkMsU0FBUyxDQUFDLENBQUM7UUFDWDtNQUNGO0lBQ0YsQ0FBQyxNQUFNO01BQ0xoQixTQUFTLEVBQUU7TUFDWCxJQUFJQSxTQUFTLElBQUksQ0FBQyxFQUFFO1FBQ2xCYSxhQUFhLENBQUNaLGFBQWEsQ0FBQztRQUM1QmMsS0FBSyxDQUFDLHdCQUF3QixDQUFDO1FBQy9CQyxTQUFTLENBQUMsQ0FBQztRQUNYO01BQ0Y7SUFDRjtJQUNBQyxrQkFBa0IsQ0FBQyxDQUFDO0VBQ3RCLENBQUMsRUFBRSxJQUFJLENBQUM7QUFDVjtBQUVBLFNBQVNBLGtCQUFrQkEsQ0FBQSxFQUFHO0VBQzVCOUIsWUFBWSxDQUFDK0IsU0FBUyxHQUFHQyxVQUFVLENBQUNwQixTQUFTLENBQUM7RUFDOUNYLFlBQVksQ0FBQzhCLFNBQVMsR0FBR0MsVUFBVSxDQUFDbkIsU0FBUyxDQUFDO0FBQ2hEO0FBRUEsU0FBU21CLFVBQVVBLENBQUNDLE9BQU8sRUFBRTtFQUMzQixJQUFJQyxDQUFDLEdBQUdYLElBQUksQ0FBQ1ksS0FBSyxDQUFDRixPQUFPLEdBQUcsRUFBRSxDQUFDO0VBQ2hDLElBQUlHLENBQUMsR0FBR0gsT0FBTyxHQUFHLEVBQUU7RUFDcEIsT0FBTyxDQUFDQyxDQUFDLEdBQUcsRUFBRSxHQUFHLEdBQUcsR0FBR0EsQ0FBQyxHQUFHQSxDQUFDLElBQUksR0FBRyxJQUFJRSxDQUFDLEdBQUcsRUFBRSxHQUFHLEdBQUcsR0FBR0EsQ0FBQyxHQUFHQSxDQUFDLENBQUM7QUFDOUQ7O0FBRUE7QUFDQXRDLFlBQVksQ0FBQ3VDLGdCQUFnQixDQUFDLE9BQU8sRUFBRSxNQUFNO0VBQzNDLElBQUlDLFdBQVcsR0FBR0MsUUFBUSxDQUFDeEMsY0FBYyxDQUFDeUMsS0FBSyxDQUFDO0VBQ2hENUIsU0FBUyxHQUFHMEIsV0FBVztFQUN2QnpCLFNBQVMsR0FBR3lCLFdBQVc7RUFDdkJSLGtCQUFrQixDQUFDLENBQUM7RUFDcEI1QixVQUFVLENBQUN1QyxLQUFLLENBQUNDLE9BQU8sR0FBRyxNQUFNO0VBQ2pDdkMsVUFBVSxDQUFDc0MsS0FBSyxDQUFDQyxPQUFPLEdBQUcsT0FBTztFQUNsQ0MsZUFBZSxDQUFDLENBQUM7RUFDakJsQixVQUFVLENBQUMsQ0FBQztBQUNkLENBQUMsQ0FBQzs7QUFFRjtBQUNBLFNBQVNrQixlQUFlQSxDQUFBLEVBQUc7RUFDekJ2QyxLQUFLLEdBQUd3QyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQ2JDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FDVkMsR0FBRyxDQUFDLE1BQU1GLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQ0MsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO0VBQ2pDLEtBQUssSUFBSXZCLENBQUMsR0FBRyxDQUFDLEVBQUVBLENBQUMsR0FBRyxDQUFDLEVBQUVBLENBQUMsRUFBRSxFQUFFO0lBQzFCbEIsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDa0IsQ0FBQyxDQUFDLEdBQUd5QixXQUFXLENBQUMsTUFBTSxFQUFFLE9BQU8sQ0FBQztJQUMxQzNDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQ2tCLENBQUMsQ0FBQyxHQUFHeUIsV0FBVyxDQUFDLE1BQU0sRUFBRSxPQUFPLENBQUM7RUFDNUM7RUFDQTNDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRzJDLFdBQVcsQ0FBQyxNQUFNLEVBQUUsT0FBTyxDQUFDO0VBQzFDM0MsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHMkMsV0FBVyxDQUFDLE1BQU0sRUFBRSxPQUFPLENBQUM7RUFDMUMzQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcyQyxXQUFXLENBQUMsTUFBTSxFQUFFLE9BQU8sQ0FBQztFQUMxQzNDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRzJDLFdBQVcsQ0FBQyxNQUFNLEVBQUUsT0FBTyxDQUFDO0VBQzFDM0MsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHMkMsV0FBVyxDQUFDLFFBQVEsRUFBRSxPQUFPLENBQUM7RUFDNUMzQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcyQyxXQUFXLENBQUMsUUFBUSxFQUFFLE9BQU8sQ0FBQztFQUM1QzNDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRzJDLFdBQVcsQ0FBQyxRQUFRLEVBQUUsT0FBTyxDQUFDO0VBQzVDM0MsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHMkMsV0FBVyxDQUFDLFFBQVEsRUFBRSxPQUFPLENBQUM7RUFDNUMzQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcyQyxXQUFXLENBQUMsUUFBUSxFQUFFLE9BQU8sQ0FBQztFQUM1QzNDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRzJDLFdBQVcsQ0FBQyxRQUFRLEVBQUUsT0FBTyxDQUFDO0VBQzVDM0MsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHMkMsV0FBVyxDQUFDLFFBQVEsRUFBRSxPQUFPLENBQUM7RUFDNUMzQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcyQyxXQUFXLENBQUMsUUFBUSxFQUFFLE9BQU8sQ0FBQztFQUM1QzNDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRzJDLFdBQVcsQ0FBQyxPQUFPLEVBQUUsT0FBTyxDQUFDO0VBQzNDM0MsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHMkMsV0FBVyxDQUFDLE9BQU8sRUFBRSxPQUFPLENBQUM7RUFDM0MzQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcyQyxXQUFXLENBQUMsTUFBTSxFQUFFLE9BQU8sQ0FBQztFQUMxQzNDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRzJDLFdBQVcsQ0FBQyxNQUFNLEVBQUUsT0FBTyxDQUFDO0VBRTFDdkMsV0FBVyxHQUFHLEVBQUU7RUFDaEJDLFlBQVksR0FBRyxFQUFFO0VBQ2pCQyxnQkFBZ0IsR0FBRyxDQUFDO0VBQ3BCQyxlQUFlLEdBQUcsSUFBSTtFQUN0QkwsYUFBYSxHQUFHLElBQUk7RUFDcEJDLFdBQVcsR0FBRyxJQUFJO0VBQ2xCRixhQUFhLEdBQUcsT0FBTztFQUV2QjJDLFNBQVMsQ0FBQyxDQUFDO0VBQ1hDLGtCQUFrQixDQUFDLENBQUM7QUFDdEI7QUFFQSxTQUFTcEIsU0FBU0EsQ0FBQSxFQUFHO0VBQ25CSCxhQUFhLENBQUNaLGFBQWEsQ0FBQztFQUM1QlosVUFBVSxDQUFDdUMsS0FBSyxDQUFDQyxPQUFPLEdBQUcsT0FBTztFQUNsQ3ZDLFVBQVUsQ0FBQ3NDLEtBQUssQ0FBQ0MsT0FBTyxHQUFHLE1BQU07RUFDakNDLGVBQWUsQ0FBQyxDQUFDO0FBQ25COztBQUVBO0FBQ0EsU0FBU0ksV0FBV0EsQ0FBQ0csSUFBSSxFQUFFQyxLQUFLLEVBQUU7RUFDaEMsT0FBTztJQUFFRCxJQUFJO0lBQUVDLEtBQUs7SUFBRUMsUUFBUSxFQUFFO0VBQU0sQ0FBQztBQUN6Qzs7QUFFQTtBQUNBLFNBQVNKLFNBQVNBLENBQUEsRUFBRztFQUNuQnhELFlBQVksQ0FBQzZELFNBQVMsR0FBRyxFQUFFO0VBQzNCLEtBQUssSUFBSUMsR0FBRyxHQUFHLENBQUMsRUFBRUEsR0FBRyxHQUFHLENBQUMsRUFBRUEsR0FBRyxFQUFFLEVBQUU7SUFDaEMsS0FBSyxJQUFJQyxHQUFHLEdBQUcsQ0FBQyxFQUFFQSxHQUFHLEdBQUcsQ0FBQyxFQUFFQSxHQUFHLEVBQUUsRUFBRTtNQUNoQyxJQUFJQyxNQUFNLEdBQUcvRCxRQUFRLENBQUNnRSxhQUFhLENBQUMsS0FBSyxDQUFDO01BQzFDRCxNQUFNLENBQUNFLFNBQVMsQ0FBQ0MsR0FBRyxDQUFDLFFBQVEsQ0FBQztNQUM5QkgsTUFBTSxDQUFDSSxPQUFPLENBQUNOLEdBQUcsR0FBR0EsR0FBRztNQUN4QkUsTUFBTSxDQUFDSSxPQUFPLENBQUNMLEdBQUcsR0FBR0EsR0FBRztNQUN4QkMsTUFBTSxDQUFDRSxTQUFTLENBQUNDLEdBQUcsQ0FBQyxDQUFDTCxHQUFHLEdBQUdDLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLE9BQU8sR0FBRyxNQUFNLENBQUM7TUFFOUQsSUFBSWhELFdBQVcsSUFBSUEsV0FBVyxDQUFDK0MsR0FBRyxLQUFLQSxHQUFHLElBQUkvQyxXQUFXLENBQUNnRCxHQUFHLEtBQUtBLEdBQUcsRUFBRTtRQUNyRUMsTUFBTSxDQUFDRSxTQUFTLENBQUNDLEdBQUcsQ0FBQyxVQUFVLENBQUM7TUFDbEM7TUFFQSxJQUFJdkQsS0FBSyxDQUFDa0QsR0FBRyxDQUFDLENBQUNDLEdBQUcsQ0FBQyxJQUFJbkQsS0FBSyxDQUFDa0QsR0FBRyxDQUFDLENBQUNDLEdBQUcsQ0FBQyxDQUFDTCxJQUFJLEtBQUssTUFBTSxFQUFFO1FBQ3RELElBQUlXLGdCQUFnQixDQUFDekQsS0FBSyxFQUFFO1VBQUVrRCxHQUFHO1VBQUVDO1FBQUksQ0FBQyxFQUFFTyxXQUFXLENBQUMxRCxLQUFLLENBQUNrRCxHQUFHLENBQUMsQ0FBQ0MsR0FBRyxDQUFDLENBQUNKLEtBQUssQ0FBQyxDQUFDLEVBQUU7VUFDN0VLLE1BQU0sQ0FBQ0UsU0FBUyxDQUFDQyxHQUFHLENBQUMsVUFBVSxDQUFDO1FBQ2xDO01BQ0Y7TUFFQSxJQUFJdkQsS0FBSyxDQUFDa0QsR0FBRyxDQUFDLENBQUNDLEdBQUcsQ0FBQyxFQUFFO1FBQ25CLElBQUlRLE9BQU8sR0FBR3RFLFFBQVEsQ0FBQ2dFLGFBQWEsQ0FBQyxLQUFLLENBQUM7UUFDM0NNLE9BQU8sQ0FBQ0wsU0FBUyxDQUFDQyxHQUFHLENBQUMsV0FBVyxFQUFFdkQsS0FBSyxDQUFDa0QsR0FBRyxDQUFDLENBQUNDLEdBQUcsQ0FBQyxDQUFDSixLQUFLLEVBQUUvQyxLQUFLLENBQUNrRCxHQUFHLENBQUMsQ0FBQ0MsR0FBRyxDQUFDLENBQUNMLElBQUksQ0FBQztRQUMvRWEsT0FBTyxDQUFDQyxHQUFHLEdBQUdDLGdCQUFnQixDQUFDN0QsS0FBSyxDQUFDa0QsR0FBRyxDQUFDLENBQUNDLEdBQUcsQ0FBQyxDQUFDO1FBQy9DUSxPQUFPLENBQUNHLEdBQUcsR0FBRzlELEtBQUssQ0FBQ2tELEdBQUcsQ0FBQyxDQUFDQyxHQUFHLENBQUMsQ0FBQ0wsSUFBSTtRQUNsQ2EsT0FBTyxDQUFDMUIsZ0JBQWdCLENBQUMsV0FBVyxFQUFFOEIsZ0JBQWdCLENBQUM7UUFDdkRYLE1BQU0sQ0FBQ1ksV0FBVyxDQUFDTCxPQUFPLENBQUM7TUFDN0I7TUFDQVAsTUFBTSxDQUFDbkIsZ0JBQWdCLENBQUMsT0FBTyxFQUFFZ0MsYUFBYSxDQUFDO01BQy9DN0UsWUFBWSxDQUFDNEUsV0FBVyxDQUFDWixNQUFNLENBQUM7SUFDbEM7RUFDRjtBQUNGO0FBRUEsU0FBU1MsZ0JBQWdCQSxDQUFDSyxLQUFLLEVBQUU7RUFDL0IsT0FBTyxVQUFVQSxLQUFLLENBQUNuQixLQUFLLElBQUltQixLQUFLLENBQUNwQixJQUFJLE1BQU07QUFDbEQ7O0FBRUE7QUFDQSxTQUFTbUIsYUFBYUEsQ0FBQ0UsQ0FBQyxFQUFFO0VBQ3hCLElBQUl4RCxlQUFlLEVBQUU7RUFFckIsTUFBTXVDLEdBQUcsR0FBR2YsUUFBUSxDQUFDZ0MsQ0FBQyxDQUFDQyxhQUFhLENBQUNaLE9BQU8sQ0FBQ04sR0FBRyxDQUFDO0VBQ2pELE1BQU1DLEdBQUcsR0FBR2hCLFFBQVEsQ0FBQ2dDLENBQUMsQ0FBQ0MsYUFBYSxDQUFDWixPQUFPLENBQUNMLEdBQUcsQ0FBQztFQUVqRCxJQUFJbkQsS0FBSyxDQUFDa0QsR0FBRyxDQUFDLENBQUNDLEdBQUcsQ0FBQyxJQUFJbkQsS0FBSyxDQUFDa0QsR0FBRyxDQUFDLENBQUNDLEdBQUcsQ0FBQyxDQUFDSixLQUFLLEtBQUs5QyxhQUFhLEVBQUU7SUFDOURDLGFBQWEsR0FBR0YsS0FBSyxDQUFDa0QsR0FBRyxDQUFDLENBQUNDLEdBQUcsQ0FBQztJQUMvQmhELFdBQVcsR0FBRztNQUFFK0MsR0FBRztNQUFFQztJQUFJLENBQUM7RUFDNUIsQ0FBQyxNQUFNLElBQUlqRCxhQUFhLEVBQUU7SUFDeEIsSUFBSW1FLElBQUksR0FBRztNQUNUQyxJQUFJLEVBQUU7UUFBRXBCLEdBQUcsRUFBRS9DLFdBQVcsQ0FBQytDLEdBQUc7UUFBRUMsR0FBRyxFQUFFaEQsV0FBVyxDQUFDZ0Q7TUFBSSxDQUFDO01BQ3BEb0IsRUFBRSxFQUFFO1FBQUVyQixHQUFHO1FBQUVDO01BQUksQ0FBQztNQUNoQmUsS0FBSyxFQUFFaEU7SUFDVCxDQUFDO0lBQ0QsSUFBSXNFLFdBQVcsQ0FBQ3hFLEtBQUssRUFBRXFFLElBQUksRUFBRXBFLGFBQWEsQ0FBQyxFQUFFO01BQzNDd0UsUUFBUSxDQUFDSixJQUFJLENBQUM7SUFDaEIsQ0FBQyxNQUFNO01BQ0xLLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLHlCQUF5QixFQUFFTixJQUFJLENBQUM7SUFDOUM7SUFDQW5FLGFBQWEsR0FBRyxJQUFJO0lBQ3BCQyxXQUFXLEdBQUcsSUFBSTtFQUNwQjtFQUNBeUMsU0FBUyxDQUFDLENBQUM7QUFDYjs7QUFFQTtBQUNBLFNBQVNtQixnQkFBZ0JBLENBQUNJLENBQUMsRUFBRTtFQUMzQixNQUFNZixNQUFNLEdBQUdlLENBQUMsQ0FBQ1MsTUFBTSxDQUFDQyxhQUFhO0VBQ3JDLE1BQU0zQixHQUFHLEdBQUdmLFFBQVEsQ0FBQ2lCLE1BQU0sQ0FBQ0ksT0FBTyxDQUFDTixHQUFHLENBQUM7RUFDeEMsTUFBTUMsR0FBRyxHQUFHaEIsUUFBUSxDQUFDaUIsTUFBTSxDQUFDSSxPQUFPLENBQUNMLEdBQUcsQ0FBQztFQUV4QyxJQUFJbkQsS0FBSyxDQUFDa0QsR0FBRyxDQUFDLENBQUNDLEdBQUcsQ0FBQyxDQUFDSixLQUFLLEtBQUs5QyxhQUFhLEVBQUU7RUFFN0NDLGFBQWEsR0FBR0YsS0FBSyxDQUFDa0QsR0FBRyxDQUFDLENBQUNDLEdBQUcsQ0FBQztFQUMvQmhELFdBQVcsR0FBRztJQUFFK0MsR0FBRztJQUFFQztFQUFJLENBQUM7RUFDMUJwQyxZQUFZLEdBQUc7SUFBRW1DLEdBQUc7SUFBRUM7RUFBSSxDQUFDO0VBRTNCeEMsZUFBZSxHQUFHd0QsQ0FBQyxDQUFDUyxNQUFNLENBQUNFLFNBQVMsQ0FBQyxJQUFJLENBQUM7RUFDMUNuRSxlQUFlLENBQUMyQyxTQUFTLENBQUNDLEdBQUcsQ0FBQyxVQUFVLENBQUM7RUFDekNsRSxRQUFRLENBQUMwRixJQUFJLENBQUNmLFdBQVcsQ0FBQ3JELGVBQWUsQ0FBQztFQUUxQyxNQUFNcUUsSUFBSSxHQUFHYixDQUFDLENBQUNTLE1BQU0sQ0FBQ0sscUJBQXFCLENBQUMsQ0FBQztFQUM3Q3JFLFVBQVUsQ0FBQ0MsQ0FBQyxHQUFHc0QsQ0FBQyxDQUFDZSxPQUFPLEdBQUdGLElBQUksQ0FBQ0csSUFBSTtFQUNwQ3ZFLFVBQVUsQ0FBQ0UsQ0FBQyxHQUFHcUQsQ0FBQyxDQUFDaUIsT0FBTyxHQUFHSixJQUFJLENBQUNLLEdBQUc7RUFFbkN6QyxTQUFTLENBQUMsQ0FBQztFQUVYdkQsUUFBUSxDQUFDNEMsZ0JBQWdCLENBQUMsV0FBVyxFQUFFcUQsV0FBVyxDQUFDO0VBQ25EakcsUUFBUSxDQUFDNEMsZ0JBQWdCLENBQUMsU0FBUyxFQUFFc0QsU0FBUyxDQUFDO0FBQ2pEO0FBRUEsU0FBU0QsV0FBV0EsQ0FBQ25CLENBQUMsRUFBRTtFQUN0QixJQUFJeEQsZUFBZSxFQUFFO0lBQ25CQSxlQUFlLENBQUMwQixLQUFLLENBQUM4QyxJQUFJLEdBQUdoQixDQUFDLENBQUNlLE9BQU8sR0FBR3RFLFVBQVUsQ0FBQ0MsQ0FBQyxHQUFHLElBQUk7SUFDNURGLGVBQWUsQ0FBQzBCLEtBQUssQ0FBQ2dELEdBQUcsR0FBR2xCLENBQUMsQ0FBQ2lCLE9BQU8sR0FBR3hFLFVBQVUsQ0FBQ0UsQ0FBQyxHQUFHLElBQUk7RUFDN0Q7QUFDRjtBQUVBLFNBQVN5RSxTQUFTQSxDQUFDcEIsQ0FBQyxFQUFFO0VBQ3BCLElBQUksQ0FBQ3hELGVBQWUsRUFBRTtFQUV0QixNQUFNNkUsU0FBUyxHQUFHcEcsWUFBWSxDQUFDNkYscUJBQXFCLENBQUMsQ0FBQztFQUN0RCxNQUFNcEUsQ0FBQyxHQUFHc0QsQ0FBQyxDQUFDZSxPQUFPLEdBQUdNLFNBQVMsQ0FBQ0wsSUFBSTtFQUNwQyxNQUFNckUsQ0FBQyxHQUFHcUQsQ0FBQyxDQUFDaUIsT0FBTyxHQUFHSSxTQUFTLENBQUNILEdBQUc7RUFDbkMsTUFBTWxDLEdBQUcsR0FBR2hDLElBQUksQ0FBQ1ksS0FBSyxDQUFDbEIsQ0FBQyxHQUFHLEVBQUUsQ0FBQztFQUM5QixNQUFNcUMsR0FBRyxHQUFHL0IsSUFBSSxDQUFDWSxLQUFLLENBQUNqQixDQUFDLEdBQUcsRUFBRSxDQUFDO0VBRTlCLElBQUlvQyxHQUFHLElBQUksQ0FBQyxJQUFJQSxHQUFHLEdBQUcsQ0FBQyxJQUFJQyxHQUFHLElBQUksQ0FBQyxJQUFJQSxHQUFHLEdBQUcsQ0FBQyxFQUFFO0lBQzlDLElBQUlrQixJQUFJLEdBQUc7TUFDVEMsSUFBSSxFQUFFO1FBQUVwQixHQUFHLEVBQUVuQyxZQUFZLENBQUNtQyxHQUFHO1FBQUVDLEdBQUcsRUFBRXBDLFlBQVksQ0FBQ29DO01BQUksQ0FBQztNQUN0RG9CLEVBQUUsRUFBRTtRQUFFckIsR0FBRztRQUFFQztNQUFJLENBQUM7TUFDaEJlLEtBQUssRUFBRWhFO0lBQ1QsQ0FBQztJQUNEO0lBQ0EsSUFDRW1FLElBQUksQ0FBQ0gsS0FBSyxDQUFDcEIsSUFBSSxLQUFLLE1BQU0sSUFDMUIzQixJQUFJLENBQUNzRSxHQUFHLENBQUNwQixJQUFJLENBQUNFLEVBQUUsQ0FBQ3BCLEdBQUcsR0FBR2tCLElBQUksQ0FBQ0MsSUFBSSxDQUFDbkIsR0FBRyxDQUFDLEtBQUssQ0FBQyxFQUMzQztNQUNBa0IsSUFBSSxDQUFDcUIsTUFBTSxHQUFHckIsSUFBSSxDQUFDRSxFQUFFLENBQUNwQixHQUFHLEdBQUdrQixJQUFJLENBQUNDLElBQUksQ0FBQ25CLEdBQUcsR0FBRyxVQUFVLEdBQUcsV0FBVztJQUN0RTtJQUNBLElBQUlxQixXQUFXLENBQUN4RSxLQUFLLEVBQUVxRSxJQUFJLEVBQUVwRSxhQUFhLENBQUMsRUFBRTtNQUMzQ3dFLFFBQVEsQ0FBQ0osSUFBSSxDQUFDO0lBQ2hCLENBQUMsTUFBTTtNQUNMSyxPQUFPLENBQUNDLEdBQUcsQ0FBQyxrQ0FBa0MsRUFBRU4sSUFBSSxDQUFDO0lBQ3ZEO0VBQ0Y7RUFFQWhGLFFBQVEsQ0FBQzBGLElBQUksQ0FBQ1ksV0FBVyxDQUFDaEYsZUFBZSxDQUFDO0VBQzFDQSxlQUFlLEdBQUcsSUFBSTtFQUN0QkksWUFBWSxHQUFHLElBQUk7RUFDbkJiLGFBQWEsR0FBRyxJQUFJO0VBQ3BCQyxXQUFXLEdBQUcsSUFBSTtFQUNsQmQsUUFBUSxDQUFDdUcsbUJBQW1CLENBQUMsV0FBVyxFQUFFTixXQUFXLENBQUM7RUFDdERqRyxRQUFRLENBQUN1RyxtQkFBbUIsQ0FBQyxTQUFTLEVBQUVMLFNBQVMsQ0FBQztFQUNsRDNDLFNBQVMsQ0FBQyxDQUFDO0FBQ2I7O0FBRUE7QUFDQSxTQUFTNkIsUUFBUUEsQ0FBQ0osSUFBSSxFQUFFO0VBQ3RCLElBQUl3QixjQUFjLENBQUN4QixJQUFJLENBQUMsRUFBRTtJQUN4QnlCLGFBQWEsQ0FBQ3pCLElBQUksQ0FBQztFQUNyQixDQUFDLE1BQU0sSUFBSTBCLGVBQWUsQ0FBQzFCLElBQUksQ0FBQyxFQUFFO0lBQ2hDMkIsZ0JBQWdCLENBQUMzQixJQUFJLENBQUM7RUFDeEIsQ0FBQyxNQUFNO0lBQ0xyRSxLQUFLLENBQUNxRSxJQUFJLENBQUNFLEVBQUUsQ0FBQ3JCLEdBQUcsQ0FBQyxDQUFDbUIsSUFBSSxDQUFDRSxFQUFFLENBQUNwQixHQUFHLENBQUMsR0FBR2tCLElBQUksQ0FBQ0gsS0FBSztJQUM1Q2xFLEtBQUssQ0FBQ3FFLElBQUksQ0FBQ0MsSUFBSSxDQUFDcEIsR0FBRyxDQUFDLENBQUNtQixJQUFJLENBQUNDLElBQUksQ0FBQ25CLEdBQUcsQ0FBQyxHQUFHLElBQUk7SUFDMUMsSUFBSWtCLElBQUksQ0FBQ0gsS0FBSyxDQUFDcEIsSUFBSSxLQUFLLE1BQU0sSUFBSW1ELFVBQVUsQ0FBQzVCLElBQUksQ0FBQ0UsRUFBRSxFQUFFRixJQUFJLENBQUNILEtBQUssQ0FBQ25CLEtBQUssQ0FBQyxFQUFFO01BQ3ZFbUQsa0JBQWtCLENBQUM3QixJQUFJLENBQUM7TUFDeEI7SUFDRjtFQUNGO0VBQ0FBLElBQUksQ0FBQ0gsS0FBSyxDQUFDbEIsUUFBUSxHQUFHLElBQUk7RUFDMUJtRCxvQkFBb0IsQ0FBQzlCLElBQUksQ0FBQztFQUMxQmpFLFdBQVcsQ0FBQ2dHLElBQUksQ0FBQy9CLElBQUksQ0FBQztFQUN0QmdDLHNCQUFzQixDQUFDaEMsSUFBSSxDQUFDO0VBQzVCeEIsa0JBQWtCLENBQUMsQ0FBQzs7RUFFcEI7RUFDQTVDLGFBQWEsR0FBR3lELFdBQVcsQ0FBQ3pELGFBQWEsQ0FBQztFQUMxQ29CLFVBQVUsQ0FBQyxDQUFDOztFQUVaO0VBQ0EsSUFBSWlGLGlCQUFpQixDQUFDdEcsS0FBSyxFQUFFQyxhQUFhLENBQUMsRUFBRTtJQUMzQ3VCLEtBQUssQ0FBQyxhQUFhLEdBQUdrQyxXQUFXLENBQUN6RCxhQUFhLENBQUMsR0FBRyxRQUFRLENBQUM7SUFDNURxQixhQUFhLENBQUNaLGFBQWEsQ0FBQztJQUM1QmUsU0FBUyxDQUFDLENBQUM7SUFDWDtFQUNGLENBQUMsTUFBTSxJQUFJOEUsaUJBQWlCLENBQUN2RyxLQUFLLEVBQUVDLGFBQWEsQ0FBQyxFQUFFO0lBQ2xEdUIsS0FBSyxDQUFDLFlBQVksQ0FBQztJQUNuQkYsYUFBYSxDQUFDWixhQUFhLENBQUM7SUFDNUJlLFNBQVMsQ0FBQyxDQUFDO0lBQ1g7RUFDRixDQUFDLE1BQU0sSUFBSStFLHFCQUFxQixDQUFDLENBQUMsRUFBRTtJQUNsQ2hGLEtBQUssQ0FBQywrQkFBK0IsQ0FBQztJQUN0Q0YsYUFBYSxDQUFDWixhQUFhLENBQUM7SUFDNUJlLFNBQVMsQ0FBQyxDQUFDO0lBQ1g7RUFDRixDQUFDLE1BQU0sSUFBSWdGLGVBQWUsQ0FBQyxDQUFDLEVBQUU7SUFDNUJqRixLQUFLLENBQUMsMEJBQTBCLENBQUM7SUFDakNGLGFBQWEsQ0FBQ1osYUFBYSxDQUFDO0lBQzVCZSxTQUFTLENBQUMsQ0FBQztJQUNYO0VBQ0Y7RUFFQXZCLGFBQWEsR0FBRyxJQUFJO0VBQ3BCQyxXQUFXLEdBQUcsSUFBSTtFQUNsQnlDLFNBQVMsQ0FBQyxDQUFDO0FBQ2I7O0FBRUE7QUFDQSxTQUFTOEQscUJBQXFCQSxDQUFDMUcsS0FBSyxFQUFFMkcsR0FBRyxFQUFFO0VBQ3pDLElBQUl6QyxLQUFLLEdBQUdsRSxLQUFLLENBQUMyRyxHQUFHLENBQUN6RCxHQUFHLENBQUMsQ0FBQ3lELEdBQUcsQ0FBQ3hELEdBQUcsQ0FBQztFQUNuQyxJQUFJLENBQUNlLEtBQUssRUFBRSxPQUFPLEVBQUU7RUFDckIsSUFBSTBDLEtBQUssR0FBRyxFQUFFO0VBQ2QsUUFBUTFDLEtBQUssQ0FBQ3BCLElBQUk7SUFDaEIsS0FBSyxNQUFNO01BQ1Q4RCxLQUFLLEdBQUdDLGlCQUFpQixDQUFDN0csS0FBSyxFQUFFMkcsR0FBRyxFQUFFekMsS0FBSyxDQUFDO01BQzVDO0lBQ0YsS0FBSyxNQUFNO01BQ1Q7TUFDQTBDLEtBQUssR0FBR0UsaUJBQWlCLENBQUM5RyxLQUFLLEVBQUUyRyxHQUFHLEVBQUV6QyxLQUFLLENBQUM7TUFDNUM7SUFDRixLQUFLLFFBQVE7TUFDWDBDLEtBQUssR0FBR0csbUJBQW1CLENBQUMvRyxLQUFLLEVBQUUyRyxHQUFHLEVBQUV6QyxLQUFLLENBQUM7TUFDOUM7SUFDRixLQUFLLFFBQVE7TUFDWDBDLEtBQUssR0FBR0ksbUJBQW1CLENBQUNoSCxLQUFLLEVBQUUyRyxHQUFHLEVBQUV6QyxLQUFLLENBQUM7TUFDOUM7SUFDRixLQUFLLE9BQU87TUFDVjtNQUNBMEMsS0FBSyxHQUFHSyx3QkFBd0IsQ0FBQ2pILEtBQUssRUFBRTJHLEdBQUcsRUFBRXpDLEtBQUssQ0FBQyxDQUFDZ0QsTUFBTSxDQUN4REYsbUJBQW1CLENBQUNoSCxLQUFLLEVBQUUyRyxHQUFHLEVBQUV6QyxLQUFLLENBQ3ZDLENBQUM7TUFDRDtJQUNGLEtBQUssTUFBTTtNQUNUMEMsS0FBSyxHQUFHTyxpQkFBaUIsQ0FBQ25ILEtBQUssRUFBRTJHLEdBQUcsRUFBRXpDLEtBQUssQ0FBQztNQUM1QzBDLEtBQUssR0FBR0EsS0FBSyxDQUFDTSxNQUFNLENBQUNFLHFCQUFxQixDQUFDcEgsS0FBSyxFQUFFMkcsR0FBRyxFQUFFekMsS0FBSyxDQUFDLENBQUM7TUFDOUQ7RUFDSjtFQUNBLE9BQU8wQyxLQUFLO0FBQ2Q7QUFFQSxTQUFTQyxpQkFBaUJBLENBQUM3RyxLQUFLLEVBQUUyRyxHQUFHLEVBQUV6QyxLQUFLLEVBQUU7RUFDNUMsSUFBSTBDLEtBQUssR0FBRyxFQUFFO0VBQ2QsSUFBSVMsU0FBUyxHQUFHbkQsS0FBSyxDQUFDbkIsS0FBSyxLQUFLLE9BQU8sR0FBRyxDQUFDLENBQUMsR0FBRyxDQUFDO0VBQ2hELElBQUl1RSxRQUFRLEdBQUdwRCxLQUFLLENBQUNuQixLQUFLLEtBQUssT0FBTyxHQUFHLENBQUMsR0FBRyxDQUFDO0VBQzlDLElBQUl3RSxPQUFPLEdBQUdaLEdBQUcsQ0FBQ3pELEdBQUcsR0FBR21FLFNBQVM7RUFDakMsSUFBSUcsVUFBVSxDQUFDRCxPQUFPLEVBQUVaLEdBQUcsQ0FBQ3hELEdBQUcsQ0FBQyxJQUFJbkQsS0FBSyxDQUFDdUgsT0FBTyxDQUFDLENBQUNaLEdBQUcsQ0FBQ3hELEdBQUcsQ0FBQyxLQUFLLElBQUksRUFBRTtJQUNwRXlELEtBQUssQ0FBQ1IsSUFBSSxDQUFDO01BQUU5QixJQUFJLEVBQUVxQyxHQUFHO01BQUVwQyxFQUFFLEVBQUU7UUFBRXJCLEdBQUcsRUFBRXFFLE9BQU87UUFBRXBFLEdBQUcsRUFBRXdELEdBQUcsQ0FBQ3hEO01BQUksQ0FBQztNQUFFZTtJQUFNLENBQUMsQ0FBQztJQUNwRSxJQUNFeUMsR0FBRyxDQUFDekQsR0FBRyxLQUFLb0UsUUFBUSxJQUNwQkUsVUFBVSxDQUFDRCxPQUFPLEdBQUdGLFNBQVMsRUFBRVYsR0FBRyxDQUFDeEQsR0FBRyxDQUFDLElBQ3hDbkQsS0FBSyxDQUFDdUgsT0FBTyxHQUFHRixTQUFTLENBQUMsQ0FBQ1YsR0FBRyxDQUFDeEQsR0FBRyxDQUFDLEtBQUssSUFBSSxFQUM1QztNQUNBeUQsS0FBSyxDQUFDUixJQUFJLENBQUM7UUFDVDlCLElBQUksRUFBRXFDLEdBQUc7UUFDVHBDLEVBQUUsRUFBRTtVQUFFckIsR0FBRyxFQUFFcUUsT0FBTyxHQUFHRixTQUFTO1VBQUVsRSxHQUFHLEVBQUV3RCxHQUFHLENBQUN4RDtRQUFJLENBQUM7UUFDOUNlO01BQ0YsQ0FBQyxDQUFDO0lBQ0o7RUFDRjtFQUNBLEtBQUssSUFBSXVELEVBQUUsSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFO0lBQ3RCLElBQUlDLE1BQU0sR0FBR2YsR0FBRyxDQUFDeEQsR0FBRyxHQUFHc0UsRUFBRTtJQUN6QixJQUFJRCxVQUFVLENBQUNELE9BQU8sRUFBRUcsTUFBTSxDQUFDLEVBQUU7TUFDL0IsSUFBSTFILEtBQUssQ0FBQ3VILE9BQU8sQ0FBQyxDQUFDRyxNQUFNLENBQUMsSUFBSTFILEtBQUssQ0FBQ3VILE9BQU8sQ0FBQyxDQUFDRyxNQUFNLENBQUMsQ0FBQzNFLEtBQUssS0FBS21CLEtBQUssQ0FBQ25CLEtBQUssRUFBRTtRQUMxRTZELEtBQUssQ0FBQ1IsSUFBSSxDQUFDO1VBQUU5QixJQUFJLEVBQUVxQyxHQUFHO1VBQUVwQyxFQUFFLEVBQUU7WUFBRXJCLEdBQUcsRUFBRXFFLE9BQU87WUFBRXBFLEdBQUcsRUFBRXVFO1VBQU8sQ0FBQztVQUFFeEQ7UUFBTSxDQUFDLENBQUM7TUFDckU7TUFDQSxJQUNFbEUsS0FBSyxDQUFDdUgsT0FBTyxDQUFDLENBQUNHLE1BQU0sQ0FBQyxLQUFLLElBQUksSUFDL0JuSCxlQUFlLElBQ2ZBLGVBQWUsQ0FBQzJDLEdBQUcsS0FBS3FFLE9BQU8sSUFDL0JoSCxlQUFlLENBQUM0QyxHQUFHLEtBQUt1RSxNQUFNLEVBQzlCO1FBQ0FkLEtBQUssQ0FBQ1IsSUFBSSxDQUFDO1VBQUU5QixJQUFJLEVBQUVxQyxHQUFHO1VBQUVwQyxFQUFFLEVBQUU7WUFBRXJCLEdBQUcsRUFBRXFFLE9BQU87WUFBRXBFLEdBQUcsRUFBRXVFO1VBQU8sQ0FBQztVQUFFeEQsS0FBSztVQUFFeUQsU0FBUyxFQUFFO1FBQUssQ0FBQyxDQUFDO01BQ3RGO0lBQ0Y7RUFDRjtFQUNBLE9BQU9mLEtBQUs7QUFDZDs7QUFFQTtBQUNBLFNBQVNFLGlCQUFpQkEsQ0FBQzlHLEtBQUssRUFBRTJHLEdBQUcsRUFBRXpDLEtBQUssRUFBRTtFQUM1QyxJQUFJMEMsS0FBSyxHQUFHLEVBQUU7RUFDZCxJQUFJZ0IsVUFBVSxHQUFHLENBQ2YsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQ04sQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsRUFDUCxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsRUFDTixDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUNSO0VBQ0RBLFVBQVUsQ0FBQ0MsT0FBTyxDQUFFQyxDQUFDLElBQUs7SUFDeEIsSUFBSUMsQ0FBQyxHQUFHcEIsR0FBRyxDQUFDekQsR0FBRztJQUNmLElBQUk4RSxDQUFDLEdBQUdyQixHQUFHLENBQUN4RCxHQUFHO0lBQ2YsSUFBSThFLEtBQUssR0FBRyxDQUFDO0lBQ2IsT0FBTyxJQUFJLEVBQUU7TUFDWEYsQ0FBQyxJQUFJRCxDQUFDLENBQUMsQ0FBQyxDQUFDO01BQ1RFLENBQUMsSUFBSUYsQ0FBQyxDQUFDLENBQUMsQ0FBQztNQUNURyxLQUFLLEVBQUU7TUFDUCxJQUFJLENBQUNULFVBQVUsQ0FBQ08sQ0FBQyxFQUFFQyxDQUFDLENBQUMsRUFBRTtNQUN2QixJQUFJaEgsT0FBTyxDQUFDaUgsS0FBSyxDQUFDLEVBQUU7UUFDbEIsSUFBSWpJLEtBQUssQ0FBQytILENBQUMsQ0FBQyxDQUFDQyxDQUFDLENBQUMsS0FBSyxJQUFJLEVBQUU7VUFDeEJwQixLQUFLLENBQUNSLElBQUksQ0FBQztZQUFFOUIsSUFBSSxFQUFFcUMsR0FBRztZQUFFcEMsRUFBRSxFQUFFO2NBQUVyQixHQUFHLEVBQUU2RSxDQUFDO2NBQUU1RSxHQUFHLEVBQUU2RTtZQUFFLENBQUM7WUFBRTlEO1VBQU0sQ0FBQyxDQUFDO1FBQzFELENBQUMsTUFBTTtVQUNMLElBQUlsRSxLQUFLLENBQUMrSCxDQUFDLENBQUMsQ0FBQ0MsQ0FBQyxDQUFDLENBQUNqRixLQUFLLEtBQUttQixLQUFLLENBQUNuQixLQUFLLEVBQUU7WUFDckM2RCxLQUFLLENBQUNSLElBQUksQ0FBQztjQUFFOUIsSUFBSSxFQUFFcUMsR0FBRztjQUFFcEMsRUFBRSxFQUFFO2dCQUFFckIsR0FBRyxFQUFFNkUsQ0FBQztnQkFBRTVFLEdBQUcsRUFBRTZFO2NBQUUsQ0FBQztjQUFFOUQ7WUFBTSxDQUFDLENBQUM7VUFDMUQ7VUFDQTtRQUNGO01BQ0YsQ0FBQyxNQUFNO1FBQ0wsSUFBSWxFLEtBQUssQ0FBQytILENBQUMsQ0FBQyxDQUFDQyxDQUFDLENBQUMsS0FBSyxJQUFJLEVBQUU7TUFDNUI7SUFDRjtFQUNGLENBQUMsQ0FBQztFQUNGLE9BQU9wQixLQUFLO0FBQ2Q7O0FBRUE7QUFDQSxTQUFTSyx3QkFBd0JBLENBQUNqSCxLQUFLLEVBQUUyRyxHQUFHLEVBQUV6QyxLQUFLLEVBQUU7RUFDbkQsSUFBSTBDLEtBQUssR0FBRyxFQUFFO0VBQ2QsSUFBSWdCLFVBQVUsR0FBRyxDQUNmLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUNOLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQ1AsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQ04sQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FDUjtFQUNEQSxVQUFVLENBQUNDLE9BQU8sQ0FBRUMsQ0FBQyxJQUFLO0lBQ3hCLElBQUlDLENBQUMsR0FBR3BCLEdBQUcsQ0FBQ3pELEdBQUc7SUFDZixJQUFJOEUsQ0FBQyxHQUFHckIsR0FBRyxDQUFDeEQsR0FBRztJQUNmLE9BQU8sSUFBSSxFQUFFO01BQ1g0RSxDQUFDLElBQUlELENBQUMsQ0FBQyxDQUFDLENBQUM7TUFDVEUsQ0FBQyxJQUFJRixDQUFDLENBQUMsQ0FBQyxDQUFDO01BQ1QsSUFBSSxDQUFDTixVQUFVLENBQUNPLENBQUMsRUFBRUMsQ0FBQyxDQUFDLEVBQUU7TUFDdkIsSUFBSWhJLEtBQUssQ0FBQytILENBQUMsQ0FBQyxDQUFDQyxDQUFDLENBQUMsS0FBSyxJQUFJLEVBQUU7UUFDeEJwQixLQUFLLENBQUNSLElBQUksQ0FBQztVQUFFOUIsSUFBSSxFQUFFcUMsR0FBRztVQUFFcEMsRUFBRSxFQUFFO1lBQUVyQixHQUFHLEVBQUU2RSxDQUFDO1lBQUU1RSxHQUFHLEVBQUU2RTtVQUFFLENBQUM7VUFBRTlEO1FBQU0sQ0FBQyxDQUFDO01BQzFELENBQUMsTUFBTTtRQUNMMEMsS0FBSyxDQUFDUixJQUFJLENBQUM7VUFBRTlCLElBQUksRUFBRXFDLEdBQUc7VUFBRXBDLEVBQUUsRUFBRTtZQUFFckIsR0FBRyxFQUFFNkUsQ0FBQztZQUFFNUUsR0FBRyxFQUFFNkU7VUFBRSxDQUFDO1VBQUU5RDtRQUFNLENBQUMsQ0FBQztRQUN4RDtNQUNGO0lBQ0Y7RUFDRixDQUFDLENBQUM7RUFDRixPQUFPMEMsS0FBSztBQUNkO0FBRUEsU0FBU0csbUJBQW1CQSxDQUFDL0csS0FBSyxFQUFFMkcsR0FBRyxFQUFFekMsS0FBSyxFQUFFO0VBQzlDLElBQUkwQyxLQUFLLEdBQUcsRUFBRTtFQUNkLElBQUlzQixPQUFPLEdBQUcsQ0FDWixDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQ1IsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsRUFDUCxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQ1IsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsRUFDUCxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUNQLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUNOLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQ1AsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQ1A7RUFDREEsT0FBTyxDQUFDTCxPQUFPLENBQUVNLENBQUMsSUFBSztJQUNyQixJQUFJSixDQUFDLEdBQUdwQixHQUFHLENBQUN6RCxHQUFHLEdBQUdpRixDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ3RCLElBQUlILENBQUMsR0FBR3JCLEdBQUcsQ0FBQ3hELEdBQUcsR0FBR2dGLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDdEIsSUFBSVgsVUFBVSxDQUFDTyxDQUFDLEVBQUVDLENBQUMsQ0FBQyxLQUFLLENBQUNoSSxLQUFLLENBQUMrSCxDQUFDLENBQUMsQ0FBQ0MsQ0FBQyxDQUFDLElBQUloSSxLQUFLLENBQUMrSCxDQUFDLENBQUMsQ0FBQ0MsQ0FBQyxDQUFDLENBQUNqRixLQUFLLEtBQUttQixLQUFLLENBQUNuQixLQUFLLENBQUMsRUFBRTtNQUMzRTZELEtBQUssQ0FBQ1IsSUFBSSxDQUFDO1FBQUU5QixJQUFJLEVBQUVxQyxHQUFHO1FBQUVwQyxFQUFFLEVBQUU7VUFBRXJCLEdBQUcsRUFBRTZFLENBQUM7VUFBRTVFLEdBQUcsRUFBRTZFO1FBQUUsQ0FBQztRQUFFOUQ7TUFBTSxDQUFDLENBQUM7SUFDMUQ7RUFDRixDQUFDLENBQUM7RUFDRixPQUFPMEMsS0FBSztBQUNkO0FBRUEsU0FBU0ksbUJBQW1CQSxDQUFDaEgsS0FBSyxFQUFFMkcsR0FBRyxFQUFFekMsS0FBSyxFQUFFO0VBQzlDLElBQUkwQyxLQUFLLEdBQUcsRUFBRTtFQUNkLElBQUlnQixVQUFVLEdBQUcsQ0FDZixDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsRUFDTixDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUNQLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQ1AsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUNUO0VBQ0RBLFVBQVUsQ0FBQ0MsT0FBTyxDQUFFQyxDQUFDLElBQUs7SUFDeEIsS0FBSyxJQUFJRyxLQUFLLEdBQUcsQ0FBQyxFQUFFQSxLQUFLLEdBQUcsQ0FBQyxFQUFFQSxLQUFLLEVBQUUsRUFBRTtNQUN0QyxJQUFJRixDQUFDLEdBQUdwQixHQUFHLENBQUN6RCxHQUFHLEdBQUc0RSxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUdHLEtBQUs7TUFDOUIsSUFBSUQsQ0FBQyxHQUFHckIsR0FBRyxDQUFDeEQsR0FBRyxHQUFHMkUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHRyxLQUFLO01BQzlCLElBQUksQ0FBQ1QsVUFBVSxDQUFDTyxDQUFDLEVBQUVDLENBQUMsQ0FBQyxFQUFFOztNQUV2QjtNQUNBLElBQUlJLFVBQVUsR0FBR3BJLEtBQUssQ0FBQytILENBQUMsQ0FBQyxDQUFDQyxDQUFDLENBQUM7TUFDNUIsSUFBSUksVUFBVSxJQUFJQSxVQUFVLENBQUNyRixLQUFLLEtBQUttQixLQUFLLENBQUNuQixLQUFLLEVBQUU7TUFFcEQsSUFBSXNGLGlCQUFpQixHQUFHLElBQUk7TUFDNUIsSUFBSUMsaUJBQWlCLEdBQUcsQ0FBQztNQUN6QixJQUFJQyxpQkFBaUIsR0FBRyxJQUFJOztNQUU1QjtNQUNBLEtBQUssSUFBSXZHLENBQUMsR0FBRyxDQUFDLEVBQUVBLENBQUMsR0FBR2lHLEtBQUssRUFBRWpHLENBQUMsRUFBRSxFQUFFO1FBQzlCLElBQUl3RyxRQUFRLEdBQUc3QixHQUFHLENBQUN6RCxHQUFHLEdBQUc0RSxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUc5RixDQUFDO1FBQ2pDLElBQUl5RyxRQUFRLEdBQUc5QixHQUFHLENBQUN4RCxHQUFHLEdBQUcyRSxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUc5RixDQUFDO1FBQ2pDLElBQUloQyxLQUFLLENBQUN3SSxRQUFRLENBQUMsQ0FBQ0MsUUFBUSxDQUFDLEtBQUssSUFBSSxFQUFFO1VBQ3RDSixpQkFBaUIsR0FBRyxLQUFLO1VBQ3pCO1FBQ0Y7TUFDRjs7TUFFQTtNQUNBLEtBQUssSUFBSXJHLENBQUMsR0FBRyxDQUFDLEVBQUVBLENBQUMsR0FBR2lHLEtBQUssRUFBRWpHLENBQUMsRUFBRSxFQUFFO1FBQzlCLElBQUl3RyxRQUFRLEdBQUc3QixHQUFHLENBQUN6RCxHQUFHLEdBQUc0RSxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUc5RixDQUFDO1FBQ2pDLElBQUl5RyxRQUFRLEdBQUc5QixHQUFHLENBQUN4RCxHQUFHLEdBQUcyRSxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUc5RixDQUFDO1FBQ2pDLElBQUlvQixNQUFNLEdBQUdwRCxLQUFLLENBQUN3SSxRQUFRLENBQUMsQ0FBQ0MsUUFBUSxDQUFDO1FBQ3RDLElBQUlyRixNQUFNLEVBQUU7VUFDVixJQUFJQSxNQUFNLENBQUNOLElBQUksS0FBSyxNQUFNLEVBQUU7WUFDMUJ3RixpQkFBaUIsRUFBRTtZQUNuQixJQUFJQSxpQkFBaUIsR0FBRyxDQUFDLEVBQUU7Y0FDekJDLGlCQUFpQixHQUFHLEtBQUs7Y0FDekI7WUFDRjtVQUNGLENBQUMsTUFBTTtZQUNMQSxpQkFBaUIsR0FBRyxLQUFLO1lBQ3pCO1VBQ0Y7UUFDRjtNQUNGO01BQ0FBLGlCQUFpQixHQUFHQSxpQkFBaUIsSUFBSUQsaUJBQWlCLEtBQUssQ0FBQzs7TUFFaEU7TUFDQSxJQUFJRCxpQkFBaUIsSUFBSUUsaUJBQWlCLEVBQUU7UUFDMUMzQixLQUFLLENBQUNSLElBQUksQ0FBQztVQUFFOUIsSUFBSSxFQUFFcUMsR0FBRztVQUFFcEMsRUFBRSxFQUFFO1lBQUVyQixHQUFHLEVBQUU2RSxDQUFDO1lBQUU1RSxHQUFHLEVBQUU2RTtVQUFFLENBQUM7VUFBRTlEO1FBQU0sQ0FBQyxDQUFDO01BQzFEO0lBQ0Y7RUFDRixDQUFDLENBQUM7RUFDRixPQUFPMEMsS0FBSztBQUNkO0FBRUEsU0FBUzhCLGtCQUFrQkEsQ0FBQzFJLEtBQUssRUFBRTJHLEdBQUcsRUFBRXpDLEtBQUssRUFBRTtFQUM3QztFQUNBLE9BQU8rQyx3QkFBd0IsQ0FBQ2pILEtBQUssRUFBRTJHLEdBQUcsRUFBRXpDLEtBQUssQ0FBQyxDQUFDZ0QsTUFBTSxDQUN2REYsbUJBQW1CLENBQUNoSCxLQUFLLEVBQUUyRyxHQUFHLEVBQUV6QyxLQUFLLENBQ3ZDLENBQUM7QUFDSDtBQUVBLFNBQVNpRCxpQkFBaUJBLENBQUNuSCxLQUFLLEVBQUUyRyxHQUFHLEVBQUV6QyxLQUFLLEVBQUU7RUFDNUMsSUFBSTBDLEtBQUssR0FBRyxFQUFFO0VBQ2QsS0FBSyxJQUFJbUIsQ0FBQyxHQUFHcEIsR0FBRyxDQUFDekQsR0FBRyxHQUFHLENBQUMsRUFBRTZFLENBQUMsSUFBSXBCLEdBQUcsQ0FBQ3pELEdBQUcsR0FBRyxDQUFDLEVBQUU2RSxDQUFDLEVBQUUsRUFBRTtJQUMvQyxLQUFLLElBQUlDLENBQUMsR0FBR3JCLEdBQUcsQ0FBQ3hELEdBQUcsR0FBRyxDQUFDLEVBQUU2RSxDQUFDLElBQUlyQixHQUFHLENBQUN4RCxHQUFHLEdBQUcsQ0FBQyxFQUFFNkUsQ0FBQyxFQUFFLEVBQUU7TUFDL0MsSUFBSUQsQ0FBQyxLQUFLcEIsR0FBRyxDQUFDekQsR0FBRyxJQUFJOEUsQ0FBQyxLQUFLckIsR0FBRyxDQUFDeEQsR0FBRyxFQUFFO01BQ3BDLElBQUlxRSxVQUFVLENBQUNPLENBQUMsRUFBRUMsQ0FBQyxDQUFDLEtBQUssQ0FBQ2hJLEtBQUssQ0FBQytILENBQUMsQ0FBQyxDQUFDQyxDQUFDLENBQUMsSUFBSWhJLEtBQUssQ0FBQytILENBQUMsQ0FBQyxDQUFDQyxDQUFDLENBQUMsQ0FBQ2pGLEtBQUssS0FBS21CLEtBQUssQ0FBQ25CLEtBQUssQ0FBQyxFQUFFO1FBQzNFNkQsS0FBSyxDQUFDUixJQUFJLENBQUM7VUFBRTlCLElBQUksRUFBRXFDLEdBQUc7VUFBRXBDLEVBQUUsRUFBRTtZQUFFckIsR0FBRyxFQUFFNkUsQ0FBQztZQUFFNUUsR0FBRyxFQUFFNkU7VUFBRSxDQUFDO1VBQUU5RDtRQUFNLENBQUMsQ0FBQztNQUMxRDtJQUNGO0VBQ0Y7RUFDQSxPQUFPMEMsS0FBSztBQUNkO0FBRUEsU0FBU1EscUJBQXFCQSxDQUFDcEgsS0FBSyxFQUFFMkcsR0FBRyxFQUFFZ0MsSUFBSSxFQUFFO0VBQy9DLElBQUkvQixLQUFLLEdBQUcsRUFBRTtFQUNkLElBQUkrQixJQUFJLENBQUMzRixRQUFRLEVBQUUsT0FBTzRELEtBQUs7RUFDL0IsSUFBSWdDLFNBQVMsQ0FBQzVJLEtBQUssRUFBRTJJLElBQUksRUFBRTtJQUFFRSxJQUFJLEVBQUUsVUFBVTtJQUFFbEM7RUFBSSxDQUFDLENBQUMsRUFBRTtJQUNyREMsS0FBSyxDQUFDUixJQUFJLENBQUM7TUFDVDlCLElBQUksRUFBRXFDLEdBQUc7TUFDVHBDLEVBQUUsRUFBRTtRQUFFckIsR0FBRyxFQUFFeUQsR0FBRyxDQUFDekQsR0FBRztRQUFFQyxHQUFHLEVBQUV3RCxHQUFHLENBQUN4RCxHQUFHLEdBQUc7TUFBRSxDQUFDO01BQ3RDZSxLQUFLLEVBQUV5RSxJQUFJO01BQ1hqRCxNQUFNLEVBQUU7SUFDVixDQUFDLENBQUM7RUFDSjtFQUNBLElBQUlrRCxTQUFTLENBQUM1SSxLQUFLLEVBQUUySSxJQUFJLEVBQUU7SUFBRUUsSUFBSSxFQUFFLFdBQVc7SUFBRWxDO0VBQUksQ0FBQyxDQUFDLEVBQUU7SUFDdERDLEtBQUssQ0FBQ1IsSUFBSSxDQUFDO01BQ1Q5QixJQUFJLEVBQUVxQyxHQUFHO01BQ1RwQyxFQUFFLEVBQUU7UUFBRXJCLEdBQUcsRUFBRXlELEdBQUcsQ0FBQ3pELEdBQUc7UUFBRUMsR0FBRyxFQUFFd0QsR0FBRyxDQUFDeEQsR0FBRyxHQUFHO01BQUUsQ0FBQztNQUN0Q2UsS0FBSyxFQUFFeUUsSUFBSTtNQUNYakQsTUFBTSxFQUFFO0lBQ1YsQ0FBQyxDQUFDO0VBQ0o7RUFDQSxPQUFPa0IsS0FBSztBQUNkOztBQUVBO0FBQ0EsU0FBU2dDLFNBQVNBLENBQUM1SSxLQUFLLEVBQUUySSxJQUFJLEVBQUU7RUFBRUUsSUFBSTtFQUFFbEM7QUFBSSxDQUFDLEVBQUU7RUFDN0MsSUFBSXpELEdBQUcsR0FBR3lELEdBQUcsQ0FBQ3pELEdBQUc7RUFDakIsSUFBSXlGLElBQUksQ0FBQzNGLFFBQVEsRUFBRSxPQUFPLEtBQUs7RUFDL0IsSUFBSTZGLElBQUksS0FBSyxVQUFVLEVBQUU7SUFDdkIsSUFBSUMsSUFBSSxHQUFHOUksS0FBSyxDQUFDa0QsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ3hCLElBQUksQ0FBQzRGLElBQUksSUFBSUEsSUFBSSxDQUFDaEcsSUFBSSxLQUFLLE1BQU0sSUFBSWdHLElBQUksQ0FBQzlGLFFBQVEsRUFBRSxPQUFPLEtBQUs7SUFDaEUsSUFBSWhELEtBQUssQ0FBQ2tELEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLElBQUksSUFBSWxELEtBQUssQ0FBQ2tELEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLElBQUksRUFBRSxPQUFPLEtBQUs7SUFDbEUsSUFDRSxDQUFDNkYsbUJBQW1CLENBQUMvSSxLQUFLLEVBQUU7TUFBRWtELEdBQUc7TUFBRUMsR0FBRyxFQUFFO0lBQUUsQ0FBQyxFQUFFd0YsSUFBSSxDQUFDNUYsS0FBSyxDQUFDLElBQ3hELENBQUNnRyxtQkFBbUIsQ0FBQy9JLEtBQUssRUFBRTtNQUFFa0QsR0FBRztNQUFFQyxHQUFHLEVBQUU7SUFBRSxDQUFDLEVBQUV3RixJQUFJLENBQUM1RixLQUFLLENBQUMsSUFDeEQsQ0FBQ2dHLG1CQUFtQixDQUFDL0ksS0FBSyxFQUFFO01BQUVrRCxHQUFHO01BQUVDLEdBQUcsRUFBRTtJQUFFLENBQUMsRUFBRXdGLElBQUksQ0FBQzVGLEtBQUssQ0FBQyxFQUV4RCxPQUFPLEtBQUs7SUFDZCxPQUFPLElBQUk7RUFDYixDQUFDLE1BQU0sSUFBSThGLElBQUksS0FBSyxXQUFXLEVBQUU7SUFDL0IsSUFBSUMsSUFBSSxHQUFHOUksS0FBSyxDQUFDa0QsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ3hCLElBQUksQ0FBQzRGLElBQUksSUFBSUEsSUFBSSxDQUFDaEcsSUFBSSxLQUFLLE1BQU0sSUFBSWdHLElBQUksQ0FBQzlGLFFBQVEsRUFBRSxPQUFPLEtBQUs7SUFDaEUsSUFBSWhELEtBQUssQ0FBQ2tELEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLElBQUksSUFBSWxELEtBQUssQ0FBQ2tELEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLElBQUksSUFBSWxELEtBQUssQ0FBQ2tELEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLElBQUksRUFDNUUsT0FBTyxLQUFLO0lBQ2QsSUFDRSxDQUFDNkYsbUJBQW1CLENBQUMvSSxLQUFLLEVBQUU7TUFBRWtELEdBQUc7TUFBRUMsR0FBRyxFQUFFO0lBQUUsQ0FBQyxFQUFFd0YsSUFBSSxDQUFDNUYsS0FBSyxDQUFDLElBQ3hELENBQUNnRyxtQkFBbUIsQ0FBQy9JLEtBQUssRUFBRTtNQUFFa0QsR0FBRztNQUFFQyxHQUFHLEVBQUU7SUFBRSxDQUFDLEVBQUV3RixJQUFJLENBQUM1RixLQUFLLENBQUMsSUFDeEQsQ0FBQ2dHLG1CQUFtQixDQUFDL0ksS0FBSyxFQUFFO01BQUVrRCxHQUFHO01BQUVDLEdBQUcsRUFBRTtJQUFFLENBQUMsRUFBRXdGLElBQUksQ0FBQzVGLEtBQUssQ0FBQyxFQUV4RCxPQUFPLEtBQUs7SUFDZCxPQUFPLElBQUk7RUFDYjtFQUNBLE9BQU8sS0FBSztBQUNkO0FBRUEsU0FBU2dHLG1CQUFtQkEsQ0FBQy9JLEtBQUssRUFBRTJHLEdBQUcsRUFBRTVELEtBQUssRUFBRTtFQUM5QyxJQUFJaUcsU0FBUyxHQUFHQyxVQUFVLENBQUNqSixLQUFLLENBQUM7RUFDakNnSixTQUFTLENBQUNyQyxHQUFHLENBQUN6RCxHQUFHLENBQUMsQ0FBQ3lELEdBQUcsQ0FBQ3hELEdBQUcsQ0FBQyxHQUFHO0lBQUVMLElBQUksRUFBRSxNQUFNO0lBQUVDLEtBQUs7SUFBRUMsUUFBUSxFQUFFO0VBQUssQ0FBQztFQUNyRSxPQUFPa0csVUFBVSxDQUFDRixTQUFTLEVBQUVqRyxLQUFLLENBQUM7QUFDckM7O0FBRUE7QUFDQSxTQUFTeUUsVUFBVUEsQ0FBQ3RFLEdBQUcsRUFBRUMsR0FBRyxFQUFFO0VBQzVCLE9BQU9ELEdBQUcsSUFBSSxDQUFDLElBQUlBLEdBQUcsR0FBRyxDQUFDLElBQUlDLEdBQUcsSUFBSSxDQUFDLElBQUlBLEdBQUcsR0FBRyxDQUFDO0FBQ25EO0FBRUEsU0FBUzhGLFVBQVVBLENBQUNqSixLQUFLLEVBQUU7RUFDekIsT0FBT0EsS0FBSyxDQUFDMEMsR0FBRyxDQUFFUSxHQUFHLElBQUtBLEdBQUcsQ0FBQ1IsR0FBRyxDQUFFeUcsSUFBSSxJQUFNQSxJQUFJLEdBQUc7SUFBRSxHQUFHQTtFQUFLLENBQUMsR0FBRyxJQUFLLENBQUMsQ0FBQztBQUMzRTtBQUVBLFNBQVNELFVBQVVBLENBQUNsSixLQUFLLEVBQUUrQyxLQUFLLEVBQUU7RUFDaEMsSUFBSXFHLE9BQU8sR0FBR0MsUUFBUSxDQUFDckosS0FBSyxFQUFFK0MsS0FBSyxDQUFDO0VBQ3BDLElBQUksQ0FBQ3FHLE9BQU8sRUFBRSxPQUFPLEtBQUs7RUFDMUIsT0FBTyxDQUFDM0YsZ0JBQWdCLENBQUN6RCxLQUFLLEVBQUVvSixPQUFPLEVBQUUxRixXQUFXLENBQUNYLEtBQUssQ0FBQyxDQUFDO0FBQzlEO0FBRUEsU0FBU3NHLFFBQVFBLENBQUNySixLQUFLLEVBQUUrQyxLQUFLLEVBQUU7RUFDOUIsS0FBSyxJQUFJZ0YsQ0FBQyxHQUFHLENBQUMsRUFBRUEsQ0FBQyxHQUFHLENBQUMsRUFBRUEsQ0FBQyxFQUFFLEVBQUU7SUFDMUIsS0FBSyxJQUFJQyxDQUFDLEdBQUcsQ0FBQyxFQUFFQSxDQUFDLEdBQUcsQ0FBQyxFQUFFQSxDQUFDLEVBQUUsRUFBRTtNQUMxQixJQUFJOUQsS0FBSyxHQUFHbEUsS0FBSyxDQUFDK0gsQ0FBQyxDQUFDLENBQUNDLENBQUMsQ0FBQztNQUN2QixJQUFJOUQsS0FBSyxJQUFJQSxLQUFLLENBQUNwQixJQUFJLEtBQUssTUFBTSxJQUFJb0IsS0FBSyxDQUFDbkIsS0FBSyxLQUFLQSxLQUFLLEVBQUU7UUFDM0QsT0FBTztVQUFFRyxHQUFHLEVBQUU2RSxDQUFDO1VBQUU1RSxHQUFHLEVBQUU2RTtRQUFFLENBQUM7TUFDM0I7SUFDRjtFQUNGO0VBQ0EsT0FBTyxJQUFJO0FBQ2I7QUFFQSxTQUFTdkUsZ0JBQWdCQSxDQUFDekQsS0FBSyxFQUFFMkcsR0FBRyxFQUFFMkMsYUFBYSxFQUFFO0VBQ25ELEtBQUssSUFBSXZCLENBQUMsR0FBRyxDQUFDLEVBQUVBLENBQUMsR0FBRyxDQUFDLEVBQUVBLENBQUMsRUFBRSxFQUFFO0lBQzFCLEtBQUssSUFBSUMsQ0FBQyxHQUFHLENBQUMsRUFBRUEsQ0FBQyxHQUFHLENBQUMsRUFBRUEsQ0FBQyxFQUFFLEVBQUU7TUFDMUIsSUFBSTlELEtBQUssR0FBR2xFLEtBQUssQ0FBQytILENBQUMsQ0FBQyxDQUFDQyxDQUFDLENBQUM7TUFDdkIsSUFBSTlELEtBQUssSUFBSUEsS0FBSyxDQUFDbkIsS0FBSyxLQUFLdUcsYUFBYSxFQUFFO1FBQzFDLElBQUkxQyxLQUFLO1FBQ1QsSUFBSTFDLEtBQUssQ0FBQ3BCLElBQUksS0FBSyxNQUFNLEVBQUU7VUFDekI7VUFDQThELEtBQUssR0FBR0ssd0JBQXdCLENBQUNqSCxLQUFLLEVBQUU7WUFBRWtELEdBQUcsRUFBRTZFLENBQUM7WUFBRTVFLEdBQUcsRUFBRTZFO1VBQUUsQ0FBQyxFQUFFOUQsS0FBSyxDQUFDO1FBQ3BFLENBQUMsTUFBTTtVQUNMMEMsS0FBSyxHQUFHRixxQkFBcUIsQ0FBQzFHLEtBQUssRUFBRTtZQUFFa0QsR0FBRyxFQUFFNkUsQ0FBQztZQUFFNUUsR0FBRyxFQUFFNkU7VUFBRSxDQUFDLENBQUM7UUFDMUQ7UUFDQSxLQUFLLElBQUkzRCxJQUFJLElBQUl1QyxLQUFLLEVBQUU7VUFDdEIsSUFBSXZDLElBQUksQ0FBQ0UsRUFBRSxDQUFDckIsR0FBRyxLQUFLeUQsR0FBRyxDQUFDekQsR0FBRyxJQUFJbUIsSUFBSSxDQUFDRSxFQUFFLENBQUNwQixHQUFHLEtBQUt3RCxHQUFHLENBQUN4RCxHQUFHLEVBQUUsT0FBTyxJQUFJO1FBQ3JFO01BQ0Y7SUFDRjtFQUNGO0VBQ0EsT0FBTyxLQUFLO0FBQ2Q7QUFFQSxTQUFTTyxXQUFXQSxDQUFDWCxLQUFLLEVBQUU7RUFDMUIsT0FBT0EsS0FBSyxLQUFLLE9BQU8sR0FBRyxPQUFPLEdBQUcsT0FBTztBQUM5Qzs7QUFFQTtBQUNBLFNBQVNvRCxvQkFBb0JBLENBQUM5QixJQUFJLEVBQUU7RUFDbEMsSUFDRUEsSUFBSSxDQUFDSCxLQUFLLENBQUNwQixJQUFJLEtBQUssTUFBTSxJQUMxQjNCLElBQUksQ0FBQ3NFLEdBQUcsQ0FBQ3BCLElBQUksQ0FBQ0MsSUFBSSxDQUFDcEIsR0FBRyxHQUFHbUIsSUFBSSxDQUFDRSxFQUFFLENBQUNyQixHQUFHLENBQUMsS0FBSyxDQUFDLEVBQzNDO0lBQ0EzQyxlQUFlLEdBQUc7TUFDaEIyQyxHQUFHLEVBQUUsQ0FBQ21CLElBQUksQ0FBQ0MsSUFBSSxDQUFDcEIsR0FBRyxHQUFHbUIsSUFBSSxDQUFDRSxFQUFFLENBQUNyQixHQUFHLElBQUksQ0FBQztNQUN0Q0MsR0FBRyxFQUFFa0IsSUFBSSxDQUFDQyxJQUFJLENBQUNuQjtJQUNqQixDQUFDO0VBQ0gsQ0FBQyxNQUFNO0lBQ0w1QyxlQUFlLEdBQUcsSUFBSTtFQUN4QjtBQUNGO0FBRUEsU0FBU3dGLGVBQWVBLENBQUMxQixJQUFJLEVBQUU7RUFDN0IsT0FDRUEsSUFBSSxDQUFDSCxLQUFLLENBQUNwQixJQUFJLEtBQUssTUFBTSxJQUMxQnVCLElBQUksQ0FBQ0MsSUFBSSxDQUFDbkIsR0FBRyxLQUFLa0IsSUFBSSxDQUFDRSxFQUFFLENBQUNwQixHQUFHLElBQzdCbkQsS0FBSyxDQUFDcUUsSUFBSSxDQUFDRSxFQUFFLENBQUNyQixHQUFHLENBQUMsQ0FBQ21CLElBQUksQ0FBQ0UsRUFBRSxDQUFDcEIsR0FBRyxDQUFDLEtBQUssSUFBSTtBQUU1QztBQUVBLFNBQVM2QyxnQkFBZ0JBLENBQUMzQixJQUFJLEVBQUU7RUFDOUJyRSxLQUFLLENBQUNxRSxJQUFJLENBQUNFLEVBQUUsQ0FBQ3JCLEdBQUcsQ0FBQyxDQUFDbUIsSUFBSSxDQUFDRSxFQUFFLENBQUNwQixHQUFHLENBQUMsR0FBR2tCLElBQUksQ0FBQ0gsS0FBSztFQUM1Q2xFLEtBQUssQ0FBQ3FFLElBQUksQ0FBQ0MsSUFBSSxDQUFDcEIsR0FBRyxDQUFDLENBQUNtQixJQUFJLENBQUNDLElBQUksQ0FBQ25CLEdBQUcsQ0FBQyxHQUFHLElBQUk7RUFDMUMsSUFBSW9HLFVBQVUsR0FBR2xGLElBQUksQ0FBQ0gsS0FBSyxDQUFDbkIsS0FBSyxLQUFLLE9BQU8sR0FBR3NCLElBQUksQ0FBQ0UsRUFBRSxDQUFDckIsR0FBRyxHQUFHLENBQUMsR0FBR21CLElBQUksQ0FBQ0UsRUFBRSxDQUFDckIsR0FBRyxHQUFHLENBQUM7RUFDakZsRCxLQUFLLENBQUN1SixVQUFVLENBQUMsQ0FBQ2xGLElBQUksQ0FBQ0UsRUFBRSxDQUFDcEIsR0FBRyxDQUFDLEdBQUcsSUFBSTtBQUN2Qzs7QUFFQTtBQUNBLFNBQVMwQyxjQUFjQSxDQUFDeEIsSUFBSSxFQUFFO0VBQzVCLE9BQ0VBLElBQUksQ0FBQ0gsS0FBSyxDQUFDcEIsSUFBSSxLQUFLLE1BQU0sSUFBSTNCLElBQUksQ0FBQ3NFLEdBQUcsQ0FBQ3BCLElBQUksQ0FBQ0UsRUFBRSxDQUFDcEIsR0FBRyxHQUFHa0IsSUFBSSxDQUFDQyxJQUFJLENBQUNuQixHQUFHLENBQUMsS0FBSyxDQUFDO0FBRTdFO0FBRUEsU0FBUzJDLGFBQWFBLENBQUN6QixJQUFJLEVBQUU7RUFDM0IsSUFBSW5CLEdBQUcsR0FBR21CLElBQUksQ0FBQ0MsSUFBSSxDQUFDcEIsR0FBRztFQUN2QixJQUFJbUIsSUFBSSxDQUFDcUIsTUFBTSxLQUFLLFVBQVUsRUFBRTtJQUM5QjFGLEtBQUssQ0FBQ2tELEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHbUIsSUFBSSxDQUFDSCxLQUFLO0lBQzFCbEUsS0FBSyxDQUFDa0QsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsSUFBSTtJQUNwQixJQUFJNEYsSUFBSSxHQUFHOUksS0FBSyxDQUFDa0QsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ3hCbEQsS0FBSyxDQUFDa0QsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUc0RixJQUFJO0lBQ3BCOUksS0FBSyxDQUFDa0QsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsSUFBSTtJQUNwQjRGLElBQUksQ0FBQzlGLFFBQVEsR0FBRyxJQUFJO0VBQ3RCLENBQUMsTUFBTSxJQUFJcUIsSUFBSSxDQUFDcUIsTUFBTSxLQUFLLFdBQVcsRUFBRTtJQUN0QzFGLEtBQUssQ0FBQ2tELEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHbUIsSUFBSSxDQUFDSCxLQUFLO0lBQzFCbEUsS0FBSyxDQUFDa0QsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsSUFBSTtJQUNwQixJQUFJNEYsSUFBSSxHQUFHOUksS0FBSyxDQUFDa0QsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ3hCbEQsS0FBSyxDQUFDa0QsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUc0RixJQUFJO0lBQ3BCOUksS0FBSyxDQUFDa0QsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsSUFBSTtJQUNwQjRGLElBQUksQ0FBQzlGLFFBQVEsR0FBRyxJQUFJO0VBQ3RCO0FBQ0Y7O0FBRUE7QUFDQSxTQUFTaUQsVUFBVUEsQ0FBQ1UsR0FBRyxFQUFFNUQsS0FBSyxFQUFFO0VBQzlCLE9BQVFBLEtBQUssS0FBSyxPQUFPLElBQUk0RCxHQUFHLENBQUN6RCxHQUFHLEtBQUssQ0FBQyxJQUFNSCxLQUFLLEtBQUssT0FBTyxJQUFJNEQsR0FBRyxDQUFDekQsR0FBRyxLQUFLLENBQUU7QUFDckY7QUFFQSxTQUFTZ0Qsa0JBQWtCQSxDQUFDN0IsSUFBSSxFQUFFO0VBQ2hDOUUsY0FBYyxDQUFDOEMsS0FBSyxDQUFDQyxPQUFPLEdBQUcsT0FBTztFQUN0Qy9DLGNBQWMsQ0FBQ2lFLE9BQU8sQ0FBQ2dHLE9BQU8sR0FBR25GLElBQUksQ0FBQ0MsSUFBSSxDQUFDcEIsR0FBRztFQUM5QzNELGNBQWMsQ0FBQ2lFLE9BQU8sQ0FBQ2lHLE9BQU8sR0FBR3BGLElBQUksQ0FBQ0MsSUFBSSxDQUFDbkIsR0FBRztFQUM5QzVELGNBQWMsQ0FBQ2lFLE9BQU8sQ0FBQ2tHLEtBQUssR0FBR3JGLElBQUksQ0FBQ0UsRUFBRSxDQUFDckIsR0FBRztFQUMxQzNELGNBQWMsQ0FBQ2lFLE9BQU8sQ0FBQ21HLEtBQUssR0FBR3RGLElBQUksQ0FBQ0UsRUFBRSxDQUFDcEIsR0FBRztFQUMxQzVELGNBQWMsQ0FBQ2lFLE9BQU8sQ0FBQ1QsS0FBSyxHQUFHc0IsSUFBSSxDQUFDSCxLQUFLLENBQUNuQixLQUFLO0VBQy9DeEQsY0FBYyxDQUFDaUUsT0FBTyxDQUFDb0csU0FBUyxHQUFHdkYsSUFBSSxDQUFDSCxLQUFLLENBQUNwQixJQUFJO0FBQ3BEO0FBRUF0RCxnQkFBZ0IsQ0FBQ3FJLE9BQU8sQ0FBRWdDLE1BQU0sSUFBSztFQUNuQ0EsTUFBTSxDQUFDNUgsZ0JBQWdCLENBQUMsT0FBTyxFQUFFLFlBQVk7SUFDM0MsSUFBSTZILFlBQVksR0FBRyxJQUFJLENBQUN0RyxPQUFPLENBQUNWLElBQUk7SUFDcEMsSUFBSXVCLElBQUksR0FBRztNQUNUQyxJQUFJLEVBQUU7UUFDSnBCLEdBQUcsRUFBRWYsUUFBUSxDQUFDNUMsY0FBYyxDQUFDaUUsT0FBTyxDQUFDZ0csT0FBTyxDQUFDO1FBQzdDckcsR0FBRyxFQUFFaEIsUUFBUSxDQUFDNUMsY0FBYyxDQUFDaUUsT0FBTyxDQUFDaUcsT0FBTztNQUM5QyxDQUFDO01BQ0RsRixFQUFFLEVBQUU7UUFDRnJCLEdBQUcsRUFBRWYsUUFBUSxDQUFDNUMsY0FBYyxDQUFDaUUsT0FBTyxDQUFDa0csS0FBSyxDQUFDO1FBQzNDdkcsR0FBRyxFQUFFaEIsUUFBUSxDQUFDNUMsY0FBYyxDQUFDaUUsT0FBTyxDQUFDbUcsS0FBSztNQUM1QyxDQUFDO01BQ0R6RixLQUFLLEVBQUU7UUFDTHBCLElBQUksRUFBRXZELGNBQWMsQ0FBQ2lFLE9BQU8sQ0FBQ29HLFNBQVM7UUFDdEM3RyxLQUFLLEVBQUV4RCxjQUFjLENBQUNpRSxPQUFPLENBQUNUO01BQ2hDO0lBQ0YsQ0FBQztJQUNEL0MsS0FBSyxDQUFDcUUsSUFBSSxDQUFDRSxFQUFFLENBQUNyQixHQUFHLENBQUMsQ0FBQ21CLElBQUksQ0FBQ0UsRUFBRSxDQUFDcEIsR0FBRyxDQUFDLEdBQUdSLFdBQVcsQ0FBQ21ILFlBQVksRUFBRXpGLElBQUksQ0FBQ0gsS0FBSyxDQUFDbkIsS0FBSyxDQUFDO0lBQzdFL0MsS0FBSyxDQUFDcUUsSUFBSSxDQUFDQyxJQUFJLENBQUNwQixHQUFHLENBQUMsQ0FBQ21CLElBQUksQ0FBQ0MsSUFBSSxDQUFDbkIsR0FBRyxDQUFDLEdBQUcsSUFBSTtJQUMxQzVELGNBQWMsQ0FBQzhDLEtBQUssQ0FBQ0MsT0FBTyxHQUFHLE1BQU07SUFDckN0QyxLQUFLLENBQUNxRSxJQUFJLENBQUNFLEVBQUUsQ0FBQ3JCLEdBQUcsQ0FBQyxDQUFDbUIsSUFBSSxDQUFDRSxFQUFFLENBQUNwQixHQUFHLENBQUMsQ0FBQ0gsUUFBUSxHQUFHLElBQUk7SUFDL0M1QyxXQUFXLENBQUNnRyxJQUFJLENBQUMvQixJQUFJLENBQUM7SUFDdEJnQyxzQkFBc0IsQ0FBQ2hDLElBQUksQ0FBQztJQUM1QnhCLGtCQUFrQixDQUFDLENBQUM7SUFDcEIsSUFBSXlELGlCQUFpQixDQUFDdEcsS0FBSyxFQUFFMEQsV0FBVyxDQUFDekQsYUFBYSxDQUFDLENBQUMsRUFBRTtNQUN4RHVCLEtBQUssQ0FBQyxhQUFhLEdBQUdrQyxXQUFXLENBQUN6RCxhQUFhLENBQUMsR0FBRyxRQUFRLENBQUM7TUFDNURxQixhQUFhLENBQUNaLGFBQWEsQ0FBQztNQUM1QmUsU0FBUyxDQUFDLENBQUM7TUFDWDtJQUNGLENBQUMsTUFBTSxJQUFJOEUsaUJBQWlCLENBQUN2RyxLQUFLLEVBQUUwRCxXQUFXLENBQUN6RCxhQUFhLENBQUMsQ0FBQyxFQUFFO01BQy9EdUIsS0FBSyxDQUFDLFlBQVksQ0FBQztNQUNuQkYsYUFBYSxDQUFDWixhQUFhLENBQUM7TUFDNUJlLFNBQVMsQ0FBQyxDQUFDO01BQ1g7SUFDRjtJQUNBeEIsYUFBYSxHQUFHeUQsV0FBVyxDQUFDekQsYUFBYSxDQUFDO0lBQzFDb0IsVUFBVSxDQUFDLENBQUM7SUFDWm5CLGFBQWEsR0FBRyxJQUFJO0lBQ3BCQyxXQUFXLEdBQUcsSUFBSTtJQUNsQnlDLFNBQVMsQ0FBQyxDQUFDO0VBQ2IsQ0FBQyxDQUFDO0FBQ0osQ0FBQyxDQUFDOztBQUVGO0FBQ0EsU0FBU21ILGNBQWNBLENBQUMvSixLQUFLLEVBQUU7RUFDN0IsT0FBT0EsS0FBSyxDQUNUMEMsR0FBRyxDQUFFUSxHQUFHLElBQ1BBLEdBQUcsQ0FBQ1IsR0FBRyxDQUFFeUcsSUFBSSxJQUFNQSxJQUFJLEdBQUdBLElBQUksQ0FBQ3JHLElBQUksQ0FBQyxDQUFDLENBQUMsR0FBR3FHLElBQUksQ0FBQ3BHLEtBQUssQ0FBQyxDQUFDLENBQUMsR0FBRyxJQUFLLENBQUMsQ0FBQ2lILElBQUksQ0FBQyxFQUFFLENBQ3pFLENBQUMsQ0FDQUEsSUFBSSxDQUFDLEdBQUcsQ0FBQztBQUNkO0FBRUEsU0FBU25ILGtCQUFrQkEsQ0FBQSxFQUFHO0VBQzVCeEMsWUFBWSxDQUFDK0YsSUFBSSxDQUFDMkQsY0FBYyxDQUFDL0osS0FBSyxDQUFDLENBQUM7QUFDMUM7QUFFQSxTQUFTd0cscUJBQXFCQSxDQUFBLEVBQUc7RUFDL0IsSUFBSXlELE1BQU0sR0FBRyxDQUFDLENBQUM7RUFDZjVKLFlBQVksQ0FBQ3dILE9BQU8sQ0FBRXFDLEtBQUssSUFBSztJQUM5QkQsTUFBTSxDQUFDQyxLQUFLLENBQUMsR0FBRyxDQUFDRCxNQUFNLENBQUNDLEtBQUssQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDO0VBQzFDLENBQUMsQ0FBQztFQUNGLE9BQU9DLE1BQU0sQ0FBQ0MsTUFBTSxDQUFDSCxNQUFNLENBQUMsQ0FBQ0ksSUFBSSxDQUFFQyxLQUFLLElBQUtBLEtBQUssSUFBSSxDQUFDLENBQUM7QUFDMUQ7QUFFQSxTQUFTakUsc0JBQXNCQSxDQUFDaEMsSUFBSSxFQUFFO0VBQ3BDLElBQUlBLElBQUksQ0FBQ0gsS0FBSyxDQUFDcEIsSUFBSSxLQUFLLE1BQU0sSUFBSTlDLEtBQUssQ0FBQ3FFLElBQUksQ0FBQ0UsRUFBRSxDQUFDckIsR0FBRyxDQUFDLENBQUNtQixJQUFJLENBQUNFLEVBQUUsQ0FBQ3BCLEdBQUcsQ0FBQyxLQUFLLElBQUksRUFBRTtJQUMxRTdDLGdCQUFnQixHQUFHLENBQUM7RUFDdEIsQ0FBQyxNQUFNO0lBQ0xBLGdCQUFnQixFQUFFO0VBQ3BCO0FBQ0Y7QUFFQSxTQUFTbUcsZUFBZUEsQ0FBQSxFQUFHO0VBQ3pCLE9BQU9uRyxnQkFBZ0IsSUFBSSxFQUFFO0FBQy9COztBQUVBO0FBQ0E7QUFDQSxTQUFTZ0csaUJBQWlCQSxDQUFDdEcsS0FBSyxFQUFFK0MsS0FBSyxFQUFFO0VBQ3ZDLElBQUksQ0FBQ21HLFVBQVUsQ0FBQ2xKLEtBQUssRUFBRStDLEtBQUssQ0FBQyxFQUFFO0lBQzdCLElBQUk2RCxLQUFLLEdBQUcyRCxnQkFBZ0IsQ0FBQ3ZLLEtBQUssRUFBRStDLEtBQUssQ0FBQztJQUMxQyxJQUFJeUgsVUFBVSxHQUFHNUQsS0FBSyxDQUFDNkQsTUFBTSxDQUFFM0ksQ0FBQyxJQUFLMEMsV0FBVyxDQUFDeEUsS0FBSyxFQUFFOEIsQ0FBQyxFQUFFaUIsS0FBSyxDQUFDLENBQUM7SUFDbEUsSUFBSXlILFVBQVUsQ0FBQ0UsTUFBTSxLQUFLLENBQUMsRUFBRTtNQUMzQmhHLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLHdCQUF3QixFQUFFNUIsS0FBSyxDQUFDO01BQzVDLE9BQU8sSUFBSTtJQUNiO0VBQ0Y7RUFDQSxPQUFPLEtBQUs7QUFDZDtBQUVBLFNBQVN3RCxpQkFBaUJBLENBQUN2RyxLQUFLLEVBQUUrQyxLQUFLLEVBQUU7RUFDdkMsSUFBSW1HLFVBQVUsQ0FBQ2xKLEtBQUssRUFBRStDLEtBQUssQ0FBQyxFQUFFO0lBQzVCLElBQUk2RCxLQUFLLEdBQUcyRCxnQkFBZ0IsQ0FBQ3ZLLEtBQUssRUFBRStDLEtBQUssQ0FBQztJQUMxQyxJQUFJeUgsVUFBVSxHQUFHNUQsS0FBSyxDQUFDNkQsTUFBTSxDQUFFM0ksQ0FBQyxJQUFLMEMsV0FBVyxDQUFDeEUsS0FBSyxFQUFFOEIsQ0FBQyxFQUFFaUIsS0FBSyxDQUFDLENBQUM7SUFDbEUsSUFBSXlILFVBQVUsQ0FBQ0UsTUFBTSxLQUFLLENBQUMsRUFBRSxPQUFPLElBQUk7RUFDMUM7RUFDQSxPQUFPLEtBQUs7QUFDZDtBQUVBLFNBQVNILGdCQUFnQkEsQ0FBQ3ZLLEtBQUssRUFBRStDLEtBQUssRUFBRTtFQUN0QyxJQUFJNkQsS0FBSyxHQUFHLEVBQUU7RUFDZCxLQUFLLElBQUltQixDQUFDLEdBQUcsQ0FBQyxFQUFFQSxDQUFDLEdBQUcsQ0FBQyxFQUFFQSxDQUFDLEVBQUUsRUFBRTtJQUMxQixLQUFLLElBQUlDLENBQUMsR0FBRyxDQUFDLEVBQUVBLENBQUMsR0FBRyxDQUFDLEVBQUVBLENBQUMsRUFBRSxFQUFFO01BQzFCLElBQUk5RCxLQUFLLEdBQUdsRSxLQUFLLENBQUMrSCxDQUFDLENBQUMsQ0FBQ0MsQ0FBQyxDQUFDO01BQ3ZCLElBQUk5RCxLQUFLLElBQUlBLEtBQUssQ0FBQ25CLEtBQUssS0FBS0EsS0FBSyxFQUFFO1FBQ2xDNkQsS0FBSyxHQUFHQSxLQUFLLENBQUNNLE1BQU0sQ0FBQ1IscUJBQXFCLENBQUMxRyxLQUFLLEVBQUU7VUFBRWtELEdBQUcsRUFBRTZFLENBQUM7VUFBRTVFLEdBQUcsRUFBRTZFO1FBQUUsQ0FBQyxDQUFDLENBQUM7TUFDeEU7SUFDRjtFQUNGO0VBQ0EsT0FBT3BCLEtBQUs7QUFDZDs7QUFFQTtBQUNBLFNBQVNwQyxXQUFXQSxDQUFDeEUsS0FBSyxFQUFFcUUsSUFBSSxFQUFFdEIsS0FBSyxFQUFFO0VBQ3ZDLElBQUk2RCxLQUFLLEdBQUdGLHFCQUFxQixDQUFDMUcsS0FBSyxFQUFFcUUsSUFBSSxDQUFDQyxJQUFJLENBQUM7RUFDbkQsSUFBSXFHLEtBQUssR0FBRy9ELEtBQUssQ0FBQ3lELElBQUksQ0FDbkJ2SSxDQUFDLElBQUtBLENBQUMsQ0FBQ3lDLEVBQUUsQ0FBQ3JCLEdBQUcsS0FBS21CLElBQUksQ0FBQ0UsRUFBRSxDQUFDckIsR0FBRyxJQUFJcEIsQ0FBQyxDQUFDeUMsRUFBRSxDQUFDcEIsR0FBRyxLQUFLa0IsSUFBSSxDQUFDRSxFQUFFLENBQUNwQixHQUMxRCxDQUFDO0VBQ0QsSUFBSSxDQUFDd0gsS0FBSyxFQUFFO0lBQ1ZqRyxPQUFPLENBQUNDLEdBQUcsQ0FBQyw4QkFBOEIsRUFBRU4sSUFBSSxDQUFDO0lBQ2pELE9BQU8sS0FBSztFQUNkO0VBRUEsSUFBSXVHLFFBQVEsR0FBRzNCLFVBQVUsQ0FBQ2pKLEtBQUssQ0FBQztFQUNoQzRLLFFBQVEsQ0FBQ3ZHLElBQUksQ0FBQ0UsRUFBRSxDQUFDckIsR0FBRyxDQUFDLENBQUNtQixJQUFJLENBQUNFLEVBQUUsQ0FBQ3BCLEdBQUcsQ0FBQyxHQUFHeUgsUUFBUSxDQUFDdkcsSUFBSSxDQUFDQyxJQUFJLENBQUNwQixHQUFHLENBQUMsQ0FBQ21CLElBQUksQ0FBQ0MsSUFBSSxDQUFDbkIsR0FBRyxDQUFDO0VBQzNFeUgsUUFBUSxDQUFDdkcsSUFBSSxDQUFDQyxJQUFJLENBQUNwQixHQUFHLENBQUMsQ0FBQ21CLElBQUksQ0FBQ0MsSUFBSSxDQUFDbkIsR0FBRyxDQUFDLEdBQUcsSUFBSTtFQUU3QyxJQUFJaUcsT0FBTyxHQUFHQyxRQUFRLENBQUN1QixRQUFRLEVBQUU3SCxLQUFLLENBQUM7RUFDdkMsSUFBSSxDQUFDcUcsT0FBTyxFQUFFO0lBQ1oxRSxPQUFPLENBQUNDLEdBQUcsQ0FBQyw0QkFBNEIsRUFBRU4sSUFBSSxDQUFDO0lBQy9DLE9BQU8sS0FBSztFQUNkO0VBRUEsSUFBSSxDQUFDNkUsVUFBVSxDQUFDMEIsUUFBUSxFQUFFN0gsS0FBSyxDQUFDLEVBQUU7SUFDaEMyQixPQUFPLENBQUNDLEdBQUcsQ0FBQyxvQ0FBb0MsRUFBRU4sSUFBSSxFQUFFLFVBQVUsRUFBRStFLE9BQU8sQ0FBQztJQUM1RSxPQUFPLEtBQUs7RUFDZDtFQUVBLE9BQU8sSUFBSTtBQUNiOztBQUVBO0FBQ0E7QUFDQSxJQUFJLE9BQU95QixPQUFPLEtBQUssV0FBVyxJQUFJLENBQUNBLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDQyxRQUFRLEtBQUssTUFBTSxFQUFFO0VBQ3RFeEksZUFBZSxDQUFDLENBQUM7QUFDbkI7O0FBR0E7QUFDQSxJQUFJLE9BQU95SSxNQUFNLEtBQUssV0FBVyxJQUFJQSxNQUFNLENBQUNDLE9BQU8sRUFBRTtFQUNuREQsTUFBTSxDQUFDQyxPQUFPLEdBQUc7SUFDZmpLLE9BQU87SUFDUDhGLGlCQUFpQjtJQUNqQkQsaUJBQWlCO0lBQ2pCckMsV0FBVztJQUNYakMsZUFBZTtJQUNmK0QsaUJBQWlCO0lBQ2pCN0MsZ0JBQWdCO0lBQ2hCc0csY0FBYztJQUNkZCxVQUFVO0lBQ1Z2RixXQUFXO0lBQ1hvQyxhQUFhO0lBQ2I4QyxTQUFTO0lBQ1Q3QyxlQUFlO0lBQ2ZXLHFCQUFxQjtJQUNyQmMsVUFBVTtJQUNWMEIsVUFBVTtJQUNWdkcsV0FBVztJQUNYcEM7RUFDRixDQUFDO0FBQ0giLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["boardElement","document","getElementById","promotionModal","promotionChoices","querySelectorAll","startGameBtn","gameModeSelect","whiteClockEl","blackClockEl","menuScreen","gameScreen","board","currentPlayer","selectedPiece","selectedPos","moveHistory","boardHistory","fiftyMoveCounter","enPassantTarget","whiteTime","blackTime","clockInterval","draggingPieceEl","dragOffset","x","y","dragStartPos","isPrime","n","i","Math","sqrt","startClock","clearInterval","setInterval","alert","resetGame","updateClockDisplay","innerText","formatTime","seconds","m","floor","s","addEventListener","initialTime","parseInt","value","style","display","initializeBoard","Array","fill","map","createPiece","drawBoard","updateBoardHistory","type","color","hasMoved","innerHTML","row","col","square","createElement","classList","add","dataset","isSquareAttacked","getOpponent","pieceEl","src","getPieceImageSrc","alt","onPieceMouseDown","appendChild","onSquareClick","piece","e","currentTarget","move","from","to","isLegalMove","makeMove","console","log","target","parentElement","cloneNode","body","rect","getBoundingClientRect","clientX","left","clientY","top","onMouseMove","onMouseUp","boardRect","abs","castle","removeChild","removeEventListener","isCastlingMove","performCastle","isEnPassantMove","performEnPassant","isLastRank","showPromotionModal","handlePawnDoubleStep","push","updateFiftyMoveCounter","checkForCheckmate","checkForStalemate","isThreefoldRepetition","isFiftyMoveRule","generateMovesForPiece","pos","moves","generatePawnMoves","generateRookMoves","generateKnightMoves","generateBishopMoves","generateRookMovesDefault","concat","generateKingMoves","generateCastlingMoves","direction","startRow","nextRow","isInBounds","dc","newCol","enPassant","directions","forEach","d","r","c","steps","offsets","o","destSquare","standardPathValid","modifiedPawnCount","modifiedPathValid","currentR","currentC","generateQueenMoves","king","canCastle","side","rook","isSquareSafeForKing","tempBoard","cloneBoard","isKingSafe","cell","kingPos","findKing","attackerColor","captureRow","fromRow","fromCol","toRow","toCol","pieceType","choice","selectedType","serializeBoard","join","counts","state","Object","values","some","count","generateAllMoves","legalMoves","filter","length","legal","newBoard","process","env","NODE_ENV","module","exports"],"sourceRoot":"/home/bayern/Chess_Temp/","sources":["gameController.js"],"sourcesContent":["/* \n  Modified Chess Game with Prime Rook Moves, Menu, Chess Clock, and Advanced Rules:\n  - Friendly rooks can only move a prime number of squares (allowed: 2, 3, 5, or 7).\n  - Queen moves remain standard.\n  - All other rules (castling, en passant, pawn promotion, etc.) remain unchanged.\n*/\n\n/* ----- DOM ELEMENTS ----- */\nconst boardElement = document.getElementById(\"chessboard\");\nconst promotionModal = document.getElementById(\"promotionModal\");\nconst promotionChoices = document.querySelectorAll(\".promotionChoice\");\nconst startGameBtn = document.getElementById(\"startGame\");\nconst gameModeSelect = document.getElementById(\"gameMode\");\nconst whiteClockEl = document.getElementById(\"whiteClock\");\nconst blackClockEl = document.getElementById(\"blackClock\");\nconst menuScreen = document.getElementById(\"menuScreen\");\nconst gameScreen = document.getElementById(\"gameScreen\");\n\n/* ----- GAME STATE VARIABLES ----- */\nlet board = [];\nlet currentPlayer = \"white\";\nlet selectedPiece = null;\nlet selectedPos = null;\nlet moveHistory = [];\nlet boardHistory = [];\nlet fiftyMoveCounter = 0;\nlet enPassantTarget = null;\n\n/* ----- CLOCK VARIABLES ----- */\nlet whiteTime = 0;\nlet blackTime = 0;\nlet clockInterval = null;\n\n/* ----- DRAGGING STATE ----- */\nlet draggingPieceEl = null;\nlet dragOffset = { x: 0, y: 0 };\nlet dragStartPos = null;\n\n/* ----- HELPER: Check if number is prime ----- */\nfunction isPrime(n) {\n  if (n < 2) return false;\n  for (let i = 2; i <= Math.sqrt(n); i++) {\n    if (n % i === 0) return false;\n  }\n  return true;\n}\n\n/* ----- CLOCK FUNCTIONS ----- */\nfunction startClock() {\n  clearInterval(clockInterval);\n  clockInterval = setInterval(() => {\n    if (currentPlayer === \"white\") {\n      whiteTime--;\n      if (whiteTime <= 0) {\n        clearInterval(clockInterval);\n        alert(\"Time's up! Black wins!\");\n        resetGame();\n        return;\n      }\n    } else {\n      blackTime--;\n      if (blackTime <= 0) {\n        clearInterval(clockInterval);\n        alert(\"Time's up! White wins!\");\n        resetGame();\n        return;\n      }\n    }\n    updateClockDisplay();\n  }, 1000);\n}\n\nfunction updateClockDisplay() {\n  whiteClockEl.innerText = formatTime(whiteTime);\n  blackClockEl.innerText = formatTime(blackTime);\n}\n\nfunction formatTime(seconds) {\n  let m = Math.floor(seconds / 60);\n  let s = seconds % 60;\n  return (m < 10 ? \"0\" + m : m) + \":\" + (s < 10 ? \"0\" + s : s);\n}\n\n/* ----- MENU AND GAME START ----- */\nstartGameBtn.addEventListener(\"click\", () => {\n  let initialTime = parseInt(gameModeSelect.value);\n  whiteTime = initialTime;\n  blackTime = initialTime;\n  updateClockDisplay();\n  menuScreen.style.display = \"none\";\n  gameScreen.style.display = \"block\";\n  initializeBoard();\n  startClock();\n});\n\n/* ----- INITIALIZATION ----- */\nfunction initializeBoard() {\n  board = Array(8)\n    .fill(null)\n    .map(() => Array(8).fill(null));\n  for (let i = 0; i < 8; i++) {\n    board[1][i] = createPiece(\"pawn\", \"black\");\n    board[6][i] = createPiece(\"pawn\", \"white\");\n  }\n  board[0][0] = createPiece(\"rook\", \"black\");\n  board[0][7] = createPiece(\"rook\", \"black\");\n  board[7][0] = createPiece(\"rook\", \"white\");\n  board[7][7] = createPiece(\"rook\", \"white\");\n  board[0][1] = createPiece(\"knight\", \"black\");\n  board[0][6] = createPiece(\"knight\", \"black\");\n  board[7][1] = createPiece(\"knight\", \"white\");\n  board[7][6] = createPiece(\"knight\", \"white\");\n  board[0][2] = createPiece(\"bishop\", \"black\");\n  board[0][5] = createPiece(\"bishop\", \"black\");\n  board[7][2] = createPiece(\"bishop\", \"white\");\n  board[7][5] = createPiece(\"bishop\", \"white\");\n  board[0][3] = createPiece(\"queen\", \"black\");\n  board[7][3] = createPiece(\"queen\", \"white\");\n  board[0][4] = createPiece(\"king\", \"black\");\n  board[7][4] = createPiece(\"king\", \"white\");\n\n  moveHistory = [];\n  boardHistory = [];\n  fiftyMoveCounter = 0;\n  enPassantTarget = null;\n  selectedPiece = null;\n  selectedPos = null;\n  currentPlayer = \"white\";\n\n  drawBoard();\n  updateBoardHistory();\n}\n\nfunction resetGame() {\n  clearInterval(clockInterval);\n  menuScreen.style.display = \"block\";\n  gameScreen.style.display = \"none\";\n  initializeBoard();\n}\n\n/* ----- PIECE CREATION ----- */\nfunction createPiece(type, color) {\n  return { type, color, hasMoved: false };\n}\n\n/* ----- DRAWING THE BOARD ----- */\nfunction drawBoard() {\n  boardElement.innerHTML = \"\";\n  for (let row = 0; row < 8; row++) {\n    for (let col = 0; col < 8; col++) {\n      let square = document.createElement(\"div\");\n      square.classList.add(\"square\");\n      square.dataset.row = row;\n      square.dataset.col = col;\n      square.classList.add((row + col) % 2 === 0 ? \"light\" : \"dark\");\n\n      if (selectedPos && selectedPos.row === row && selectedPos.col === col) {\n        square.classList.add(\"selected\");\n      }\n\n      if (board[row][col] && board[row][col].type === \"king\") {\n        if (isSquareAttacked(board, { row, col }, getOpponent(board[row][col].color))) {\n          square.classList.add(\"in-check\");\n        }\n      }\n\n      if (board[row][col]) {\n        let pieceEl = document.createElement(\"img\");\n        pieceEl.classList.add(\"piece-img\", board[row][col].color, board[row][col].type);\n        pieceEl.src = getPieceImageSrc(board[row][col]);\n        pieceEl.alt = board[row][col].type;\n        pieceEl.addEventListener(\"mousedown\", onPieceMouseDown);\n        square.appendChild(pieceEl);\n      }\n      square.addEventListener(\"click\", onSquareClick);\n      boardElement.appendChild(square);\n    }\n  }\n}\n\nfunction getPieceImageSrc(piece) {\n  return `assets/${piece.color}_${piece.type}.png`;\n}\n\n/* ----- CLICK HANDLING ----- */\nfunction onSquareClick(e) {\n  if (draggingPieceEl) return;\n\n  const row = parseInt(e.currentTarget.dataset.row);\n  const col = parseInt(e.currentTarget.dataset.col);\n\n  if (board[row][col] && board[row][col].color === currentPlayer) {\n    selectedPiece = board[row][col];\n    selectedPos = { row, col };\n  } else if (selectedPiece) {\n    let move = {\n      from: { row: selectedPos.row, col: selectedPos.col },\n      to: { row, col },\n      piece: selectedPiece,\n    };\n    if (isLegalMove(board, move, currentPlayer)) {\n      makeMove(move);\n    } else {\n      console.log(\"Illegal move attempted:\", move);\n    }\n    selectedPiece = null;\n    selectedPos = null;\n  }\n  drawBoard();\n}\n\n/* ----- DRAG-TO-MOVE HANDLING ----- */\nfunction onPieceMouseDown(e) {\n  const square = e.target.parentElement;\n  const row = parseInt(square.dataset.row);\n  const col = parseInt(square.dataset.col);\n\n  if (board[row][col].color !== currentPlayer) return;\n\n  selectedPiece = board[row][col];\n  selectedPos = { row, col };\n  dragStartPos = { row, col };\n\n  draggingPieceEl = e.target.cloneNode(true);\n  draggingPieceEl.classList.add(\"dragging\");\n  document.body.appendChild(draggingPieceEl);\n\n  const rect = e.target.getBoundingClientRect();\n  dragOffset.x = e.clientX - rect.left;\n  dragOffset.y = e.clientY - rect.top;\n\n  drawBoard();\n\n  document.addEventListener(\"mousemove\", onMouseMove);\n  document.addEventListener(\"mouseup\", onMouseUp);\n}\n\nfunction onMouseMove(e) {\n  if (draggingPieceEl) {\n    draggingPieceEl.style.left = e.clientX - dragOffset.x + \"px\";\n    draggingPieceEl.style.top = e.clientY - dragOffset.y + \"px\";\n  }\n}\n\nfunction onMouseUp(e) {\n  if (!draggingPieceEl) return;\n\n  const boardRect = boardElement.getBoundingClientRect();\n  const x = e.clientX - boardRect.left;\n  const y = e.clientY - boardRect.top;\n  const col = Math.floor(x / 80);\n  const row = Math.floor(y / 80);\n\n  if (row >= 0 && row < 8 && col >= 0 && col < 8) {\n    let move = {\n      from: { row: dragStartPos.row, col: dragStartPos.col },\n      to: { row, col },\n      piece: selectedPiece,\n    };\n    // Detect castling: if king moves two squares horizontally\n    if (\n      move.piece.type === \"king\" &&\n      Math.abs(move.to.col - move.from.col) === 2\n    ) {\n      move.castle = move.to.col > move.from.col ? \"kingside\" : \"queenside\";\n    }\n    if (isLegalMove(board, move, currentPlayer)) {\n      makeMove(move);\n    } else {\n      console.log(\"Illegal move attempted via drag:\", move);\n    }\n  }\n\n  document.body.removeChild(draggingPieceEl);\n  draggingPieceEl = null;\n  dragStartPos = null;\n  selectedPiece = null;\n  selectedPos = null;\n  document.removeEventListener(\"mousemove\", onMouseMove);\n  document.removeEventListener(\"mouseup\", onMouseUp);\n  drawBoard();\n}\n\n/* ----- MAKING MOVES ----- */\nfunction makeMove(move) {\n  if (isCastlingMove(move)) {\n    performCastle(move);\n  } else if (isEnPassantMove(move)) {\n    performEnPassant(move);\n  } else {\n    board[move.to.row][move.to.col] = move.piece;\n    board[move.from.row][move.from.col] = null;\n    if (move.piece.type === \"pawn\" && isLastRank(move.to, move.piece.color)) {\n      showPromotionModal(move);\n      return;\n    }\n  }\n  move.piece.hasMoved = true;\n  handlePawnDoubleStep(move);\n  moveHistory.push(move);\n  updateFiftyMoveCounter(move);\n  updateBoardHistory();\n\n  // Switch turn. currentPlayer becomes the player who is about to move.\n  currentPlayer = getOpponent(currentPlayer);\n  startClock();\n\n  // FIXED: Check for checkmate on the current player's turn\n  if (checkForCheckmate(board, currentPlayer)) {\n    alert(\"Checkmate! \" + getOpponent(currentPlayer) + \" wins.\");\n    clearInterval(clockInterval);\n    resetGame();\n    return;\n  } else if (checkForStalemate(board, currentPlayer)) {\n    alert(\"Stalemate!\");\n    clearInterval(clockInterval);\n    resetGame();\n    return;\n  } else if (isThreefoldRepetition()) {\n    alert(\"Draw by threefold repetition!\");\n    clearInterval(clockInterval);\n    resetGame();\n    return;\n  } else if (isFiftyMoveRule()) {\n    alert(\"Draw by fifty-move rule!\");\n    clearInterval(clockInterval);\n    resetGame();\n    return;\n  }\n\n  selectedPiece = null;\n  selectedPos = null;\n  drawBoard();\n}\n\n/* ----- MOVE GENERATION ----- */\nfunction generateMovesForPiece(board, pos) {\n  let piece = board[pos.row][pos.col];\n  if (!piece) return [];\n  let moves = [];\n  switch (piece.type) {\n    case \"pawn\":\n      moves = generatePawnMoves(board, pos, piece);\n      break;\n    case \"rook\":\n      // Friendly rooks: restrict moves to prime number of squares.\n      moves = generateRookMoves(board, pos, piece);\n      break;\n    case \"knight\":\n      moves = generateKnightMoves(board, pos, piece);\n      break;\n    case \"bishop\":\n      moves = generateBishopMoves(board, pos, piece);\n      break;\n    case \"queen\":\n      // For queen, use default rook moves (no prime restriction) plus bishop moves.\n      moves = generateRookMovesDefault(board, pos, piece).concat(\n        generateBishopMoves(board, pos, piece)\n      );\n      break;\n    case \"king\":\n      moves = generateKingMoves(board, pos, piece);\n      moves = moves.concat(generateCastlingMoves(board, pos, piece));\n      break;\n  }\n  return moves;\n}\n\nfunction generatePawnMoves(board, pos, piece) {\n  let moves = [];\n  let direction = piece.color === \"white\" ? -1 : 1;\n  let startRow = piece.color === \"white\" ? 6 : 1;\n  let nextRow = pos.row + direction;\n  if (isInBounds(nextRow, pos.col) && board[nextRow][pos.col] === null) {\n    moves.push({ from: pos, to: { row: nextRow, col: pos.col }, piece });\n    if (\n      pos.row === startRow &&\n      isInBounds(nextRow + direction, pos.col) &&\n      board[nextRow + direction][pos.col] === null\n    ) {\n      moves.push({\n        from: pos,\n        to: { row: nextRow + direction, col: pos.col },\n        piece,\n      });\n    }\n  }\n  for (let dc of [-1, 1]) {\n    let newCol = pos.col + dc;\n    if (isInBounds(nextRow, newCol)) {\n      if (board[nextRow][newCol] && board[nextRow][newCol].color !== piece.color) {\n        moves.push({ from: pos, to: { row: nextRow, col: newCol }, piece });\n      }\n      if (\n        board[nextRow][newCol] === null &&\n        enPassantTarget &&\n        enPassantTarget.row === nextRow &&\n        enPassantTarget.col === newCol\n      ) {\n        moves.push({ from: pos, to: { row: nextRow, col: newCol }, piece, enPassant: true });\n      }\n    }\n  }\n  return moves;\n}\n\n/* Modified Rook Moves: For friendly rooks, allow moves only if the number of squares moved is prime (2, 3, 5, or 7) */\nfunction generateRookMoves(board, pos, piece) {\n  let moves = [];\n  let directions = [\n    [1, 0],\n    [-1, 0],\n    [0, 1],\n    [0, -1],\n  ];\n  directions.forEach((d) => {\n    let r = pos.row;\n    let c = pos.col;\n    let steps = 0;\n    while (true) {\n      r += d[0];\n      c += d[1];\n      steps++;\n      if (!isInBounds(r, c)) break;\n      if (isPrime(steps)) {\n        if (board[r][c] === null) {\n          moves.push({ from: pos, to: { row: r, col: c }, piece });\n        } else {\n          if (board[r][c].color !== piece.color) {\n            moves.push({ from: pos, to: { row: r, col: c }, piece });\n          }\n          break;\n        }\n      } else {\n        if (board[r][c] !== null) break;\n      }\n    }\n  });\n  return moves;\n}\n\n/* Default Rook Moves for queen moves and enemy attack detection (no prime restriction) */\nfunction generateRookMovesDefault(board, pos, piece) {\n  let moves = [];\n  let directions = [\n    [1, 0],\n    [-1, 0],\n    [0, 1],\n    [0, -1],\n  ];\n  directions.forEach((d) => {\n    let r = pos.row;\n    let c = pos.col;\n    while (true) {\n      r += d[0];\n      c += d[1];\n      if (!isInBounds(r, c)) break;\n      if (board[r][c] === null) {\n        moves.push({ from: pos, to: { row: r, col: c }, piece });\n      } else {\n        moves.push({ from: pos, to: { row: r, col: c }, piece });\n        break;\n      }\n    }\n  });\n  return moves;\n}\n\nfunction generateKnightMoves(board, pos, piece) {\n  let moves = [];\n  let offsets = [\n    [-2, -1],\n    [-2, 1],\n    [-1, -2],\n    [-1, 2],\n    [1, -2],\n    [1, 2],\n    [2, -1],\n    [2, 1],\n  ];\n  offsets.forEach((o) => {\n    let r = pos.row + o[0];\n    let c = pos.col + o[1];\n    if (isInBounds(r, c) && (!board[r][c] || board[r][c].color !== piece.color)) {\n      moves.push({ from: pos, to: { row: r, col: c }, piece });\n    }\n  });\n  return moves;\n}\n\nfunction generateBishopMoves(board, pos, piece) {\n  let moves = [];\n  let directions = [\n    [1, 1],\n    [1, -1],\n    [-1, 1],\n    [-1, -1],\n  ];\n  directions.forEach((d) => {\n    for (let steps = 1; steps < 8; steps++) {\n      let r = pos.row + d[0] * steps;\n      let c = pos.col + d[1] * steps;\n      if (!isInBounds(r, c)) break;\n\n      // Skip if destination is occupied by a friendly piece\n      let destSquare = board[r][c];\n      if (destSquare && destSquare.color === piece.color) continue;\n\n      let standardPathValid = true;\n      let modifiedPawnCount = 0;\n      let modifiedPathValid = true;\n\n      // Check standard path validity (all intermediate squares empty)\n      for (let s = 1; s < steps; s++) {\n        let currentR = pos.row + d[0] * s;\n        let currentC = pos.col + d[1] * s;\n        if (board[currentR][currentC] !== null) {\n          standardPathValid = false;\n          break;\n        }\n      }\n\n      // Check modified path validity (exactly one pawn in intermediate squares)\n      for (let s = 1; s < steps; s++) {\n        let currentR = pos.row + d[0] * s;\n        let currentC = pos.col + d[1] * s;\n        let square = board[currentR][currentC];\n        if (square) {\n          if (square.type === 'pawn') {\n            modifiedPawnCount++;\n            if (modifiedPawnCount > 1) {\n              modifiedPathValid = false;\n              break;\n            }\n          } else {\n            modifiedPathValid = false;\n            break;\n          }\n        }\n      }\n      modifiedPathValid = modifiedPathValid && modifiedPawnCount === 1;\n\n      // Add move if either path is valid\n      if (standardPathValid || modifiedPathValid) {\n        moves.push({ from: pos, to: { row: r, col: c }, piece });\n      }\n    }\n  });\n  return moves;\n}\n\nfunction generateQueenMoves(board, pos, piece) {\n  // Queen moves = default rook moves (no prime restriction) + bishop moves\n  return generateRookMovesDefault(board, pos, piece).concat(\n    generateBishopMoves(board, pos, piece)\n  );\n}\n\nfunction generateKingMoves(board, pos, piece) {\n  let moves = [];\n  for (let r = pos.row - 1; r <= pos.row + 1; r++) {\n    for (let c = pos.col - 1; c <= pos.col + 1; c++) {\n      if (r === pos.row && c === pos.col) continue;\n      if (isInBounds(r, c) && (!board[r][c] || board[r][c].color !== piece.color)) {\n        moves.push({ from: pos, to: { row: r, col: c }, piece });\n      }\n    }\n  }\n  return moves;\n}\n\nfunction generateCastlingMoves(board, pos, king) {\n  let moves = [];\n  if (king.hasMoved) return moves;\n  if (canCastle(board, king, { side: \"kingside\", pos })) {\n    moves.push({\n      from: pos,\n      to: { row: pos.row, col: pos.col + 2 },\n      piece: king,\n      castle: \"kingside\",\n    });\n  }\n  if (canCastle(board, king, { side: \"queenside\", pos })) {\n    moves.push({\n      from: pos,\n      to: { row: pos.row, col: pos.col - 2 },\n      piece: king,\n      castle: \"queenside\",\n    });\n  }\n  return moves;\n}\n\n/* ----- CASTLING LOGIC ----- */\nfunction canCastle(board, king, { side, pos }) {\n  let row = pos.row;\n  if (king.hasMoved) return false;\n  if (side === \"kingside\") {\n    let rook = board[row][7];\n    if (!rook || rook.type !== \"rook\" || rook.hasMoved) return false;\n    if (board[row][5] !== null || board[row][6] !== null) return false;\n    if (\n      !isSquareSafeForKing(board, { row, col: 4 }, king.color) ||\n      !isSquareSafeForKing(board, { row, col: 5 }, king.color) ||\n      !isSquareSafeForKing(board, { row, col: 6 }, king.color)\n    )\n      return false;\n    return true;\n  } else if (side === \"queenside\") {\n    let rook = board[row][0];\n    if (!rook || rook.type !== \"rook\" || rook.hasMoved) return false;\n    if (board[row][1] !== null || board[row][2] !== null || board[row][3] !== null)\n      return false;\n    if (\n      !isSquareSafeForKing(board, { row, col: 4 }, king.color) ||\n      !isSquareSafeForKing(board, { row, col: 3 }, king.color) ||\n      !isSquareSafeForKing(board, { row, col: 2 }, king.color)\n    )\n      return false;\n    return true;\n  }\n  return false;\n}\n\nfunction isSquareSafeForKing(board, pos, color) {\n  let tempBoard = cloneBoard(board);\n  tempBoard[pos.row][pos.col] = { type: \"king\", color, hasMoved: true };\n  return isKingSafe(tempBoard, color);\n}\n\n/* ----- HELPER FUNCTIONS ----- */\nfunction isInBounds(row, col) {\n  return row >= 0 && row < 8 && col >= 0 && col < 8;\n}\n\nfunction cloneBoard(board) {\n  return board.map((row) => row.map((cell) => (cell ? { ...cell } : null)));\n}\n\nfunction isKingSafe(board, color) {\n  let kingPos = findKing(board, color);\n  if (!kingPos) return false;\n  return !isSquareAttacked(board, kingPos, getOpponent(color));\n}\n\nfunction findKing(board, color) {\n  for (let r = 0; r < 8; r++) {\n    for (let c = 0; c < 8; c++) {\n      let piece = board[r][c];\n      if (piece && piece.type === \"king\" && piece.color === color) {\n        return { row: r, col: c };\n      }\n    }\n  }\n  return null;\n}\n\nfunction isSquareAttacked(board, pos, attackerColor) {\n  for (let r = 0; r < 8; r++) {\n    for (let c = 0; c < 8; c++) {\n      let piece = board[r][c];\n      if (piece && piece.color === attackerColor) {\n        let moves;\n        if (piece.type === \"rook\") {\n          // For enemy rooks, use full-range moves (default) for attack detection.\n          moves = generateRookMovesDefault(board, { row: r, col: c }, piece);\n        } else {\n          moves = generateMovesForPiece(board, { row: r, col: c });\n        }\n        for (let move of moves) {\n          if (move.to.row === pos.row && move.to.col === pos.col) return true;\n        }\n      }\n    }\n  }\n  return false;\n}\n\nfunction getOpponent(color) {\n  return color === \"white\" ? \"black\" : \"white\";\n}\n\n/* ----- EN PASSANT LOGIC ----- */\nfunction handlePawnDoubleStep(move) {\n  if (\n    move.piece.type === \"pawn\" &&\n    Math.abs(move.from.row - move.to.row) === 2\n  ) {\n    enPassantTarget = {\n      row: (move.from.row + move.to.row) / 2,\n      col: move.from.col,\n    };\n  } else {\n    enPassantTarget = null;\n  }\n}\n\nfunction isEnPassantMove(move) {\n  return (\n    move.piece.type === \"pawn\" &&\n    move.from.col !== move.to.col &&\n    board[move.to.row][move.to.col] === null\n  );\n}\n\nfunction performEnPassant(move) {\n  board[move.to.row][move.to.col] = move.piece;\n  board[move.from.row][move.from.col] = null;\n  let captureRow = move.piece.color === \"white\" ? move.to.row + 1 : move.to.row - 1;\n  board[captureRow][move.to.col] = null;\n}\n\n/* ----- CASTLING HANDLING ----- */\nfunction isCastlingMove(move) {\n  return (\n    move.piece.type === \"king\" && Math.abs(move.to.col - move.from.col) === 2\n  );\n}\n\nfunction performCastle(move) {\n  let row = move.from.row;\n  if (move.castle === \"kingside\") {\n    board[row][6] = move.piece;\n    board[row][4] = null;\n    let rook = board[row][7];\n    board[row][5] = rook;\n    board[row][7] = null;\n    rook.hasMoved = true;\n  } else if (move.castle === \"queenside\") {\n    board[row][2] = move.piece;\n    board[row][4] = null;\n    let rook = board[row][0];\n    board[row][3] = rook;\n    board[row][0] = null;\n    rook.hasMoved = true;\n  }\n}\n\n/* ----- PAWN PROMOTION ----- */\nfunction isLastRank(pos, color) {\n  return (color === \"white\" && pos.row === 0) || (color === \"black\" && pos.row === 7);\n}\n\nfunction showPromotionModal(move) {\n  promotionModal.style.display = \"block\";\n  promotionModal.dataset.fromRow = move.from.row;\n  promotionModal.dataset.fromCol = move.from.col;\n  promotionModal.dataset.toRow = move.to.row;\n  promotionModal.dataset.toCol = move.to.col;\n  promotionModal.dataset.color = move.piece.color;\n  promotionModal.dataset.pieceType = move.piece.type;\n}\n\npromotionChoices.forEach((choice) => {\n  choice.addEventListener(\"click\", function () {\n    let selectedType = this.dataset.type;\n    let move = {\n      from: {\n        row: parseInt(promotionModal.dataset.fromRow),\n        col: parseInt(promotionModal.dataset.fromCol),\n      },\n      to: {\n        row: parseInt(promotionModal.dataset.toRow),\n        col: parseInt(promotionModal.dataset.toCol),\n      },\n      piece: {\n        type: promotionModal.dataset.pieceType,\n        color: promotionModal.dataset.color,\n      },\n    };\n    board[move.to.row][move.to.col] = createPiece(selectedType, move.piece.color);\n    board[move.from.row][move.from.col] = null;\n    promotionModal.style.display = \"none\";\n    board[move.to.row][move.to.col].hasMoved = true;\n    moveHistory.push(move);\n    updateFiftyMoveCounter(move);\n    updateBoardHistory();\n    if (checkForCheckmate(board, getOpponent(currentPlayer))) {\n      alert(\"Checkmate! \" + getOpponent(currentPlayer) + \" wins.\");\n      clearInterval(clockInterval);\n      resetGame();\n      return;\n    } else if (checkForStalemate(board, getOpponent(currentPlayer))) {\n      alert(\"Stalemate!\");\n      clearInterval(clockInterval);\n      resetGame();\n      return;\n    }\n    currentPlayer = getOpponent(currentPlayer);\n    startClock();\n    selectedPiece = null;\n    selectedPos = null;\n    drawBoard();\n  });\n});\n\n/* ----- BOARD HISTORY & DRAWING RULES ----- */\nfunction serializeBoard(board) {\n  return board\n    .map((row) =>\n      row.map((cell) => (cell ? cell.type[0] + cell.color[0] : \"  \")).join(\"\")\n    )\n    .join(\"|\");\n}\n\nfunction updateBoardHistory() {\n  boardHistory.push(serializeBoard(board));\n}\n\nfunction isThreefoldRepetition() {\n  let counts = {};\n  boardHistory.forEach((state) => {\n    counts[state] = (counts[state] || 0) + 1;\n  });\n  return Object.values(counts).some((count) => count >= 3);\n}\n\nfunction updateFiftyMoveCounter(move) {\n  if (move.piece.type === \"pawn\" || board[move.to.row][move.to.col] !== null) {\n    fiftyMoveCounter = 0;\n  } else {\n    fiftyMoveCounter++;\n  }\n}\n\nfunction isFiftyMoveRule() {\n  return fiftyMoveCounter >= 50;\n}\n\n/* ----- CHECKMATE & STALEMATE ----- */\n// Checkmate: the current player's king is in check and has no legal moves.\nfunction checkForCheckmate(board, color) {\n  if (!isKingSafe(board, color)) {\n    let moves = generateAllMoves(board, color);\n    let legalMoves = moves.filter((m) => isLegalMove(board, m, color));\n    if (legalMoves.length === 0) {\n      console.log(\"Checkmate detected for\", color);\n      return true;\n    }\n  }\n  return false;\n}\n\nfunction checkForStalemate(board, color) {\n  if (isKingSafe(board, color)) {\n    let moves = generateAllMoves(board, color);\n    let legalMoves = moves.filter((m) => isLegalMove(board, m, color));\n    if (legalMoves.length === 0) return true;\n  }\n  return false;\n}\n\nfunction generateAllMoves(board, color) {\n  let moves = [];\n  for (let r = 0; r < 8; r++) {\n    for (let c = 0; c < 8; c++) {\n      let piece = board[r][c];\n      if (piece && piece.color === color) {\n        moves = moves.concat(generateMovesForPiece(board, { row: r, col: c }));\n      }\n    }\n  }\n  return moves;\n}\n\n/* ----- MOVE VALIDATION ----- */\nfunction isLegalMove(board, move, color) {\n  let moves = generateMovesForPiece(board, move.from);\n  let legal = moves.some(\n    (m) => m.to.row === move.to.row && m.to.col === move.to.col\n  );\n  if (!legal) {\n    console.log(\"Move not in generated moves:\", move);\n    return false;\n  }\n\n  let newBoard = cloneBoard(board);\n  newBoard[move.to.row][move.to.col] = newBoard[move.from.row][move.from.col];\n  newBoard[move.from.row][move.from.col] = null;\n\n  let kingPos = findKing(newBoard, color);\n  if (!kingPos) {\n    console.log(\"King not found after move:\", move);\n    return false;\n  }\n\n  if (!isKingSafe(newBoard, color)) {\n    console.log(\"King would be in check after move:\", move, \"King at:\", kingPos);\n    return false;\n  }\n\n  return true;\n}\n\n/* ----- END GAME INITIALIZATION ----- */\n// Only initialize if running in browser\nif (typeof process === 'undefined' || !process.env.NODE_ENV === 'test') {\n  initializeBoard();\n}\n\n\n// Export for Jest testing while maintaining browser compatibility\nif (typeof module !== 'undefined' && module.exports) {\n  module.exports = {\n    isPrime,\n    generateRookMoves,\n    generatePawnMoves,\n    isLegalMove,\n    initializeBoard,\n    checkForCheckmate,\n    isSquareAttacked,\n    serializeBoard,\n    cloneBoard,\n    getOpponent,\n    performCastle,\n    canCastle,\n    isEnPassantMove,\n    generateMovesForPiece,\n    isInBounds,\n    isKingSafe,\n    createPiece,\n    enPassantTarget\n  };\n}"],"mappings":"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","ignoreList":[]}},"mtime":1743345741490},"{\"assumptions\":{},\"sourceRoot\":\"/home/bayern/Chess_Temp/test/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/home/bayern/Chess_Temp\",\"filename\":\"/home/bayern/Chess_Temp/test/game.test.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/bayern/Chess_Temp\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"transform-duplicate-named-capturing-groups-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-regexp-modifiers\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-unicode-sets-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/bayern/Chess_Temp/node_modules/@babel/preset-env/lib/index.js$3\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/bayern/Chess_Temp/node_modules/@babel/preset-env/lib/index.js$4\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/bayern/Chess_Temp/node_modules/@babel/preset-env/lib/index.js$5\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/bayern/Chess_Temp/node_modules/@babel/preset-env/lib/index.js$6\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/bayern/Chess_Temp/node_modules/@babel/preset-env/lib/index.js$7\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/bayern/Chess_Temp/node_modules/@babel/preset-env/lib/index.js$8\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/bayern/Chess_Temp/node_modules/@babel/preset-env/lib/index.js$9\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/bayern/Chess_Temp/node_modules/@babel/preset-env/lib/index.js$10\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/bayern/Chess_Temp/node_modules/@babel/preset-env/lib/index.js$11\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/bayern/Chess_Temp/node_modules/@babel/preset-env/lib/index.js$12\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/bayern/Chess_Temp/node_modules/@babel/preset-env/lib/index.js$16\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/bayern/Chess_Temp/node_modules/@babel/preset-env/lib/index.js$17\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.26.10:development":{"value":{"code":"\"use strict\";\n\nconst {\n  expect\n} = require('chai');\nlet {\n  isPrime,\n  generateRookMoves,\n  generatePawnMoves,\n  isLegalMove,\n  initializeBoard,\n  checkForCheckmate,\n  isSquareAttacked,\n  serializeBoard,\n  cloneBoard,\n  getOpponent,\n  isInBounds,\n  isKingSafe,\n  performCastle,\n  canCastle,\n  isEnPassantMove,\n  generateMovesForPiece,\n  createPiece,\n  enPassantTarget\n} = require('../gameController');\ndescribe('Chess Game Tests', () => {\n  let testBoard;\n  before(() => {\n    // Create a fresh board with just the pieces we need for testing\n    testBoard = Array(8).fill().map(() => Array(8).fill(null));\n  });\n  beforeEach(() => {\n    testBoard = initializeBoard();\n  });\n  describe('Prime Number Validation', () => {\n    it('should identify prime numbers correctly', () => {\n      expect(isPrime(2)).to.be.true;\n      expect(isPrime(7)).to.be.true;\n      expect(isPrime(1)).to.be.false;\n      expect(isPrime(4)).to.be.false;\n      expect(isPrime(9)).to.be.false;\n    });\n  });\n  describe('Rook Movement', () => {\n    it('should only allow prime-numbered moves for all rooks', () => {\n      // Test both friendly and enemy rooks\n      testBoard = Array(8).fill().map(() => Array(8).fill(null));\n\n      // Friendly rook (white)\n      testBoard[3][3] = {\n        type: 'rook',\n        color: 'white',\n        hasMoved: false\n      };\n      const friendlyMoves = generateRookMoves(testBoard, {\n        row: 3,\n        col: 3\n      }, testBoard[3][3]);\n\n      // Enemy rook (black)\n      testBoard[4][4] = {\n        type: 'rook',\n        color: 'black',\n        hasMoved: false\n      };\n      const enemyMoves = generateRookMoves(testBoard, {\n        row: 4,\n        col: 4\n      }, testBoard[4][4]);\n      const allowedDistances = new Set([2, 3, 5, 7]);\n\n      // Verify both rooks follow prime movement rules\n      [...friendlyMoves, ...enemyMoves].forEach(move => {\n        const dx = Math.abs(move.to.col - move.from.col);\n        const dy = Math.abs(move.to.row - move.from.row);\n        const distance = dx + dy; // Since rook moves straight\n        expect(allowedDistances.has(distance)).to.be.true;\n      });\n    });\n  });\n  describe('Pawn Movement', () => {\n    let testBoard;\n    beforeEach(() => {\n      testBoard = Array(8).fill().map(() => Array(8).fill(null));\n      enPassantTarget = null; // Reset enPassant target\n    });\n\n    // it('should detect en passant opportunities', () => {\n    //   // Set up pawns\n    //   testBoard[3][3] = { type: 'pawn', color: 'white', hasMoved: true };\n    //   testBoard[3][4] = { type: 'pawn', color: 'black', hasMoved: true };\n\n    //   // Simulate the double-step pawn move that creates en passant opportunity\n    //   const move = {\n    //     from: { row: 1, col: 4 },\n    //     to: { row: 3, col: 4 },\n    //     piece: testBoard[3][4],\n    //     color: 'black'\n    //   };\n\n    //   // Update enPassantTarget as the game would\n    //   enPassantTarget = { row: 2, col: 4 };\n\n    //   // Get white pawn's moves\n    //   const whitePawnMoves = generatePawnMoves(testBoard, { row: 3, col: 3 }, testBoard[3][3]);\n\n    //   // Verify en passant move exists diagonally\n    //   expect(whitePawnMoves).to.deep.include({\n    //     from: { row: 3, col: 3 },\n    //     to: { row: 2, col: 4 },\n    //     piece: testBoard[3][3],\n    //     enPassant: true\n    //   });\n    // });\n\n    it('should trigger promotion on last rank', () => {\n      const pawn = {\n        type: 'pawn',\n        color: 'white',\n        hasMoved: true\n      };\n      testBoard[1][0] = pawn;\n      const moves = generatePawnMoves(testBoard, {\n        row: 1,\n        col: 0\n      }, pawn);\n      expect(moves.some(m => m.to.row === 0)).to.be.true;\n    });\n  });\n  describe('Check Detection', () => {\n    let testBoard;\n    beforeEach(() => {\n      testBoard = Array(8).fill().map(() => Array(8).fill(null));\n    });\n    it('should identify attacked squares', () => {\n      // Place black rook in same column as white king\n      testBoard[0][4] = createPiece('rook', 'black'); // Top of column 4\n      testBoard[4][4] = createPiece('king', 'white'); // Center king\n\n      expect(isSquareAttacked(testBoard, {\n        row: 4,\n        col: 4\n      }, 'black')).to.be.true;\n    });\n    it('should detect checkmate state', () => {\n      // Proper checkmate setup\n      testBoard[7][4] = createPiece('king', 'white'); // White king in corner\n      testBoard[6][3] = createPiece('queen', 'black'); // Queen attacking diagonally\n      testBoard[7][5] = createPiece('rook', 'black'); // Rook blocking escape\n\n      // Debug checks\n      console.log(\"Is king safe:\", isKingSafe(testBoard, 'white'));\n      const allMoves = generateAllMoves(testBoard, 'white');\n      console.log(\"All moves generated:\", allMoves.length);\n      const legalMoves = allMoves.filter(m => isLegalMove(testBoard, m, 'white'));\n      console.log(\"Legal moves:\", legalMoves.length);\n      if (legalMoves.length > 0) {\n        console.log(\"Legal moves found:\", legalMoves);\n      }\n\n      // Verify no legal moves\n      expect(checkForCheckmate(testBoard, 'white')).to.be.true;\n    });\n  });\n  describe('Castling', () => {\n    beforeEach(() => {\n      // Create fresh board with only necessary pieces\n      testBoard = Array(8).fill().map(() => Array(8).fill(null));\n\n      // Set up castling scenario\n      testBoard[7][4] = createPiece('king', 'white'); // White king\n      testBoard[7][7] = createPiece('rook', 'white'); // Kingside rook\n    });\n    it('should allow kingside castling when valid', () => {\n      testBoard[7][5] = null;\n      testBoard[7][6] = null;\n      const king = testBoard[7][4]; // Don't forget to define king\n\n      expect(canCastle(testBoard, king, {\n        side: 'kingside',\n        pos: {\n          row: 7,\n          col: 4\n        }\n      })).to.be.true;\n    });\n    it('should prevent castling through attacked squares', () => {\n      testBoard[7][5] = null;\n      testBoard[7][6] = null;\n      testBoard[6][5] = {\n        type: 'bishop',\n        color: 'black',\n        hasMoved: true\n      };\n      const king = testBoard[7][4]; // Don't forget to define king\n\n      expect(canCastle(testBoard, king, {\n        side: 'kingside',\n        pos: {\n          row: 7,\n          col: 4\n        }\n      })).to.be.false;\n    });\n  });\n  describe('Board State Management', () => {\n    // it('should clone board correctly', () => {\n    //   const cloned = cloneBoard(testBoard);\n    //   cloned[0][0].hasMoved = true;\n    //   expect(testBoard[0][0].hasMoved).to.be.false;\n    // });\n\n    // it('should serialize board state', () => {\n    //   const serialized = serializeBoard(testBoard);\n    //   expect(serialized).to.include('rw|bw'); // Rook white and bishop white\n    // });\n  });\n  describe('Helper Functions', () => {\n    it('should identify opponent color', () => {\n      testBoard = Array(8).fill().map(() => Array(8).fill(null));\n      expect(getOpponent('white')).to.equal('black');\n      expect(getOpponent('black')).to.equal('white');\n    });\n    it('should validate board boundaries', () => {\n      testBoard = Array(8).fill().map(() => Array(8).fill(null));\n      expect(isInBounds(7, 7)).to.be.true;\n      expect(isInBounds(-1, 3)).to.be.false;\n      expect(isInBounds(4, 8)).to.be.false;\n    });\n\n    // it('should generate all legal moves', () => {\n    //   testBoard = Array(8).fill().map(() => Array(8).fill(null));\n    //   const initialMoves = generateMovesForPiece(testBoard, { row: 6, col: 0 }, testBoard[6][0]);\n    //   expect(initialMoves).to.have.lengthOf(2); // Initial pawn move\n    // });\n  });\n  describe('Special Moves', () => {\n    let testBoard;\n    beforeEach(() => {\n      // Create fresh board with proper castling setup\n      testBoard = Array(8).fill().map(() => Array(8).fill(null));\n      testBoard[7][4] = {\n        type: 'king',\n        color: 'white',\n        hasMoved: false // Crucial for castling\n      };\n      testBoard[7][7] = {\n        type: 'rook',\n        color: 'white',\n        hasMoved: false // Crucial for castling\n      };\n      // Clear the castling path\n      testBoard[7][5] = null;\n      testBoard[7][6] = null;\n    });\n    it('should detect en passant moves', () => {\n      testBoard = Array(8).fill().map(() => Array(8).fill(null));\n      const move = {\n        piece: {\n          type: 'pawn',\n          color: 'black'\n        },\n        from: {\n          row: 1,\n          col: 3\n        },\n        to: {\n          row: 3,\n          col: 3\n        }\n      };\n      expect(isEnPassantMove(move)).to.be.false; // Should only be true in specific context\n    });\n\n    //   it('should execute castling correctly', () => {\n    //   const king = testBoard[7][4];\n    //   const castleMove = {\n    //     from: { row: 7, col: 4 },\n    //     to: { row: 7, col: 6 },\n    //     piece: king,\n    //     castle: 'kingside'\n    //   };\n\n    //   performCastle(castleMove);\n\n    //   // Verify king moved\n    //   expect(testBoard[7][6]).to.deep.equal({\n    //     type: 'king',\n    //     color: 'white',\n    //     hasMoved: true\n    //   });\n\n    //   // Verify rook moved\n    //   expect(testBoard[7][5]).to.deep.equal({\n    //     type: 'rook',\n    //     color: 'white',\n    //     hasMoved: true\n    //   });\n\n    //   // Verify original positions are empty\n    //   expect(testBoard[7][4]).to.be.null;\n    //   expect(testBoard[7][7]).to.be.null;\n    // });\n  });\n});\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleHBlY3QiLCJyZXF1aXJlIiwiaXNQcmltZSIsImdlbmVyYXRlUm9va01vdmVzIiwiZ2VuZXJhdGVQYXduTW92ZXMiLCJpc0xlZ2FsTW92ZSIsImluaXRpYWxpemVCb2FyZCIsImNoZWNrRm9yQ2hlY2ttYXRlIiwiaXNTcXVhcmVBdHRhY2tlZCIsInNlcmlhbGl6ZUJvYXJkIiwiY2xvbmVCb2FyZCIsImdldE9wcG9uZW50IiwiaXNJbkJvdW5kcyIsImlzS2luZ1NhZmUiLCJwZXJmb3JtQ2FzdGxlIiwiY2FuQ2FzdGxlIiwiaXNFblBhc3NhbnRNb3ZlIiwiZ2VuZXJhdGVNb3Zlc0ZvclBpZWNlIiwiY3JlYXRlUGllY2UiLCJlblBhc3NhbnRUYXJnZXQiLCJkZXNjcmliZSIsInRlc3RCb2FyZCIsImJlZm9yZSIsIkFycmF5IiwiZmlsbCIsIm1hcCIsImJlZm9yZUVhY2giLCJpdCIsInRvIiwiYmUiLCJ0cnVlIiwiZmFsc2UiLCJ0eXBlIiwiY29sb3IiLCJoYXNNb3ZlZCIsImZyaWVuZGx5TW92ZXMiLCJyb3ciLCJjb2wiLCJlbmVteU1vdmVzIiwiYWxsb3dlZERpc3RhbmNlcyIsIlNldCIsImZvckVhY2giLCJtb3ZlIiwiZHgiLCJNYXRoIiwiYWJzIiwiZnJvbSIsImR5IiwiZGlzdGFuY2UiLCJoYXMiLCJwYXduIiwibW92ZXMiLCJzb21lIiwibSIsImNvbnNvbGUiLCJsb2ciLCJhbGxNb3ZlcyIsImdlbmVyYXRlQWxsTW92ZXMiLCJsZW5ndGgiLCJsZWdhbE1vdmVzIiwiZmlsdGVyIiwia2luZyIsInNpZGUiLCJwb3MiLCJlcXVhbCIsInBpZWNlIl0sInNvdXJjZVJvb3QiOiIvaG9tZS9iYXllcm4vQ2hlc3NfVGVtcC90ZXN0LyIsInNvdXJjZXMiOlsiZ2FtZS50ZXN0LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHsgZXhwZWN0IH0gPSByZXF1aXJlKCdjaGFpJyk7XG5sZXQge1xuICBpc1ByaW1lLFxuICBnZW5lcmF0ZVJvb2tNb3ZlcyxcbiAgZ2VuZXJhdGVQYXduTW92ZXMsXG4gIGlzTGVnYWxNb3ZlLFxuICBpbml0aWFsaXplQm9hcmQsXG4gIGNoZWNrRm9yQ2hlY2ttYXRlLFxuICBpc1NxdWFyZUF0dGFja2VkLFxuICBzZXJpYWxpemVCb2FyZCxcbiAgY2xvbmVCb2FyZCxcbiAgZ2V0T3Bwb25lbnQsXG4gIGlzSW5Cb3VuZHMsXG4gIGlzS2luZ1NhZmUsXG4gIHBlcmZvcm1DYXN0bGUsXG4gIGNhbkNhc3RsZSxcbiAgaXNFblBhc3NhbnRNb3ZlLFxuICBnZW5lcmF0ZU1vdmVzRm9yUGllY2UsXG4gIGNyZWF0ZVBpZWNlLFxuICBlblBhc3NhbnRUYXJnZXRcbn0gPSByZXF1aXJlKCcuLi9nYW1lQ29udHJvbGxlcicpO1xuXG5kZXNjcmliZSgnQ2hlc3MgR2FtZSBUZXN0cycsICgpID0+IHtcbiAgbGV0IHRlc3RCb2FyZDtcblxuICBiZWZvcmUoKCkgPT4ge1xuICAgIC8vIENyZWF0ZSBhIGZyZXNoIGJvYXJkIHdpdGgganVzdCB0aGUgcGllY2VzIHdlIG5lZWQgZm9yIHRlc3RpbmdcbiAgICB0ZXN0Qm9hcmQgPSBBcnJheSg4KS5maWxsKCkubWFwKCgpID0+IEFycmF5KDgpLmZpbGwobnVsbCkpO1xuICB9KTtcblxuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICB0ZXN0Qm9hcmQgPSBpbml0aWFsaXplQm9hcmQoKTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1ByaW1lIE51bWJlciBWYWxpZGF0aW9uJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaWRlbnRpZnkgcHJpbWUgbnVtYmVycyBjb3JyZWN0bHknLCAoKSA9PiB7XG4gICAgICBleHBlY3QoaXNQcmltZSgyKSkudG8uYmUudHJ1ZTtcbiAgICAgIGV4cGVjdChpc1ByaW1lKDcpKS50by5iZS50cnVlO1xuICAgICAgZXhwZWN0KGlzUHJpbWUoMSkpLnRvLmJlLmZhbHNlO1xuICAgICAgZXhwZWN0KGlzUHJpbWUoNCkpLnRvLmJlLmZhbHNlO1xuICAgICAgZXhwZWN0KGlzUHJpbWUoOSkpLnRvLmJlLmZhbHNlO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnUm9vayBNb3ZlbWVudCcsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIG9ubHkgYWxsb3cgcHJpbWUtbnVtYmVyZWQgbW92ZXMgZm9yIGFsbCByb29rcycsICgpID0+IHtcbiAgICAgIC8vIFRlc3QgYm90aCBmcmllbmRseSBhbmQgZW5lbXkgcm9va3NcbiAgICAgIHRlc3RCb2FyZCA9IEFycmF5KDgpLmZpbGwoKS5tYXAoKCkgPT4gQXJyYXkoOCkuZmlsbChudWxsKSk7XG4gICAgICBcbiAgICAgIC8vIEZyaWVuZGx5IHJvb2sgKHdoaXRlKVxuICAgICAgdGVzdEJvYXJkWzNdWzNdID0geyB0eXBlOiAncm9vaycsIGNvbG9yOiAnd2hpdGUnLCBoYXNNb3ZlZDogZmFsc2UgfTtcbiAgICAgIGNvbnN0IGZyaWVuZGx5TW92ZXMgPSBnZW5lcmF0ZVJvb2tNb3Zlcyh0ZXN0Qm9hcmQsIHsgcm93OiAzLCBjb2w6IDMgfSwgdGVzdEJvYXJkWzNdWzNdKTtcbiAgICAgIFxuICAgICAgLy8gRW5lbXkgcm9vayAoYmxhY2spXG4gICAgICB0ZXN0Qm9hcmRbNF1bNF0gPSB7IHR5cGU6ICdyb29rJywgY29sb3I6ICdibGFjaycsIGhhc01vdmVkOiBmYWxzZSB9O1xuICAgICAgY29uc3QgZW5lbXlNb3ZlcyA9IGdlbmVyYXRlUm9va01vdmVzKHRlc3RCb2FyZCwgeyByb3c6IDQsIGNvbDogNCB9LCB0ZXN0Qm9hcmRbNF1bNF0pO1xuICAgICAgXG4gICAgICBjb25zdCBhbGxvd2VkRGlzdGFuY2VzID0gbmV3IFNldChbMiwgMywgNSwgN10pO1xuICAgICAgXG4gICAgICAvLyBWZXJpZnkgYm90aCByb29rcyBmb2xsb3cgcHJpbWUgbW92ZW1lbnQgcnVsZXNcbiAgICAgIFsuLi5mcmllbmRseU1vdmVzLCAuLi5lbmVteU1vdmVzXS5mb3JFYWNoKG1vdmUgPT4ge1xuICAgICAgICBjb25zdCBkeCA9IE1hdGguYWJzKG1vdmUudG8uY29sIC0gbW92ZS5mcm9tLmNvbCk7XG4gICAgICAgIGNvbnN0IGR5ID0gTWF0aC5hYnMobW92ZS50by5yb3cgLSBtb3ZlLmZyb20ucm93KTtcbiAgICAgICAgY29uc3QgZGlzdGFuY2UgPSBkeCArIGR5OyAvLyBTaW5jZSByb29rIG1vdmVzIHN0cmFpZ2h0XG4gICAgICAgIGV4cGVjdChhbGxvd2VkRGlzdGFuY2VzLmhhcyhkaXN0YW5jZSkpLnRvLmJlLnRydWU7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1Bhd24gTW92ZW1lbnQnLCAoKSA9PiB7XG4gICAgbGV0IHRlc3RCb2FyZDtcbiAgXG4gICAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgICB0ZXN0Qm9hcmQgPSBBcnJheSg4KS5maWxsKCkubWFwKCgpID0+IEFycmF5KDgpLmZpbGwobnVsbCkpO1xuICAgICAgZW5QYXNzYW50VGFyZ2V0ID0gbnVsbDsgLy8gUmVzZXQgZW5QYXNzYW50IHRhcmdldFxuICAgIH0pO1xuICBcbiAgICAvLyBpdCgnc2hvdWxkIGRldGVjdCBlbiBwYXNzYW50IG9wcG9ydHVuaXRpZXMnLCAoKSA9PiB7XG4gICAgLy8gICAvLyBTZXQgdXAgcGF3bnNcbiAgICAvLyAgIHRlc3RCb2FyZFszXVszXSA9IHsgdHlwZTogJ3Bhd24nLCBjb2xvcjogJ3doaXRlJywgaGFzTW92ZWQ6IHRydWUgfTtcbiAgICAvLyAgIHRlc3RCb2FyZFszXVs0XSA9IHsgdHlwZTogJ3Bhd24nLCBjb2xvcjogJ2JsYWNrJywgaGFzTW92ZWQ6IHRydWUgfTtcbiAgXG4gICAgLy8gICAvLyBTaW11bGF0ZSB0aGUgZG91YmxlLXN0ZXAgcGF3biBtb3ZlIHRoYXQgY3JlYXRlcyBlbiBwYXNzYW50IG9wcG9ydHVuaXR5XG4gICAgLy8gICBjb25zdCBtb3ZlID0ge1xuICAgIC8vICAgICBmcm9tOiB7IHJvdzogMSwgY29sOiA0IH0sXG4gICAgLy8gICAgIHRvOiB7IHJvdzogMywgY29sOiA0IH0sXG4gICAgLy8gICAgIHBpZWNlOiB0ZXN0Qm9hcmRbM11bNF0sXG4gICAgLy8gICAgIGNvbG9yOiAnYmxhY2snXG4gICAgLy8gICB9O1xuICAgICAgXG4gICAgLy8gICAvLyBVcGRhdGUgZW5QYXNzYW50VGFyZ2V0IGFzIHRoZSBnYW1lIHdvdWxkXG4gICAgLy8gICBlblBhc3NhbnRUYXJnZXQgPSB7IHJvdzogMiwgY29sOiA0IH07XG4gIFxuICAgIC8vICAgLy8gR2V0IHdoaXRlIHBhd24ncyBtb3Zlc1xuICAgIC8vICAgY29uc3Qgd2hpdGVQYXduTW92ZXMgPSBnZW5lcmF0ZVBhd25Nb3Zlcyh0ZXN0Qm9hcmQsIHsgcm93OiAzLCBjb2w6IDMgfSwgdGVzdEJvYXJkWzNdWzNdKTtcbiAgICAgIFxuICAgIC8vICAgLy8gVmVyaWZ5IGVuIHBhc3NhbnQgbW92ZSBleGlzdHMgZGlhZ29uYWxseVxuICAgIC8vICAgZXhwZWN0KHdoaXRlUGF3bk1vdmVzKS50by5kZWVwLmluY2x1ZGUoe1xuICAgIC8vICAgICBmcm9tOiB7IHJvdzogMywgY29sOiAzIH0sXG4gICAgLy8gICAgIHRvOiB7IHJvdzogMiwgY29sOiA0IH0sXG4gICAgLy8gICAgIHBpZWNlOiB0ZXN0Qm9hcmRbM11bM10sXG4gICAgLy8gICAgIGVuUGFzc2FudDogdHJ1ZVxuICAgIC8vICAgfSk7XG4gICAgLy8gfSk7XG4gIFxuICAgIGl0KCdzaG91bGQgdHJpZ2dlciBwcm9tb3Rpb24gb24gbGFzdCByYW5rJywgKCkgPT4ge1xuICAgICAgY29uc3QgcGF3biA9IHsgdHlwZTogJ3Bhd24nLCBjb2xvcjogJ3doaXRlJywgaGFzTW92ZWQ6IHRydWUgfTtcbiAgICAgIHRlc3RCb2FyZFsxXVswXSA9IHBhd247XG4gICAgICBcbiAgICAgIGNvbnN0IG1vdmVzID0gZ2VuZXJhdGVQYXduTW92ZXModGVzdEJvYXJkLCB7IHJvdzogMSwgY29sOiAwIH0sIHBhd24pO1xuICAgICAgZXhwZWN0KG1vdmVzLnNvbWUobSA9PiBtLnRvLnJvdyA9PT0gMCkpLnRvLmJlLnRydWU7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdDaGVjayBEZXRlY3Rpb24nLCAoKSA9PiB7XG4gICAgbGV0IHRlc3RCb2FyZDtcbiAgXG4gICAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgICB0ZXN0Qm9hcmQgPSBBcnJheSg4KS5maWxsKCkubWFwKCgpID0+IEFycmF5KDgpLmZpbGwobnVsbCkpO1xuICAgIH0pO1xuICBcbiAgICBpdCgnc2hvdWxkIGlkZW50aWZ5IGF0dGFja2VkIHNxdWFyZXMnLCAoKSA9PiB7XG4gICAgICAvLyBQbGFjZSBibGFjayByb29rIGluIHNhbWUgY29sdW1uIGFzIHdoaXRlIGtpbmdcbiAgICAgIHRlc3RCb2FyZFswXVs0XSA9IGNyZWF0ZVBpZWNlKCdyb29rJywgJ2JsYWNrJyk7IC8vIFRvcCBvZiBjb2x1bW4gNFxuICAgICAgdGVzdEJvYXJkWzRdWzRdID0gY3JlYXRlUGllY2UoJ2tpbmcnLCAnd2hpdGUnKTsgLy8gQ2VudGVyIGtpbmdcbiAgICAgIFxuICAgICAgZXhwZWN0KGlzU3F1YXJlQXR0YWNrZWQodGVzdEJvYXJkLCB7IHJvdzogNCwgY29sOiA0IH0sICdibGFjaycpKS50by5iZS50cnVlO1xuICAgIH0pO1xuICBcbiAgICBpdCgnc2hvdWxkIGRldGVjdCBjaGVja21hdGUgc3RhdGUnLCAoKSA9PiB7XG4gICAgICAvLyBQcm9wZXIgY2hlY2ttYXRlIHNldHVwXG4gICAgICB0ZXN0Qm9hcmRbN11bNF0gPSBjcmVhdGVQaWVjZSgna2luZycsICd3aGl0ZScpOyAvLyBXaGl0ZSBraW5nIGluIGNvcm5lclxuICAgICAgdGVzdEJvYXJkWzZdWzNdID0gY3JlYXRlUGllY2UoJ3F1ZWVuJywgJ2JsYWNrJyk7IC8vIFF1ZWVuIGF0dGFja2luZyBkaWFnb25hbGx5XG4gICAgICB0ZXN0Qm9hcmRbN11bNV0gPSBjcmVhdGVQaWVjZSgncm9vaycsICdibGFjaycpOyAvLyBSb29rIGJsb2NraW5nIGVzY2FwZVxuICAgICAgXG4gICAgICAvLyBEZWJ1ZyBjaGVja3NcbiAgICAgIGNvbnNvbGUubG9nKFwiSXMga2luZyBzYWZlOlwiLCBpc0tpbmdTYWZlKHRlc3RCb2FyZCwgJ3doaXRlJykpO1xuICAgICAgXG4gICAgICBjb25zdCBhbGxNb3ZlcyA9IGdlbmVyYXRlQWxsTW92ZXModGVzdEJvYXJkLCAnd2hpdGUnKTtcbiAgICAgIGNvbnNvbGUubG9nKFwiQWxsIG1vdmVzIGdlbmVyYXRlZDpcIiwgYWxsTW92ZXMubGVuZ3RoKTtcbiAgICAgIFxuICAgICAgY29uc3QgbGVnYWxNb3ZlcyA9IGFsbE1vdmVzLmZpbHRlcihtID0+IGlzTGVnYWxNb3ZlKHRlc3RCb2FyZCwgbSwgJ3doaXRlJykpO1xuICAgICAgY29uc29sZS5sb2coXCJMZWdhbCBtb3ZlczpcIiwgbGVnYWxNb3Zlcy5sZW5ndGgpO1xuICAgICAgaWYgKGxlZ2FsTW92ZXMubGVuZ3RoID4gMCkge1xuICAgICAgICBjb25zb2xlLmxvZyhcIkxlZ2FsIG1vdmVzIGZvdW5kOlwiLCBsZWdhbE1vdmVzKTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gVmVyaWZ5IG5vIGxlZ2FsIG1vdmVzXG4gICAgICBleHBlY3QoY2hlY2tGb3JDaGVja21hdGUodGVzdEJvYXJkLCAnd2hpdGUnKSkudG8uYmUudHJ1ZTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0Nhc3RsaW5nJywgKCkgPT4ge1xuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgICAgLy8gQ3JlYXRlIGZyZXNoIGJvYXJkIHdpdGggb25seSBuZWNlc3NhcnkgcGllY2VzXG4gICAgICB0ZXN0Qm9hcmQgPSBBcnJheSg4KS5maWxsKCkubWFwKCgpID0+IEFycmF5KDgpLmZpbGwobnVsbCkpO1xuICAgICAgXG4gICAgICAvLyBTZXQgdXAgY2FzdGxpbmcgc2NlbmFyaW9cbiAgICAgIHRlc3RCb2FyZFs3XVs0XSA9IGNyZWF0ZVBpZWNlKCdraW5nJywgJ3doaXRlJyk7ICAvLyBXaGl0ZSBraW5nXG4gICAgICB0ZXN0Qm9hcmRbN11bN10gPSBjcmVhdGVQaWVjZSgncm9vaycsICd3aGl0ZScpOyAgLy8gS2luZ3NpZGUgcm9va1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBhbGxvdyBraW5nc2lkZSBjYXN0bGluZyB3aGVuIHZhbGlkJywgKCkgPT4ge1xuICAgICAgdGVzdEJvYXJkWzddWzVdID0gbnVsbDtcbiAgICAgIHRlc3RCb2FyZFs3XVs2XSA9IG51bGw7XG4gICAgICBjb25zdCBraW5nID0gdGVzdEJvYXJkWzddWzRdOyAvLyBEb24ndCBmb3JnZXQgdG8gZGVmaW5lIGtpbmdcbiAgICAgIFxuICAgICAgZXhwZWN0KGNhbkNhc3RsZSh0ZXN0Qm9hcmQsIGtpbmcsIHsgc2lkZTogJ2tpbmdzaWRlJywgcG9zOiB7IHJvdzogNywgY29sOiA0IH19KSkudG8uYmUudHJ1ZTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcHJldmVudCBjYXN0bGluZyB0aHJvdWdoIGF0dGFja2VkIHNxdWFyZXMnLCAoKSA9PiB7XG4gICAgICB0ZXN0Qm9hcmRbN11bNV0gPSBudWxsO1xuICAgICAgdGVzdEJvYXJkWzddWzZdID0gbnVsbDtcbiAgICAgIHRlc3RCb2FyZFs2XVs1XSA9IHsgdHlwZTogJ2Jpc2hvcCcsIGNvbG9yOiAnYmxhY2snLCBoYXNNb3ZlZDogdHJ1ZSB9O1xuICAgICAgY29uc3Qga2luZyA9IHRlc3RCb2FyZFs3XVs0XTsgLy8gRG9uJ3QgZm9yZ2V0IHRvIGRlZmluZSBraW5nXG4gICAgICBcbiAgICAgIGV4cGVjdChjYW5DYXN0bGUodGVzdEJvYXJkLCBraW5nLCB7IHNpZGU6ICdraW5nc2lkZScsIHBvczogeyByb3c6IDcsIGNvbDogNCB9fSkpLnRvLmJlLmZhbHNlO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnQm9hcmQgU3RhdGUgTWFuYWdlbWVudCcsICgpID0+IHtcbiAgICAvLyBpdCgnc2hvdWxkIGNsb25lIGJvYXJkIGNvcnJlY3RseScsICgpID0+IHtcbiAgICAvLyAgIGNvbnN0IGNsb25lZCA9IGNsb25lQm9hcmQodGVzdEJvYXJkKTtcbiAgICAvLyAgIGNsb25lZFswXVswXS5oYXNNb3ZlZCA9IHRydWU7XG4gICAgLy8gICBleHBlY3QodGVzdEJvYXJkWzBdWzBdLmhhc01vdmVkKS50by5iZS5mYWxzZTtcbiAgICAvLyB9KTtcblxuICAgIC8vIGl0KCdzaG91bGQgc2VyaWFsaXplIGJvYXJkIHN0YXRlJywgKCkgPT4ge1xuICAgIC8vICAgY29uc3Qgc2VyaWFsaXplZCA9IHNlcmlhbGl6ZUJvYXJkKHRlc3RCb2FyZCk7XG4gICAgLy8gICBleHBlY3Qoc2VyaWFsaXplZCkudG8uaW5jbHVkZSgncnd8YncnKTsgLy8gUm9vayB3aGl0ZSBhbmQgYmlzaG9wIHdoaXRlXG4gICAgLy8gfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdIZWxwZXIgRnVuY3Rpb25zJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaWRlbnRpZnkgb3Bwb25lbnQgY29sb3InLCAoKSA9PiB7XG4gICAgICB0ZXN0Qm9hcmQgPSBBcnJheSg4KS5maWxsKCkubWFwKCgpID0+IEFycmF5KDgpLmZpbGwobnVsbCkpO1xuICAgICAgZXhwZWN0KGdldE9wcG9uZW50KCd3aGl0ZScpKS50by5lcXVhbCgnYmxhY2snKTtcbiAgICAgIGV4cGVjdChnZXRPcHBvbmVudCgnYmxhY2snKSkudG8uZXF1YWwoJ3doaXRlJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHZhbGlkYXRlIGJvYXJkIGJvdW5kYXJpZXMnLCAoKSA9PiB7XG4gICAgICB0ZXN0Qm9hcmQgPSBBcnJheSg4KS5maWxsKCkubWFwKCgpID0+IEFycmF5KDgpLmZpbGwobnVsbCkpO1xuICAgICAgZXhwZWN0KGlzSW5Cb3VuZHMoNywgNykpLnRvLmJlLnRydWU7XG4gICAgICBleHBlY3QoaXNJbkJvdW5kcygtMSwgMykpLnRvLmJlLmZhbHNlO1xuICAgICAgZXhwZWN0KGlzSW5Cb3VuZHMoNCwgOCkpLnRvLmJlLmZhbHNlO1xuICAgIH0pO1xuXG4gICAgLy8gaXQoJ3Nob3VsZCBnZW5lcmF0ZSBhbGwgbGVnYWwgbW92ZXMnLCAoKSA9PiB7XG4gICAgLy8gICB0ZXN0Qm9hcmQgPSBBcnJheSg4KS5maWxsKCkubWFwKCgpID0+IEFycmF5KDgpLmZpbGwobnVsbCkpO1xuICAgIC8vICAgY29uc3QgaW5pdGlhbE1vdmVzID0gZ2VuZXJhdGVNb3Zlc0ZvclBpZWNlKHRlc3RCb2FyZCwgeyByb3c6IDYsIGNvbDogMCB9LCB0ZXN0Qm9hcmRbNl1bMF0pO1xuICAgIC8vICAgZXhwZWN0KGluaXRpYWxNb3ZlcykudG8uaGF2ZS5sZW5ndGhPZigyKTsgLy8gSW5pdGlhbCBwYXduIG1vdmVcbiAgICAvLyB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1NwZWNpYWwgTW92ZXMnLCAoKSA9PiB7XG4gICAgbGV0IHRlc3RCb2FyZDtcblxuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgICAgLy8gQ3JlYXRlIGZyZXNoIGJvYXJkIHdpdGggcHJvcGVyIGNhc3RsaW5nIHNldHVwXG4gICAgICB0ZXN0Qm9hcmQgPSBBcnJheSg4KS5maWxsKCkubWFwKCgpID0+IEFycmF5KDgpLmZpbGwobnVsbCkpO1xuICAgICAgdGVzdEJvYXJkWzddWzRdID0geyBcbiAgICAgICAgdHlwZTogJ2tpbmcnLCBcbiAgICAgICAgY29sb3I6ICd3aGl0ZScsIFxuICAgICAgICBoYXNNb3ZlZDogZmFsc2UgIC8vIENydWNpYWwgZm9yIGNhc3RsaW5nXG4gICAgICB9O1xuICAgICAgdGVzdEJvYXJkWzddWzddID0geyBcbiAgICAgICAgdHlwZTogJ3Jvb2snLCBcbiAgICAgICAgY29sb3I6ICd3aGl0ZScsIFxuICAgICAgICBoYXNNb3ZlZDogZmFsc2UgIC8vIENydWNpYWwgZm9yIGNhc3RsaW5nXG4gICAgICB9O1xuICAgICAgLy8gQ2xlYXIgdGhlIGNhc3RsaW5nIHBhdGhcbiAgICAgIHRlc3RCb2FyZFs3XVs1XSA9IG51bGw7XG4gICAgICB0ZXN0Qm9hcmRbN11bNl0gPSBudWxsO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBkZXRlY3QgZW4gcGFzc2FudCBtb3ZlcycsICgpID0+IHtcbiAgICAgIHRlc3RCb2FyZCA9IEFycmF5KDgpLmZpbGwoKS5tYXAoKCkgPT4gQXJyYXkoOCkuZmlsbChudWxsKSk7XG4gICAgICBjb25zdCBtb3ZlID0ge1xuICAgICAgICBwaWVjZTogeyB0eXBlOiAncGF3bicsIGNvbG9yOiAnYmxhY2snIH0sXG4gICAgICAgIGZyb206IHsgcm93OiAxLCBjb2w6IDMgfSxcbiAgICAgICAgdG86IHsgcm93OiAzLCBjb2w6IDMgfVxuICAgICAgfTtcbiAgICAgIGV4cGVjdChpc0VuUGFzc2FudE1vdmUobW92ZSkpLnRvLmJlLmZhbHNlOyAvLyBTaG91bGQgb25seSBiZSB0cnVlIGluIHNwZWNpZmljIGNvbnRleHRcbiAgICB9KTtcblxuICAvLyAgIGl0KCdzaG91bGQgZXhlY3V0ZSBjYXN0bGluZyBjb3JyZWN0bHknLCAoKSA9PiB7XG4gIC8vICAgY29uc3Qga2luZyA9IHRlc3RCb2FyZFs3XVs0XTtcbiAgLy8gICBjb25zdCBjYXN0bGVNb3ZlID0ge1xuICAvLyAgICAgZnJvbTogeyByb3c6IDcsIGNvbDogNCB9LFxuICAvLyAgICAgdG86IHsgcm93OiA3LCBjb2w6IDYgfSxcbiAgLy8gICAgIHBpZWNlOiBraW5nLFxuICAvLyAgICAgY2FzdGxlOiAna2luZ3NpZGUnXG4gIC8vICAgfTtcblxuICAvLyAgIHBlcmZvcm1DYXN0bGUoY2FzdGxlTW92ZSk7XG5cbiAgLy8gICAvLyBWZXJpZnkga2luZyBtb3ZlZFxuICAvLyAgIGV4cGVjdCh0ZXN0Qm9hcmRbN11bNl0pLnRvLmRlZXAuZXF1YWwoe1xuICAvLyAgICAgdHlwZTogJ2tpbmcnLFxuICAvLyAgICAgY29sb3I6ICd3aGl0ZScsXG4gIC8vICAgICBoYXNNb3ZlZDogdHJ1ZVxuICAvLyAgIH0pO1xuICAgIFxuICAvLyAgIC8vIFZlcmlmeSByb29rIG1vdmVkXG4gIC8vICAgZXhwZWN0KHRlc3RCb2FyZFs3XVs1XSkudG8uZGVlcC5lcXVhbCh7XG4gIC8vICAgICB0eXBlOiAncm9vaycsXG4gIC8vICAgICBjb2xvcjogJ3doaXRlJyxcbiAgLy8gICAgIGhhc01vdmVkOiB0cnVlXG4gIC8vICAgfSk7XG4gICAgXG4gIC8vICAgLy8gVmVyaWZ5IG9yaWdpbmFsIHBvc2l0aW9ucyBhcmUgZW1wdHlcbiAgLy8gICBleHBlY3QodGVzdEJvYXJkWzddWzRdKS50by5iZS5udWxsO1xuICAvLyAgIGV4cGVjdCh0ZXN0Qm9hcmRbN11bN10pLnRvLmJlLm51bGw7XG4gIC8vIH0pO1xufSk7XG59KTsiXSwibWFwcGluZ3MiOiI7O0FBQUEsTUFBTTtFQUFFQTtBQUFPLENBQUMsR0FBR0MsT0FBTyxDQUFDLE1BQU0sQ0FBQztBQUNsQyxJQUFJO0VBQ0ZDLE9BQU87RUFDUEMsaUJBQWlCO0VBQ2pCQyxpQkFBaUI7RUFDakJDLFdBQVc7RUFDWEMsZUFBZTtFQUNmQyxpQkFBaUI7RUFDakJDLGdCQUFnQjtFQUNoQkMsY0FBYztFQUNkQyxVQUFVO0VBQ1ZDLFdBQVc7RUFDWEMsVUFBVTtFQUNWQyxVQUFVO0VBQ1ZDLGFBQWE7RUFDYkMsU0FBUztFQUNUQyxlQUFlO0VBQ2ZDLHFCQUFxQjtFQUNyQkMsV0FBVztFQUNYQztBQUNGLENBQUMsR0FBR2xCLE9BQU8sQ0FBQyxtQkFBbUIsQ0FBQztBQUVoQ21CLFFBQVEsQ0FBQyxrQkFBa0IsRUFBRSxNQUFNO0VBQ2pDLElBQUlDLFNBQVM7RUFFYkMsTUFBTSxDQUFDLE1BQU07SUFDWDtJQUNBRCxTQUFTLEdBQUdFLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQ0MsSUFBSSxDQUFDLENBQUMsQ0FBQ0MsR0FBRyxDQUFDLE1BQU1GLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQ0MsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO0VBQzVELENBQUMsQ0FBQztFQUVGRSxVQUFVLENBQUMsTUFBTTtJQUNmTCxTQUFTLEdBQUdmLGVBQWUsQ0FBQyxDQUFDO0VBQy9CLENBQUMsQ0FBQztFQUVGYyxRQUFRLENBQUMseUJBQXlCLEVBQUUsTUFBTTtJQUN4Q08sRUFBRSxDQUFDLHlD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","map":{"version":3,"names":["expect","require","isPrime","generateRookMoves","generatePawnMoves","isLegalMove","initializeBoard","checkForCheckmate","isSquareAttacked","serializeBoard","cloneBoard","getOpponent","isInBounds","isKingSafe","performCastle","canCastle","isEnPassantMove","generateMovesForPiece","createPiece","enPassantTarget","describe","testBoard","before","Array","fill","map","beforeEach","it","to","be","true","false","type","color","hasMoved","friendlyMoves","row","col","enemyMoves","allowedDistances","Set","forEach","move","dx","Math","abs","from","dy","distance","has","pawn","moves","some","m","console","log","allMoves","generateAllMoves","length","legalMoves","filter","king","side","pos","equal","piece"],"sourceRoot":"/home/bayern/Chess_Temp/test/","sources":["game.test.js"],"sourcesContent":["const { expect } = require('chai');\nlet {\n  isPrime,\n  generateRookMoves,\n  generatePawnMoves,\n  isLegalMove,\n  initializeBoard,\n  checkForCheckmate,\n  isSquareAttacked,\n  serializeBoard,\n  cloneBoard,\n  getOpponent,\n  isInBounds,\n  isKingSafe,\n  performCastle,\n  canCastle,\n  isEnPassantMove,\n  generateMovesForPiece,\n  createPiece,\n  enPassantTarget\n} = require('../gameController');\n\ndescribe('Chess Game Tests', () => {\n  let testBoard;\n\n  before(() => {\n    // Create a fresh board with just the pieces we need for testing\n    testBoard = Array(8).fill().map(() => Array(8).fill(null));\n  });\n\n  beforeEach(() => {\n    testBoard = initializeBoard();\n  });\n\n  describe('Prime Number Validation', () => {\n    it('should identify prime numbers correctly', () => {\n      expect(isPrime(2)).to.be.true;\n      expect(isPrime(7)).to.be.true;\n      expect(isPrime(1)).to.be.false;\n      expect(isPrime(4)).to.be.false;\n      expect(isPrime(9)).to.be.false;\n    });\n  });\n\n  describe('Rook Movement', () => {\n    it('should only allow prime-numbered moves for all rooks', () => {\n      // Test both friendly and enemy rooks\n      testBoard = Array(8).fill().map(() => Array(8).fill(null));\n      \n      // Friendly rook (white)\n      testBoard[3][3] = { type: 'rook', color: 'white', hasMoved: false };\n      const friendlyMoves = generateRookMoves(testBoard, { row: 3, col: 3 }, testBoard[3][3]);\n      \n      // Enemy rook (black)\n      testBoard[4][4] = { type: 'rook', color: 'black', hasMoved: false };\n      const enemyMoves = generateRookMoves(testBoard, { row: 4, col: 4 }, testBoard[4][4]);\n      \n      const allowedDistances = new Set([2, 3, 5, 7]);\n      \n      // Verify both rooks follow prime movement rules\n      [...friendlyMoves, ...enemyMoves].forEach(move => {\n        const dx = Math.abs(move.to.col - move.from.col);\n        const dy = Math.abs(move.to.row - move.from.row);\n        const distance = dx + dy; // Since rook moves straight\n        expect(allowedDistances.has(distance)).to.be.true;\n      });\n    });\n  });\n\n  describe('Pawn Movement', () => {\n    let testBoard;\n  \n    beforeEach(() => {\n      testBoard = Array(8).fill().map(() => Array(8).fill(null));\n      enPassantTarget = null; // Reset enPassant target\n    });\n  \n    // it('should detect en passant opportunities', () => {\n    //   // Set up pawns\n    //   testBoard[3][3] = { type: 'pawn', color: 'white', hasMoved: true };\n    //   testBoard[3][4] = { type: 'pawn', color: 'black', hasMoved: true };\n  \n    //   // Simulate the double-step pawn move that creates en passant opportunity\n    //   const move = {\n    //     from: { row: 1, col: 4 },\n    //     to: { row: 3, col: 4 },\n    //     piece: testBoard[3][4],\n    //     color: 'black'\n    //   };\n      \n    //   // Update enPassantTarget as the game would\n    //   enPassantTarget = { row: 2, col: 4 };\n  \n    //   // Get white pawn's moves\n    //   const whitePawnMoves = generatePawnMoves(testBoard, { row: 3, col: 3 }, testBoard[3][3]);\n      \n    //   // Verify en passant move exists diagonally\n    //   expect(whitePawnMoves).to.deep.include({\n    //     from: { row: 3, col: 3 },\n    //     to: { row: 2, col: 4 },\n    //     piece: testBoard[3][3],\n    //     enPassant: true\n    //   });\n    // });\n  \n    it('should trigger promotion on last rank', () => {\n      const pawn = { type: 'pawn', color: 'white', hasMoved: true };\n      testBoard[1][0] = pawn;\n      \n      const moves = generatePawnMoves(testBoard, { row: 1, col: 0 }, pawn);\n      expect(moves.some(m => m.to.row === 0)).to.be.true;\n    });\n  });\n\n  describe('Check Detection', () => {\n    let testBoard;\n  \n    beforeEach(() => {\n      testBoard = Array(8).fill().map(() => Array(8).fill(null));\n    });\n  \n    it('should identify attacked squares', () => {\n      // Place black rook in same column as white king\n      testBoard[0][4] = createPiece('rook', 'black'); // Top of column 4\n      testBoard[4][4] = createPiece('king', 'white'); // Center king\n      \n      expect(isSquareAttacked(testBoard, { row: 4, col: 4 }, 'black')).to.be.true;\n    });\n  \n    it('should detect checkmate state', () => {\n      // Proper checkmate setup\n      testBoard[7][4] = createPiece('king', 'white'); // White king in corner\n      testBoard[6][3] = createPiece('queen', 'black'); // Queen attacking diagonally\n      testBoard[7][5] = createPiece('rook', 'black'); // Rook blocking escape\n      \n      // Debug checks\n      console.log(\"Is king safe:\", isKingSafe(testBoard, 'white'));\n      \n      const allMoves = generateAllMoves(testBoard, 'white');\n      console.log(\"All moves generated:\", allMoves.length);\n      \n      const legalMoves = allMoves.filter(m => isLegalMove(testBoard, m, 'white'));\n      console.log(\"Legal moves:\", legalMoves.length);\n      if (legalMoves.length > 0) {\n        console.log(\"Legal moves found:\", legalMoves);\n      }\n      \n      // Verify no legal moves\n      expect(checkForCheckmate(testBoard, 'white')).to.be.true;\n    });\n  });\n\n  describe('Castling', () => {\n    beforeEach(() => {\n      // Create fresh board with only necessary pieces\n      testBoard = Array(8).fill().map(() => Array(8).fill(null));\n      \n      // Set up castling scenario\n      testBoard[7][4] = createPiece('king', 'white');  // White king\n      testBoard[7][7] = createPiece('rook', 'white');  // Kingside rook\n    });\n\n    it('should allow kingside castling when valid', () => {\n      testBoard[7][5] = null;\n      testBoard[7][6] = null;\n      const king = testBoard[7][4]; // Don't forget to define king\n      \n      expect(canCastle(testBoard, king, { side: 'kingside', pos: { row: 7, col: 4 }})).to.be.true;\n    });\n\n    it('should prevent castling through attacked squares', () => {\n      testBoard[7][5] = null;\n      testBoard[7][6] = null;\n      testBoard[6][5] = { type: 'bishop', color: 'black', hasMoved: true };\n      const king = testBoard[7][4]; // Don't forget to define king\n      \n      expect(canCastle(testBoard, king, { side: 'kingside', pos: { row: 7, col: 4 }})).to.be.false;\n    });\n  });\n\n  describe('Board State Management', () => {\n    // it('should clone board correctly', () => {\n    //   const cloned = cloneBoard(testBoard);\n    //   cloned[0][0].hasMoved = true;\n    //   expect(testBoard[0][0].hasMoved).to.be.false;\n    // });\n\n    // it('should serialize board state', () => {\n    //   const serialized = serializeBoard(testBoard);\n    //   expect(serialized).to.include('rw|bw'); // Rook white and bishop white\n    // });\n  });\n\n  describe('Helper Functions', () => {\n    it('should identify opponent color', () => {\n      testBoard = Array(8).fill().map(() => Array(8).fill(null));\n      expect(getOpponent('white')).to.equal('black');\n      expect(getOpponent('black')).to.equal('white');\n    });\n\n    it('should validate board boundaries', () => {\n      testBoard = Array(8).fill().map(() => Array(8).fill(null));\n      expect(isInBounds(7, 7)).to.be.true;\n      expect(isInBounds(-1, 3)).to.be.false;\n      expect(isInBounds(4, 8)).to.be.false;\n    });\n\n    // it('should generate all legal moves', () => {\n    //   testBoard = Array(8).fill().map(() => Array(8).fill(null));\n    //   const initialMoves = generateMovesForPiece(testBoard, { row: 6, col: 0 }, testBoard[6][0]);\n    //   expect(initialMoves).to.have.lengthOf(2); // Initial pawn move\n    // });\n  });\n\n  describe('Special Moves', () => {\n    let testBoard;\n\n    beforeEach(() => {\n      // Create fresh board with proper castling setup\n      testBoard = Array(8).fill().map(() => Array(8).fill(null));\n      testBoard[7][4] = { \n        type: 'king', \n        color: 'white', \n        hasMoved: false  // Crucial for castling\n      };\n      testBoard[7][7] = { \n        type: 'rook', \n        color: 'white', \n        hasMoved: false  // Crucial for castling\n      };\n      // Clear the castling path\n      testBoard[7][5] = null;\n      testBoard[7][6] = null;\n    });\n\n    it('should detect en passant moves', () => {\n      testBoard = Array(8).fill().map(() => Array(8).fill(null));\n      const move = {\n        piece: { type: 'pawn', color: 'black' },\n        from: { row: 1, col: 3 },\n        to: { row: 3, col: 3 }\n      };\n      expect(isEnPassantMove(move)).to.be.false; // Should only be true in specific context\n    });\n\n  //   it('should execute castling correctly', () => {\n  //   const king = testBoard[7][4];\n  //   const castleMove = {\n  //     from: { row: 7, col: 4 },\n  //     to: { row: 7, col: 6 },\n  //     piece: king,\n  //     castle: 'kingside'\n  //   };\n\n  //   performCastle(castleMove);\n\n  //   // Verify king moved\n  //   expect(testBoard[7][6]).to.deep.equal({\n  //     type: 'king',\n  //     color: 'white',\n  //     hasMoved: true\n  //   });\n    \n  //   // Verify rook moved\n  //   expect(testBoard[7][5]).to.deep.equal({\n  //     type: 'rook',\n  //     color: 'white',\n  //     hasMoved: true\n  //   });\n    \n  //   // Verify original positions are empty\n  //   expect(testBoard[7][4]).to.be.null;\n  //   expect(testBoard[7][7]).to.be.null;\n  // });\n});\n});"],"mappings":"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","ignoreList":[]}},"mtime":1743349903602},"{\"assumptions\":{},\"sourceRoot\":\"/home/bayern/Chess_Temp/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/home/bayern/Chess_Temp\",\"filename\":\"/home/bayern/Chess_Temp/gameController.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/bayern/Chess_Temp\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"transform-duplicate-named-capturing-groups-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-regexp-modifiers\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-unicode-sets-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/bayern/Chess_Temp/node_modules/@babel/preset-env/lib/index.js$3\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/bayern/Chess_Temp/node_modules/@babel/preset-env/lib/index.js$4\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/bayern/Chess_Temp/node_modules/@babel/preset-env/lib/index.js$5\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/bayern/Chess_Temp/node_modules/@babel/preset-env/lib/index.js$6\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/bayern/Chess_Temp/node_modules/@babel/preset-env/lib/index.js$7\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/bayern/Chess_Temp/node_modules/@babel/preset-env/lib/index.js$8\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/bayern/Chess_Temp/node_modules/@babel/preset-env/lib/index.js$9\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/bayern/Chess_Temp/node_modules/@babel/preset-env/lib/index.js$10\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/bayern/Chess_Temp/node_modules/@babel/preset-env/lib/index.js$11\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/bayern/Chess_Temp/node_modules/@babel/preset-env/lib/index.js$12\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/bayern/Chess_Temp/node_modules/@babel/preset-env/lib/index.js$16\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"/home/bayern/Chess_Temp/node_modules/@babel/preset-env/lib/index.js$17\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.26.10:development":{"value":{"code":"\"use strict\";\n\n/* \n  Modified Chess Game with Prime Rook Moves, Menu, Chess Clock, and Advanced Rules:\n  - Friendly rooks can only move a prime number of squares (allowed: 2, 3, 5, or 7).\n  - Queen moves remain standard.\n  - All other rules (castling, en passant, pawn promotion, etc.) remain unchanged.\n*/\n\n/* ----- DOM ELEMENTS ----- */\nconst boardElement = document.getElementById(\"chessboard\");\nconst promotionModal = document.getElementById(\"promotionModal\");\nconst promotionChoices = document.querySelectorAll(\".promotionChoice\");\nconst startGameBtn = document.getElementById(\"startGame\");\nconst gameModeSelect = document.getElementById(\"gameMode\");\nconst whiteClockEl = document.getElementById(\"whiteClock\");\nconst blackClockEl = document.getElementById(\"blackClock\");\nconst menuScreen = document.getElementById(\"menuScreen\");\nconst gameScreen = document.getElementById(\"gameScreen\");\n\n/* ----- GAME STATE VARIABLES ----- */\nlet board = [];\nlet currentPlayer = \"white\";\nlet selectedPiece = null;\nlet selectedPos = null;\nlet moveHistory = [];\nlet boardHistory = [];\nlet fiftyMoveCounter = 0;\nlet enPassantTarget = null;\n\n/* ----- CLOCK VARIABLES ----- */\nlet whiteTime = 0;\nlet blackTime = 0;\nlet clockInterval = null;\n\n/* ----- DRAGGING STATE ----- */\nlet draggingPieceEl = null;\nlet dragOffset = {\n  x: 0,\n  y: 0\n};\nlet dragStartPos = null;\n\n/* ----- HELPER: Check if number is prime ----- */\nfunction isPrime(n) {\n  if (n < 2) return false;\n  for (let i = 2; i <= Math.sqrt(n); i++) {\n    if (n % i === 0) return false;\n  }\n  return true;\n}\n\n/* ----- CLOCK FUNCTIONS ----- */\nfunction startClock() {\n  clearInterval(clockInterval);\n  clockInterval = setInterval(() => {\n    if (currentPlayer === \"white\") {\n      whiteTime--;\n      if (whiteTime <= 0) {\n        clearInterval(clockInterval);\n        alert(\"Time's up! Black wins!\");\n        resetGame();\n        return;\n      }\n    } else {\n      blackTime--;\n      if (blackTime <= 0) {\n        clearInterval(clockInterval);\n        alert(\"Time's up! White wins!\");\n        resetGame();\n        return;\n      }\n    }\n    updateClockDisplay();\n  }, 1000);\n}\nfunction updateClockDisplay() {\n  whiteClockEl.innerText = formatTime(whiteTime);\n  blackClockEl.innerText = formatTime(blackTime);\n}\nfunction formatTime(seconds) {\n  let m = Math.floor(seconds / 60);\n  let s = seconds % 60;\n  return (m < 10 ? \"0\" + m : m) + \":\" + (s < 10 ? \"0\" + s : s);\n}\n\n/* ----- MENU AND GAME START ----- */\nstartGameBtn.addEventListener(\"click\", () => {\n  let initialTime = parseInt(gameModeSelect.value);\n  whiteTime = initialTime;\n  blackTime = initialTime;\n  updateClockDisplay();\n  menuScreen.style.display = \"none\";\n  gameScreen.style.display = \"block\";\n  initializeBoard();\n  startClock();\n});\n\n/* ----- INITIALIZATION ----- */\nfunction initializeBoard() {\n  board = Array(8).fill(null).map(() => Array(8).fill(null));\n  for (let i = 0; i < 8; i++) {\n    board[1][i] = createPiece(\"pawn\", \"black\");\n    board[6][i] = createPiece(\"pawn\", \"white\");\n  }\n  board[0][0] = createPiece(\"rook\", \"black\");\n  board[0][7] = createPiece(\"rook\", \"black\");\n  board[7][0] = createPiece(\"rook\", \"white\");\n  board[7][7] = createPiece(\"rook\", \"white\");\n  board[0][1] = createPiece(\"knight\", \"black\");\n  board[0][6] = createPiece(\"knight\", \"black\");\n  board[7][1] = createPiece(\"knight\", \"white\");\n  board[7][6] = createPiece(\"knight\", \"white\");\n  board[0][2] = createPiece(\"bishop\", \"black\");\n  board[0][5] = createPiece(\"bishop\", \"black\");\n  board[7][2] = createPiece(\"bishop\", \"white\");\n  board[7][5] = createPiece(\"bishop\", \"white\");\n  board[0][3] = createPiece(\"queen\", \"black\");\n  board[7][3] = createPiece(\"queen\", \"white\");\n  board[0][4] = createPiece(\"king\", \"black\");\n  board[7][4] = createPiece(\"king\", \"white\");\n  moveHistory = [];\n  boardHistory = [];\n  fiftyMoveCounter = 0;\n  enPassantTarget = null;\n  selectedPiece = null;\n  selectedPos = null;\n  currentPlayer = \"white\";\n  drawBoard();\n  updateBoardHistory();\n}\nfunction resetGame() {\n  clearInterval(clockInterval);\n  menuScreen.style.display = \"block\";\n  gameScreen.style.display = \"none\";\n  initializeBoard();\n}\n\n/* ----- PIECE CREATION ----- */\nfunction createPiece(type, color) {\n  return {\n    type,\n    color,\n    hasMoved: false\n  };\n}\n\n/* ----- DRAWING THE BOARD ----- */\nfunction drawBoard() {\n  boardElement.innerHTML = \"\";\n  for (let row = 0; row < 8; row++) {\n    for (let col = 0; col < 8; col++) {\n      let square = document.createElement(\"div\");\n      square.classList.add(\"square\");\n      square.dataset.row = row;\n      square.dataset.col = col;\n      square.classList.add((row + col) % 2 === 0 ? \"light\" : \"dark\");\n      if (selectedPos && selectedPos.row === row && selectedPos.col === col) {\n        square.classList.add(\"selected\");\n      }\n      if (board[row][col] && board[row][col].type === \"king\") {\n        if (isSquareAttacked(board, {\n          row,\n          col\n        }, getOpponent(board[row][col].color))) {\n          square.classList.add(\"in-check\");\n        }\n      }\n      if (board[row][col]) {\n        let pieceEl = document.createElement(\"img\");\n        pieceEl.classList.add(\"piece-img\", board[row][col].color, board[row][col].type);\n        pieceEl.src = getPieceImageSrc(board[row][col]);\n        pieceEl.alt = board[row][col].type;\n        pieceEl.addEventListener(\"mousedown\", onPieceMouseDown);\n        square.appendChild(pieceEl);\n      }\n      square.addEventListener(\"click\", onSquareClick);\n      boardElement.appendChild(square);\n    }\n  }\n}\nfunction getPieceImageSrc(piece) {\n  return `assets/${piece.color}_${piece.type}.png`;\n}\n\n/* ----- CLICK HANDLING ----- */\nfunction onSquareClick(e) {\n  if (draggingPieceEl) return;\n  const row = parseInt(e.currentTarget.dataset.row);\n  const col = parseInt(e.currentTarget.dataset.col);\n  if (board[row][col] && board[row][col].color === currentPlayer) {\n    selectedPiece = board[row][col];\n    selectedPos = {\n      row,\n      col\n    };\n  } else if (selectedPiece) {\n    let move = {\n      from: {\n        row: selectedPos.row,\n        col: selectedPos.col\n      },\n      to: {\n        row,\n        col\n      },\n      piece: selectedPiece\n    };\n    if (isLegalMove(board, move, currentPlayer)) {\n      makeMove(move);\n    } else {\n      console.log(\"Illegal move attempted:\", move);\n    }\n    selectedPiece = null;\n    selectedPos = null;\n  }\n  drawBoard();\n}\n\n/* ----- DRAG-TO-MOVE HANDLING ----- */\nfunction onPieceMouseDown(e) {\n  const square = e.target.parentElement;\n  const row = parseInt(square.dataset.row);\n  const col = parseInt(square.dataset.col);\n  if (board[row][col].color !== currentPlayer) return;\n  selectedPiece = board[row][col];\n  selectedPos = {\n    row,\n    col\n  };\n  dragStartPos = {\n    row,\n    col\n  };\n  draggingPieceEl = e.target.cloneNode(true);\n  draggingPieceEl.classList.add(\"dragging\");\n  document.body.appendChild(draggingPieceEl);\n  const rect = e.target.getBoundingClientRect();\n  dragOffset.x = e.clientX - rect.left;\n  dragOffset.y = e.clientY - rect.top;\n  drawBoard();\n  document.addEventListener(\"mousemove\", onMouseMove);\n  document.addEventListener(\"mouseup\", onMouseUp);\n}\nfunction onMouseMove(e) {\n  if (draggingPieceEl) {\n    draggingPieceEl.style.left = e.clientX - dragOffset.x + \"px\";\n    draggingPieceEl.style.top = e.clientY - dragOffset.y + \"px\";\n  }\n}\nfunction onMouseUp(e) {\n  if (!draggingPieceEl) return;\n  const boardRect = boardElement.getBoundingClientRect();\n  const x = e.clientX - boardRect.left;\n  const y = e.clientY - boardRect.top;\n  const col = Math.floor(x / 80);\n  const row = Math.floor(y / 80);\n  if (row >= 0 && row < 8 && col >= 0 && col < 8) {\n    let move = {\n      from: {\n        row: dragStartPos.row,\n        col: dragStartPos.col\n      },\n      to: {\n        row,\n        col\n      },\n      piece: selectedPiece\n    };\n    // Detect castling: if king moves two squares horizontally\n    if (move.piece.type === \"king\" && Math.abs(move.to.col - move.from.col) === 2) {\n      move.castle = move.to.col > move.from.col ? \"kingside\" : \"queenside\";\n    }\n    if (isLegalMove(board, move, currentPlayer)) {\n      makeMove(move);\n    } else {\n      console.log(\"Illegal move attempted via drag:\", move);\n    }\n  }\n  document.body.removeChild(draggingPieceEl);\n  draggingPieceEl = null;\n  dragStartPos = null;\n  selectedPiece = null;\n  selectedPos = null;\n  document.removeEventListener(\"mousemove\", onMouseMove);\n  document.removeEventListener(\"mouseup\", onMouseUp);\n  drawBoard();\n}\n\n/* ----- MAKING MOVES ----- */\nfunction makeMove(move) {\n  if (isCastlingMove(move)) {\n    performCastle(move);\n  } else if (isEnPassantMove(move)) {\n    performEnPassant(move);\n  } else {\n    board[move.to.row][move.to.col] = move.piece;\n    board[move.from.row][move.from.col] = null;\n    if (move.piece.type === \"pawn\" && isLastRank(move.to, move.piece.color)) {\n      showPromotionModal(move);\n      return;\n    }\n  }\n  move.piece.hasMoved = true;\n  handlePawnDoubleStep(move);\n  moveHistory.push(move);\n  updateFiftyMoveCounter(move);\n  updateBoardHistory();\n\n  // Switch turn. currentPlayer becomes the player who is about to move.\n  currentPlayer = getOpponent(currentPlayer);\n  startClock();\n\n  // FIXED: Check for checkmate on the current player's turn\n  if (checkForCheckmate(board, currentPlayer)) {\n    alert(\"Checkmate! \" + getOpponent(currentPlayer) + \" wins.\");\n    clearInterval(clockInterval);\n    resetGame();\n    return;\n  } else if (checkForStalemate(board, currentPlayer)) {\n    alert(\"Stalemate!\");\n    clearInterval(clockInterval);\n    resetGame();\n    return;\n  } else if (isThreefoldRepetition()) {\n    alert(\"Draw by threefold repetition!\");\n    clearInterval(clockInterval);\n    resetGame();\n    return;\n  } else if (isFiftyMoveRule()) {\n    alert(\"Draw by fifty-move rule!\");\n    clearInterval(clockInterval);\n    resetGame();\n    return;\n  }\n  selectedPiece = null;\n  selectedPos = null;\n  drawBoard();\n}\n\n/* ----- MOVE GENERATION ----- */\nfunction generateMovesForPiece(board, pos) {\n  let piece = board[pos.row][pos.col];\n  if (!piece) return [];\n  let moves = [];\n  switch (piece.type) {\n    case \"pawn\":\n      moves = generatePawnMoves(board, pos, piece);\n      break;\n    case \"rook\":\n      // Friendly rooks: restrict moves to prime number of squares.\n      moves = generateRookMoves(board, pos, piece);\n      break;\n    case \"knight\":\n      moves = generateKnightMoves(board, pos, piece);\n      break;\n    case \"bishop\":\n      moves = generateBishopMoves(board, pos, piece);\n      break;\n    case \"queen\":\n      // For queen, use default rook moves (no prime restriction) plus bishop moves.\n      moves = generateRookMovesDefault(board, pos, piece).concat(generateBishopMoves(board, pos, piece));\n      break;\n    case \"king\":\n      moves = generateKingMoves(board, pos, piece);\n      moves = moves.concat(generateCastlingMoves(board, pos, piece));\n      break;\n  }\n  return moves;\n}\nfunction generatePawnMoves(board, pos, piece) {\n  let moves = [];\n  let direction = piece.color === \"white\" ? -1 : 1;\n  let startRow = piece.color === \"white\" ? 6 : 1;\n  let nextRow = pos.row + direction;\n  if (isInBounds(nextRow, pos.col) && board[nextRow][pos.col] === null) {\n    moves.push({\n      from: pos,\n      to: {\n        row: nextRow,\n        col: pos.col\n      },\n      piece\n    });\n    if (pos.row === startRow && isInBounds(nextRow + direction, pos.col) && board[nextRow + direction][pos.col] === null) {\n      moves.push({\n        from: pos,\n        to: {\n          row: nextRow + direction,\n          col: pos.col\n        },\n        piece\n      });\n    }\n  }\n  for (let dc of [-1, 1]) {\n    let newCol = pos.col + dc;\n    if (isInBounds(nextRow, newCol)) {\n      if (board[nextRow][newCol] && board[nextRow][newCol].color !== piece.color) {\n        moves.push({\n          from: pos,\n          to: {\n            row: nextRow,\n            col: newCol\n          },\n          piece\n        });\n      }\n      if (board[nextRow][newCol] === null && enPassantTarget && enPassantTarget.row === nextRow && enPassantTarget.col === newCol) {\n        moves.push({\n          from: pos,\n          to: {\n            row: nextRow,\n            col: newCol\n          },\n          piece,\n          enPassant: true\n        });\n      }\n    }\n  }\n  return moves;\n}\n\n/* Modified Rook Moves: For friendly rooks, allow moves only if the number of squares moved is prime (2, 3, 5, or 7) */\nfunction generateRookMoves(board, pos, piece) {\n  let moves = [];\n  let directions = [[1, 0], [-1, 0], [0, 1], [0, -1]];\n  directions.forEach(d => {\n    let r = pos.row;\n    let c = pos.col;\n    let steps = 0;\n    while (true) {\n      r += d[0];\n      c += d[1];\n      steps++;\n      if (!isInBounds(r, c)) break;\n      if (isPrime(steps)) {\n        if (board[r][c] === null) {\n          moves.push({\n            from: pos,\n            to: {\n              row: r,\n              col: c\n            },\n            piece\n          });\n        } else {\n          if (board[r][c].color !== piece.color) {\n            moves.push({\n              from: pos,\n              to: {\n                row: r,\n                col: c\n              },\n              piece\n            });\n          }\n          break;\n        }\n      } else {\n        if (board[r][c] !== null) break;\n      }\n    }\n  });\n  return moves;\n}\n\n/* Default Rook Moves for queen moves and enemy attack detection (no prime restriction) */\nfunction generateRookMovesDefault(board, pos, piece) {\n  let moves = [];\n  let directions = [[1, 0], [-1, 0], [0, 1], [0, -1]];\n  directions.forEach(d => {\n    let r = pos.row;\n    let c = pos.col;\n    while (true) {\n      r += d[0];\n      c += d[1];\n      if (!isInBounds(r, c)) break;\n      if (board[r][c] === null) {\n        moves.push({\n          from: pos,\n          to: {\n            row: r,\n            col: c\n          },\n          piece\n        });\n      } else {\n        moves.push({\n          from: pos,\n          to: {\n            row: r,\n            col: c\n          },\n          piece\n        });\n        break;\n      }\n    }\n  });\n  return moves;\n}\nfunction generateKnightMoves(board, pos, piece) {\n  let moves = [];\n  let offsets = [[-2, -1], [-2, 1], [-1, -2], [-1, 2], [1, -2], [1, 2], [2, -1], [2, 1]];\n  offsets.forEach(o => {\n    let r = pos.row + o[0];\n    let c = pos.col + o[1];\n    if (isInBounds(r, c) && (!board[r][c] || board[r][c].color !== piece.color)) {\n      moves.push({\n        from: pos,\n        to: {\n          row: r,\n          col: c\n        },\n        piece\n      });\n    }\n  });\n  return moves;\n}\nfunction generateBishopMoves(board, pos, piece) {\n  let moves = [];\n  let directions = [[1, 1], [1, -1], [-1, 1], [-1, -1]];\n  directions.forEach(d => {\n    for (let steps = 1; steps < 8; steps++) {\n      let r = pos.row + d[0] * steps;\n      let c = pos.col + d[1] * steps;\n      if (!isInBounds(r, c)) break;\n\n      // Skip if destination is occupied by a friendly piece\n      let destSquare = board[r][c];\n      if (destSquare && destSquare.color === piece.color) continue;\n      let standardPathValid = true;\n      let modifiedPawnCount = 0;\n      let modifiedPathValid = true;\n\n      // Check standard path validity (all intermediate squares empty)\n      for (let s = 1; s < steps; s++) {\n        let currentR = pos.row + d[0] * s;\n        let currentC = pos.col + d[1] * s;\n        if (board[currentR][currentC] !== null) {\n          standardPathValid = false;\n          break;\n        }\n      }\n\n      // Check modified path validity (exactly one pawn in intermediate squares)\n      for (let s = 1; s < steps; s++) {\n        let currentR = pos.row + d[0] * s;\n        let currentC = pos.col + d[1] * s;\n        let square = board[currentR][currentC];\n        if (square) {\n          if (square.type === 'pawn') {\n            modifiedPawnCount++;\n            if (modifiedPawnCount > 1) {\n              modifiedPathValid = false;\n              break;\n            }\n          } else {\n            modifiedPathValid = false;\n            break;\n          }\n        }\n      }\n      modifiedPathValid = modifiedPathValid && modifiedPawnCount === 1;\n\n      // Add move if either path is valid\n      if (standardPathValid || modifiedPathValid) {\n        moves.push({\n          from: pos,\n          to: {\n            row: r,\n            col: c\n          },\n          piece\n        });\n      }\n    }\n  });\n  return moves;\n}\nfunction generateQueenMoves(board, pos, piece) {\n  // Queen moves = default rook moves (no prime restriction) + bishop moves\n  return generateRookMovesDefault(board, pos, piece).concat(generateBishopMoves(board, pos, piece));\n}\nfunction generateKingMoves(board, pos, piece) {\n  let moves = [];\n  for (let r = pos.row - 1; r <= pos.row + 1; r++) {\n    for (let c = pos.col - 1; c <= pos.col + 1; c++) {\n      if (r === pos.row && c === pos.col) continue;\n      if (isInBounds(r, c) && (!board[r][c] || board[r][c].color !== piece.color)) {\n        moves.push({\n          from: pos,\n          to: {\n            row: r,\n            col: c\n          },\n          piece\n        });\n      }\n    }\n  }\n  return moves;\n}\nfunction generateCastlingMoves(board, pos, king) {\n  let moves = [];\n  if (king.hasMoved) return moves;\n  if (canCastle(board, king, {\n    side: \"kingside\",\n    pos\n  })) {\n    moves.push({\n      from: pos,\n      to: {\n        row: pos.row,\n        col: pos.col + 2\n      },\n      piece: king,\n      castle: \"kingside\"\n    });\n  }\n  if (canCastle(board, king, {\n    side: \"queenside\",\n    pos\n  })) {\n    moves.push({\n      from: pos,\n      to: {\n        row: pos.row,\n        col: pos.col - 2\n      },\n      piece: king,\n      castle: \"queenside\"\n    });\n  }\n  return moves;\n}\n\n/* ----- CASTLING LOGIC ----- */\nfunction canCastle(board, king, {\n  side,\n  pos\n}) {\n  let row = pos.row;\n  if (king.hasMoved) return false;\n  if (side === \"kingside\") {\n    let rook = board[row][7];\n    if (!rook || rook.type !== \"rook\" || rook.hasMoved) return false;\n    if (board[row][5] !== null || board[row][6] !== null) return false;\n    if (!isSquareSafeForKing(board, {\n      row,\n      col: 4\n    }, king.color) || !isSquareSafeForKing(board, {\n      row,\n      col: 5\n    }, king.color) || !isSquareSafeForKing(board, {\n      row,\n      col: 6\n    }, king.color)) return false;\n    return true;\n  } else if (side === \"queenside\") {\n    let rook = board[row][0];\n    if (!rook || rook.type !== \"rook\" || rook.hasMoved) return false;\n    if (board[row][1] !== null || board[row][2] !== null || board[row][3] !== null) return false;\n    if (!isSquareSafeForKing(board, {\n      row,\n      col: 4\n    }, king.color) || !isSquareSafeForKing(board, {\n      row,\n      col: 3\n    }, king.color) || !isSquareSafeForKing(board, {\n      row,\n      col: 2\n    }, king.color)) return false;\n    return true;\n  }\n  return false;\n}\nfunction isSquareSafeForKing(board, pos, color) {\n  let tempBoard = cloneBoard(board);\n  tempBoard[pos.row][pos.col] = {\n    type: \"king\",\n    color,\n    hasMoved: true\n  };\n  return isKingSafe(tempBoard, color);\n}\n\n/* ----- HELPER FUNCTIONS ----- */\nfunction isInBounds(row, col) {\n  return row >= 0 && row < 8 && col >= 0 && col < 8;\n}\nfunction cloneBoard(board) {\n  return board.map(row => row.map(cell => cell ? {\n    ...cell\n  } : null));\n}\nfunction isKingSafe(board, color) {\n  let kingPos = findKing(board, color);\n  if (!kingPos) return false;\n  return !isSquareAttacked(board, kingPos, getOpponent(color));\n}\nfunction findKing(board, color) {\n  for (let r = 0; r < 8; r++) {\n    for (let c = 0; c < 8; c++) {\n      let piece = board[r][c];\n      if (piece && piece.type === \"king\" && piece.color === color) {\n        return {\n          row: r,\n          col: c\n        };\n      }\n    }\n  }\n  return null;\n}\nfunction isSquareAttacked(board, pos, attackerColor) {\n  for (let r = 0; r < 8; r++) {\n    for (let c = 0; c < 8; c++) {\n      let piece = board[r][c];\n      if (piece && piece.color === attackerColor) {\n        let moves;\n        if (piece.type === \"rook\") {\n          // For enemy rooks, use full-range moves (default) for attack detection.\n          moves = generateRookMovesDefault(board, {\n            row: r,\n            col: c\n          }, piece);\n        } else {\n          moves = generateMovesForPiece(board, {\n            row: r,\n            col: c\n          });\n        }\n        for (let move of moves) {\n          if (move.to.row === pos.row && move.to.col === pos.col) return true;\n        }\n      }\n    }\n  }\n  return false;\n}\nfunction getOpponent(color) {\n  return color === \"white\" ? \"black\" : \"white\";\n}\n\n/* ----- EN PASSANT LOGIC ----- */\nfunction handlePawnDoubleStep(move) {\n  if (move.piece.type === \"pawn\" && Math.abs(move.from.row - move.to.row) === 2) {\n    enPassantTarget = {\n      row: (move.from.row + move.to.row) / 2,\n      col: move.from.col\n    };\n  } else {\n    enPassantTarget = null;\n  }\n}\nfunction isEnPassantMove(move) {\n  return move.piece.type === \"pawn\" && move.from.col !== move.to.col && board[move.to.row][move.to.col] === null;\n}\nfunction performEnPassant(move) {\n  board[move.to.row][move.to.col] = move.piece;\n  board[move.from.row][move.from.col] = null;\n  let captureRow = move.piece.color === \"white\" ? move.to.row + 1 : move.to.row - 1;\n  board[captureRow][move.to.col] = null;\n}\n\n/* ----- CASTLING HANDLING ----- */\nfunction isCastlingMove(move) {\n  return move.piece.type === \"king\" && Math.abs(move.to.col - move.from.col) === 2;\n}\nfunction performCastle(move) {\n  let row = move.from.row;\n  if (move.castle === \"kingside\") {\n    board[row][6] = move.piece;\n    board[row][4] = null;\n    let rook = board[row][7];\n    board[row][5] = rook;\n    board[row][7] = null;\n    rook.hasMoved = true;\n  } else if (move.castle === \"queenside\") {\n    board[row][2] = move.piece;\n    board[row][4] = null;\n    let rook = board[row][0];\n    board[row][3] = rook;\n    board[row][0] = null;\n    rook.hasMoved = true;\n  }\n}\n\n/* ----- PAWN PROMOTION ----- */\nfunction isLastRank(pos, color) {\n  return color === \"white\" && pos.row === 0 || color === \"black\" && pos.row === 7;\n}\nfunction showPromotionModal(move) {\n  promotionModal.style.display = \"block\";\n  promotionModal.dataset.fromRow = move.from.row;\n  promotionModal.dataset.fromCol = move.from.col;\n  promotionModal.dataset.toRow = move.to.row;\n  promotionModal.dataset.toCol = move.to.col;\n  promotionModal.dataset.color = move.piece.color;\n  promotionModal.dataset.pieceType = move.piece.type;\n}\npromotionChoices.forEach(choice => {\n  choice.addEventListener(\"click\", function () {\n    let selectedType = this.dataset.type;\n    let move = {\n      from: {\n        row: parseInt(promotionModal.dataset.fromRow),\n        col: parseInt(promotionModal.dataset.fromCol)\n      },\n      to: {\n        row: parseInt(promotionModal.dataset.toRow),\n        col: parseInt(promotionModal.dataset.toCol)\n      },\n      piece: {\n        type: promotionModal.dataset.pieceType,\n        color: promotionModal.dataset.color\n      }\n    };\n    board[move.to.row][move.to.col] = createPiece(selectedType, move.piece.color);\n    board[move.from.row][move.from.col] = null;\n    promotionModal.style.display = \"none\";\n    board[move.to.row][move.to.col].hasMoved = true;\n    moveHistory.push(move);\n    updateFiftyMoveCounter(move);\n    updateBoardHistory();\n    if (checkForCheckmate(board, getOpponent(currentPlayer))) {\n      alert(\"Checkmate! \" + getOpponent(currentPlayer) + \" wins.\");\n      clearInterval(clockInterval);\n      resetGame();\n      return;\n    } else if (checkForStalemate(board, getOpponent(currentPlayer))) {\n      alert(\"Stalemate!\");\n      clearInterval(clockInterval);\n      resetGame();\n      return;\n    }\n    currentPlayer = getOpponent(currentPlayer);\n    startClock();\n    selectedPiece = null;\n    selectedPos = null;\n    drawBoard();\n  });\n});\n\n/* ----- BOARD HISTORY & DRAWING RULES ----- */\nfunction serializeBoard(board) {\n  return board.map(row => row.map(cell => cell ? cell.type[0] + cell.color[0] : \"  \").join(\"\")).join(\"|\");\n}\nfunction updateBoardHistory() {\n  boardHistory.push(serializeBoard(board));\n}\nfunction isThreefoldRepetition() {\n  let counts = {};\n  boardHistory.forEach(state => {\n    counts[state] = (counts[state] || 0) + 1;\n  });\n  return Object.values(counts).some(count => count >= 3);\n}\nfunction updateFiftyMoveCounter(move) {\n  if (move.piece.type === \"pawn\" || board[move.to.row][move.to.col] !== null) {\n    fiftyMoveCounter = 0;\n  } else {\n    fiftyMoveCounter++;\n  }\n}\nfunction isFiftyMoveRule() {\n  return fiftyMoveCounter >= 50;\n}\n\n/* ----- CHECKMATE & STALEMATE ----- */\n// Checkmate: the current player's king is in check and has no legal moves.\nfunction checkForCheckmate(board, color) {\n  if (!isKingSafe(board, color)) {\n    let moves = generateAllMoves(board, color);\n    let legalMoves = moves.filter(m => isLegalMove(board, m, color));\n    if (legalMoves.length === 0) {\n      console.log(\"Checkmate detected for\", color);\n      return true;\n    }\n  }\n  return false;\n}\nfunction checkForStalemate(board, color) {\n  if (isKingSafe(board, color)) {\n    let moves = generateAllMoves(board, color);\n    let legalMoves = moves.filter(m => isLegalMove(board, m, color));\n    if (legalMoves.length === 0) return true;\n  }\n  return false;\n}\nfunction generateAllMoves(board, color) {\n  let moves = [];\n  for (let r = 0; r < 8; r++) {\n    for (let c = 0; c < 8; c++) {\n      let piece = board[r][c];\n      if (piece && piece.color === color) {\n        moves = moves.concat(generateMovesForPiece(board, {\n          row: r,\n          col: c\n        }));\n      }\n    }\n  }\n  return moves;\n}\n\n/* ----- MOVE VALIDATION ----- */\nfunction isLegalMove(board, move, color) {\n  let moves = generateMovesForPiece(board, move.from);\n  let legal = moves.some(m => m.to.row === move.to.row && m.to.col === move.to.col);\n  if (!legal) {\n    console.log(\"Move not in generated moves:\", move);\n    return false;\n  }\n  let newBoard = cloneBoard(board);\n  newBoard[move.to.row][move.to.col] = newBoard[move.from.row][move.from.col];\n  newBoard[move.from.row][move.from.col] = null;\n  let kingPos = findKing(newBoard, color);\n  if (!kingPos) {\n    console.log(\"King not found after move:\", move);\n    return false;\n  }\n  if (!isKingSafe(newBoard, color)) {\n    console.log(\"King would be in check after move:\", move, \"King at:\", kingPos);\n    return false;\n  }\n  return true;\n}\n\n/* ----- END GAME INITIALIZATION ----- */\n// Only initialize if running in browser\nif (typeof process === 'undefined' || !process.env.NODE_ENV === 'test') {\n  initializeBoard();\n}\n\n// Export for Jest testing while maintaining browser compatibility\nif (typeof module !== 'undefined' && module.exports) {\n  module.exports = {\n    isPrime,\n    generateRookMoves,\n    generatePawnMoves,\n    isLegalMove,\n    initializeBoard,\n    checkForCheckmate,\n    isSquareAttacked,\n    serializeBoard,\n    cloneBoard,\n    getOpponent,\n    performCastle,\n    canCastle,\n    isEnPassantMove,\n    generateMovesForPiece,\n    isInBounds,\n    isKingSafe,\n    createPiece,\n    enPassantTarget\n  };\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJib2FyZEVsZW1lbnQiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwicHJvbW90aW9uTW9kYWwiLCJwcm9tb3Rpb25DaG9pY2VzIiwicXVlcnlTZWxlY3RvckFsbCIsInN0YXJ0R2FtZUJ0biIsImdhbWVNb2RlU2VsZWN0Iiwid2hpdGVDbG9ja0VsIiwiYmxhY2tDbG9ja0VsIiwibWVudVNjcmVlbiIsImdhbWVTY3JlZW4iLCJib2FyZCIsImN1cnJlbnRQbGF5ZXIiLCJzZWxlY3RlZFBpZWNlIiwic2VsZWN0ZWRQb3MiLCJtb3ZlSGlzdG9yeSIsImJvYXJkSGlzdG9yeSIsImZpZnR5TW92ZUNvdW50ZXIiLCJlblBhc3NhbnRUYXJnZXQiLCJ3aGl0ZVRpbWUiLCJibGFja1RpbWUiLCJjbG9ja0ludGVydmFsIiwiZHJhZ2dpbmdQaWVjZUVsIiwiZHJhZ09mZnNldCIsIngiLCJ5IiwiZHJhZ1N0YXJ0UG9zIiwiaXNQcmltZSIsIm4iLCJpIiwiTWF0aCIsInNxcnQiLCJzdGFydENsb2NrIiwiY2xlYXJJbnRlcnZhbCIsInNldEludGVydmFsIiwiYWxlcnQiLCJyZXNldEdhbWUiLCJ1cGRhdGVDbG9ja0Rpc3BsYXkiLCJpbm5lclRleHQiLCJmb3JtYXRUaW1lIiwic2Vjb25kcyIsIm0iLCJmbG9vciIsInMiLCJhZGRFdmVudExpc3RlbmVyIiwiaW5pdGlhbFRpbWUiLCJwYXJzZUludCIsInZhbHVlIiwic3R5bGUiLCJkaXNwbGF5IiwiaW5pdGlhbGl6ZUJvYXJkIiwiQXJyYXkiLCJmaWxsIiwibWFwIiwiY3JlYXRlUGllY2UiLCJkcmF3Qm9hcmQiLCJ1cGRhdGVCb2FyZEhpc3RvcnkiLCJ0eXBlIiwiY29sb3IiLCJoYXNNb3ZlZCIsImlubmVySFRNTCIsInJvdyIsImNvbCIsInNxdWFyZSIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc0xpc3QiLCJhZGQiLCJkYXRhc2V0IiwiaXNTcXVhcmVBdHRhY2tlZCIsImdldE9wcG9uZW50IiwicGllY2VFbCIsInNyYyIsImdldFBpZWNlSW1hZ2VTcmMiLCJhbHQiLCJvblBpZWNlTW91c2VEb3duIiwiYXBwZW5kQ2hpbGQiLCJvblNxdWFyZUNsaWNrIiwicGllY2UiLCJlIiwiY3VycmVudFRhcmdldCIsIm1vdmUiLCJmcm9tIiwidG8iLCJpc0xlZ2FsTW92ZSIsIm1ha2VNb3ZlIiwiY29uc29sZSIsImxvZyIsInRhcmdldCIsInBhcmVudEVsZW1lbnQiLCJjbG9uZU5vZGUiLCJib2R5IiwicmVjdCIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsImNsaWVudFgiLCJsZWZ0IiwiY2xpZW50WSIsInRvcCIsIm9uTW91c2VNb3ZlIiwib25Nb3VzZVVwIiwiYm9hcmRSZWN0IiwiYWJzIiwiY2FzdGxlIiwicmVtb3ZlQ2hpbGQiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiaXNDYXN0bGluZ01vdmUiLCJwZXJmb3JtQ2FzdGxlIiwiaXNFblBhc3NhbnRNb3ZlIiwicGVyZm9ybUVuUGFzc2FudCIsImlzTGFzdFJhbmsiLCJzaG93UHJvbW90aW9uTW9kYWwiLCJoYW5kbGVQYXduRG91YmxlU3RlcCIsInB1c2giLCJ1cGRhdGVGaWZ0eU1vdmVDb3VudGVyIiwiY2hlY2tGb3JDaGVja21hdGUiLCJjaGVja0ZvclN0YWxlbWF0ZSIsImlzVGhyZWVmb2xkUmVwZXRpdGlvbiIsImlzRmlmdHlNb3ZlUnVsZSIsImdlbmVyYXRlTW92ZXNGb3JQaWVjZSIsInBvcyIsIm1vdmVzIiwiZ2VuZXJhdGVQYXduTW92ZXMiLCJnZW5lcmF0ZVJvb2tNb3ZlcyIsImdlbmVyYXRlS25pZ2h0TW92ZXMiLCJnZW5lcmF0ZUJpc2hvcE1vdmVzIiwiZ2VuZXJhdGVSb29rTW92ZXNEZWZhdWx0IiwiY29uY2F0IiwiZ2VuZXJhdGVLaW5nTW92ZXMiLCJnZW5lcmF0ZUNhc3RsaW5nTW92ZXMiLCJkaXJlY3Rpb24iLCJzdGFydFJvdyIsIm5leHRSb3ciLCJpc0luQm91bmRzIiwiZGMiLCJuZXdDb2wiLCJlblBhc3NhbnQiLCJkaXJlY3Rpb25zIiwiZm9yRWFjaCIsImQiLCJyIiwiYyIsInN0ZXBzIiwib2Zmc2V0cyIsIm8iLCJkZXN0U3F1YXJlIiwic3RhbmRhcmRQYXRoVmFsaWQiLCJtb2RpZmllZFBhd25Db3VudCIsIm1vZGlmaWVkUGF0aFZhbGlkIiwiY3VycmVudFIiLCJjdXJyZW50QyIsImdlbmVyYXRlUXVlZW5Nb3ZlcyIsImtpbmciLCJjYW5DYXN0bGUiLCJzaWRlIiwicm9vayIsImlzU3F1YXJlU2FmZUZvcktpbmciLCJ0ZW1wQm9hcmQiLCJjbG9uZUJvYXJkIiwiaXNLaW5nU2FmZSIsImNlbGwiLCJraW5nUG9zIiwiZmluZEtpbmciLCJhdHRhY2tlckNvbG9yIiwiY2FwdHVyZVJvdyIsImZyb21Sb3ciLCJmcm9tQ29sIiwidG9Sb3ciLCJ0b0NvbCIsInBpZWNlVHlwZSIsImNob2ljZSIsInNlbGVjdGVkVHlwZSIsInNlcmlhbGl6ZUJvYXJkIiwiam9pbiIsImNvdW50cyIsInN0YXRlIiwiT2JqZWN0IiwidmFsdWVzIiwic29tZSIsImNvdW50IiwiZ2VuZXJhdGVBbGxNb3ZlcyIsImxlZ2FsTW92ZXMiLCJmaWx0ZXIiLCJsZW5ndGgiLCJsZWdhbCIsIm5ld0JvYXJkIiwicHJvY2VzcyIsImVudiIsIk5PREVfRU5WIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL2hvbWUvYmF5ZXJuL0NoZXNzX1RlbXAvIiwic291cmNlcyI6WyJnYW1lQ29udHJvbGxlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKiBcbiAgTW9kaWZpZWQgQ2hlc3MgR2FtZSB3aXRoIFByaW1lIFJvb2sgTW92ZXMsIE1lbnUsIENoZXNzIENsb2NrLCBhbmQgQWR2YW5jZWQgUnVsZXM6XG4gIC0gRnJpZW5kbHkgcm9va3MgY2FuIG9ubHkgbW92ZSBhIHByaW1lIG51bWJlciBvZiBzcXVhcmVzIChhbGxvd2VkOiAyLCAzLCA1LCBvciA3KS5cbiAgLSBRdWVlbiBtb3ZlcyByZW1haW4gc3RhbmRhcmQuXG4gIC0gQWxsIG90aGVyIHJ1bGVzIChjYXN0bGluZywgZW4gcGFzc2FudCwgcGF3biBwcm9tb3Rpb24sIGV0Yy4pIHJlbWFpbiB1bmNoYW5nZWQuXG4qL1xuXG4vKiAtLS0tLSBET00gRUxFTUVOVFMgLS0tLS0gKi9cbmNvbnN0IGJvYXJkRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY2hlc3Nib2FyZFwiKTtcbmNvbnN0IHByb21vdGlvbk1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwcm9tb3Rpb25Nb2RhbFwiKTtcbmNvbnN0IHByb21vdGlvbkNob2ljZXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnByb21vdGlvbkNob2ljZVwiKTtcbmNvbnN0IHN0YXJ0R2FtZUJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic3RhcnRHYW1lXCIpO1xuY29uc3QgZ2FtZU1vZGVTZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImdhbWVNb2RlXCIpO1xuY29uc3Qgd2hpdGVDbG9ja0VsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ3aGl0ZUNsb2NrXCIpO1xuY29uc3QgYmxhY2tDbG9ja0VsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJibGFja0Nsb2NrXCIpO1xuY29uc3QgbWVudVNjcmVlbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibWVudVNjcmVlblwiKTtcbmNvbnN0IGdhbWVTY3JlZW4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImdhbWVTY3JlZW5cIik7XG5cbi8qIC0tLS0tIEdBTUUgU1RBVEUgVkFSSUFCTEVTIC0tLS0tICovXG5sZXQgYm9hcmQgPSBbXTtcbmxldCBjdXJyZW50UGxheWVyID0gXCJ3aGl0ZVwiO1xubGV0IHNlbGVjdGVkUGllY2UgPSBudWxsO1xubGV0IHNlbGVjdGVkUG9zID0gbnVsbDtcbmxldCBtb3ZlSGlzdG9yeSA9IFtdO1xubGV0IGJvYXJkSGlzdG9yeSA9IFtdO1xubGV0IGZpZnR5TW92ZUNvdW50ZXIgPSAwO1xubGV0IGVuUGFzc2FudFRhcmdldCA9IG51bGw7XG5cbi8qIC0tLS0tIENMT0NLIFZBUklBQkxFUyAtLS0tLSAqL1xubGV0IHdoaXRlVGltZSA9IDA7XG5sZXQgYmxhY2tUaW1lID0gMDtcbmxldCBjbG9ja0ludGVydmFsID0gbnVsbDtcblxuLyogLS0tLS0gRFJBR0dJTkcgU1RBVEUgLS0tLS0gKi9cbmxldCBkcmFnZ2luZ1BpZWNlRWwgPSBudWxsO1xubGV0IGRyYWdPZmZzZXQgPSB7IHg6IDAsIHk6IDAgfTtcbmxldCBkcmFnU3RhcnRQb3MgPSBudWxsO1xuXG4vKiAtLS0tLSBIRUxQRVI6IENoZWNrIGlmIG51bWJlciBpcyBwcmltZSAtLS0tLSAqL1xuZnVuY3Rpb24gaXNQcmltZShuKSB7XG4gIGlmIChuIDwgMikgcmV0dXJuIGZhbHNlO1xuICBmb3IgKGxldCBpID0gMjsgaSA8PSBNYXRoLnNxcnQobik7IGkrKykge1xuICAgIGlmIChuICUgaSA9PT0gMCkgcmV0dXJuIGZhbHNlO1xuICB9XG4gIHJldHVybiB0cnVlO1xufVxuXG4vKiAtLS0tLSBDTE9DSyBGVU5DVElPTlMgLS0tLS0gKi9cbmZ1bmN0aW9uIHN0YXJ0Q2xvY2soKSB7XG4gIGNsZWFySW50ZXJ2YWwoY2xvY2tJbnRlcnZhbCk7XG4gIGNsb2NrSW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgaWYgKGN1cnJlbnRQbGF5ZXIgPT09IFwid2hpdGVcIikge1xuICAgICAgd2hpdGVUaW1lLS07XG4gICAgICBpZiAod2hpdGVUaW1lIDw9IDApIHtcbiAgICAgICAgY2xlYXJJbnRlcnZhbChjbG9ja0ludGVydmFsKTtcbiAgICAgICAgYWxlcnQoXCJUaW1lJ3MgdXAhIEJsYWNrIHdpbnMhXCIpO1xuICAgICAgICByZXNldEdhbWUoKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBibGFja1RpbWUtLTtcbiAgICAgIGlmIChibGFja1RpbWUgPD0gMCkge1xuICAgICAgICBjbGVhckludGVydmFsKGNsb2NrSW50ZXJ2YWwpO1xuICAgICAgICBhbGVydChcIlRpbWUncyB1cCEgV2hpdGUgd2lucyFcIik7XG4gICAgICAgIHJlc2V0R2FtZSgpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgfVxuICAgIHVwZGF0ZUNsb2NrRGlzcGxheSgpO1xuICB9LCAxMDAwKTtcbn1cblxuZnVuY3Rpb24gdXBkYXRlQ2xvY2tEaXNwbGF5KCkge1xuICB3aGl0ZUNsb2NrRWwuaW5uZXJUZXh0ID0gZm9ybWF0VGltZSh3aGl0ZVRpbWUpO1xuICBibGFja0Nsb2NrRWwuaW5uZXJUZXh0ID0gZm9ybWF0VGltZShibGFja1RpbWUpO1xufVxuXG5mdW5jdGlvbiBmb3JtYXRUaW1lKHNlY29uZHMpIHtcbiAgbGV0IG0gPSBNYXRoLmZsb29yKHNlY29uZHMgLyA2MCk7XG4gIGxldCBzID0gc2Vjb25kcyAlIDYwO1xuICByZXR1cm4gKG0gPCAxMCA/IFwiMFwiICsgbSA6IG0pICsgXCI6XCIgKyAocyA8IDEwID8gXCIwXCIgKyBzIDogcyk7XG59XG5cbi8qIC0tLS0tIE1FTlUgQU5EIEdBTUUgU1RBUlQgLS0tLS0gKi9cbnN0YXJ0R2FtZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBsZXQgaW5pdGlhbFRpbWUgPSBwYXJzZUludChnYW1lTW9kZVNlbGVjdC52YWx1ZSk7XG4gIHdoaXRlVGltZSA9IGluaXRpYWxUaW1lO1xuICBibGFja1RpbWUgPSBpbml0aWFsVGltZTtcbiAgdXBkYXRlQ2xvY2tEaXNwbGF5KCk7XG4gIG1lbnVTY3JlZW4uc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuICBnYW1lU2NyZWVuLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XG4gIGluaXRpYWxpemVCb2FyZCgpO1xuICBzdGFydENsb2NrKCk7XG59KTtcblxuLyogLS0tLS0gSU5JVElBTElaQVRJT04gLS0tLS0gKi9cbmZ1bmN0aW9uIGluaXRpYWxpemVCb2FyZCgpIHtcbiAgYm9hcmQgPSBBcnJheSg4KVxuICAgIC5maWxsKG51bGwpXG4gICAgLm1hcCgoKSA9PiBBcnJheSg4KS5maWxsKG51bGwpKTtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCA4OyBpKyspIHtcbiAgICBib2FyZFsxXVtpXSA9IGNyZWF0ZVBpZWNlKFwicGF3blwiLCBcImJsYWNrXCIpO1xuICAgIGJvYXJkWzZdW2ldID0gY3JlYXRlUGllY2UoXCJwYXduXCIsIFwid2hpdGVcIik7XG4gIH1cbiAgYm9hcmRbMF1bMF0gPSBjcmVhdGVQaWVjZShcInJvb2tcIiwgXCJibGFja1wiKTtcbiAgYm9hcmRbMF1bN10gPSBjcmVhdGVQaWVjZShcInJvb2tcIiwgXCJibGFja1wiKTtcbiAgYm9hcmRbN11bMF0gPSBjcmVhdGVQaWVjZShcInJvb2tcIiwgXCJ3aGl0ZVwiKTtcbiAgYm9hcmRbN11bN10gPSBjcmVhdGVQaWVjZShcInJvb2tcIiwgXCJ3aGl0ZVwiKTtcbiAgYm9hcmRbMF1bMV0gPSBjcmVhdGVQaWVjZShcImtuaWdodFwiLCBcImJsYWNrXCIpO1xuICBib2FyZFswXVs2XSA9IGNyZWF0ZVBpZWNlKFwia25pZ2h0XCIsIFwiYmxhY2tcIik7XG4gIGJvYXJkWzddWzFdID0gY3JlYXRlUGllY2UoXCJrbmlnaHRcIiwgXCJ3aGl0ZVwiKTtcbiAgYm9hcmRbN11bNl0gPSBjcmVhdGVQaWVjZShcImtuaWdodFwiLCBcIndoaXRlXCIpO1xuICBib2FyZFswXVsyXSA9IGNyZWF0ZVBpZWNlKFwiYmlzaG9wXCIsIFwiYmxhY2tcIik7XG4gIGJvYXJkWzBdWzVdID0gY3JlYXRlUGllY2UoXCJiaXNob3BcIiwgXCJibGFja1wiKTtcbiAgYm9hcmRbN11bMl0gPSBjcmVhdGVQaWVjZShcImJpc2hvcFwiLCBcIndoaXRlXCIpO1xuICBib2FyZFs3XVs1XSA9IGNyZWF0ZVBpZWNlKFwiYmlzaG9wXCIsIFwid2hpdGVcIik7XG4gIGJvYXJkWzBdWzNdID0gY3JlYXRlUGllY2UoXCJxdWVlblwiLCBcImJsYWNrXCIpO1xuICBib2FyZFs3XVszXSA9IGNyZWF0ZVBpZWNlKFwicXVlZW5cIiwgXCJ3aGl0ZVwiKTtcbiAgYm9hcmRbMF1bNF0gPSBjcmVhdGVQaWVjZShcImtpbmdcIiwgXCJibGFja1wiKTtcbiAgYm9hcmRbN11bNF0gPSBjcmVhdGVQaWVjZShcImtpbmdcIiwgXCJ3aGl0ZVwiKTtcblxuICBtb3ZlSGlzdG9yeSA9IFtdO1xuICBib2FyZEhpc3RvcnkgPSBbXTtcbiAgZmlmdHlNb3ZlQ291bnRlciA9IDA7XG4gIGVuUGFzc2FudFRhcmdldCA9IG51bGw7XG4gIHNlbGVjdGVkUGllY2UgPSBudWxsO1xuICBzZWxlY3RlZFBvcyA9IG51bGw7XG4gIGN1cnJlbnRQbGF5ZXIgPSBcIndoaXRlXCI7XG5cbiAgZHJhd0JvYXJkKCk7XG4gIHVwZGF0ZUJvYXJkSGlzdG9yeSgpO1xufVxuXG5mdW5jdGlvbiByZXNldEdhbWUoKSB7XG4gIGNsZWFySW50ZXJ2YWwoY2xvY2tJbnRlcnZhbCk7XG4gIG1lbnVTY3JlZW4uc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcbiAgZ2FtZVNjcmVlbi5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG4gIGluaXRpYWxpemVCb2FyZCgpO1xufVxuXG4vKiAtLS0tLSBQSUVDRSBDUkVBVElPTiAtLS0tLSAqL1xuZnVuY3Rpb24gY3JlYXRlUGllY2UodHlwZSwgY29sb3IpIHtcbiAgcmV0dXJuIHsgdHlwZSwgY29sb3IsIGhhc01vdmVkOiBmYWxzZSB9O1xufVxuXG4vKiAtLS0tLSBEUkFXSU5HIFRIRSBCT0FSRCAtLS0tLSAqL1xuZnVuY3Rpb24gZHJhd0JvYXJkKCkge1xuICBib2FyZEVsZW1lbnQuaW5uZXJIVE1MID0gXCJcIjtcbiAgZm9yIChsZXQgcm93ID0gMDsgcm93IDwgODsgcm93KyspIHtcbiAgICBmb3IgKGxldCBjb2wgPSAwOyBjb2wgPCA4OyBjb2wrKykge1xuICAgICAgbGV0IHNxdWFyZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICBzcXVhcmUuY2xhc3NMaXN0LmFkZChcInNxdWFyZVwiKTtcbiAgICAgIHNxdWFyZS5kYXRhc2V0LnJvdyA9IHJvdztcbiAgICAgIHNxdWFyZS5kYXRhc2V0LmNvbCA9IGNvbDtcbiAgICAgIHNxdWFyZS5jbGFzc0xpc3QuYWRkKChyb3cgKyBjb2wpICUgMiA9PT0gMCA/IFwibGlnaHRcIiA6IFwiZGFya1wiKTtcblxuICAgICAgaWYgKHNlbGVjdGVkUG9zICYmIHNlbGVjdGVkUG9zLnJvdyA9PT0gcm93ICYmIHNlbGVjdGVkUG9zLmNvbCA9PT0gY29sKSB7XG4gICAgICAgIHNxdWFyZS5jbGFzc0xpc3QuYWRkKFwic2VsZWN0ZWRcIik7XG4gICAgICB9XG5cbiAgICAgIGlmIChib2FyZFtyb3ddW2NvbF0gJiYgYm9hcmRbcm93XVtjb2xdLnR5cGUgPT09IFwia2luZ1wiKSB7XG4gICAgICAgIGlmIChpc1NxdWFyZUF0dGFja2VkKGJvYXJkLCB7IHJvdywgY29sIH0sIGdldE9wcG9uZW50KGJvYXJkW3Jvd11bY29sXS5jb2xvcikpKSB7XG4gICAgICAgICAgc3F1YXJlLmNsYXNzTGlzdC5hZGQoXCJpbi1jaGVja1wiKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAoYm9hcmRbcm93XVtjb2xdKSB7XG4gICAgICAgIGxldCBwaWVjZUVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImltZ1wiKTtcbiAgICAgICAgcGllY2VFbC5jbGFzc0xpc3QuYWRkKFwicGllY2UtaW1nXCIsIGJvYXJkW3Jvd11bY29sXS5jb2xvciwgYm9hcmRbcm93XVtjb2xdLnR5cGUpO1xuICAgICAgICBwaWVjZUVsLnNyYyA9IGdldFBpZWNlSW1hZ2VTcmMoYm9hcmRbcm93XVtjb2xdKTtcbiAgICAgICAgcGllY2VFbC5hbHQgPSBib2FyZFtyb3ddW2NvbF0udHlwZTtcbiAgICAgICAgcGllY2VFbC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIG9uUGllY2VNb3VzZURvd24pO1xuICAgICAgICBzcXVhcmUuYXBwZW5kQ2hpbGQocGllY2VFbCk7XG4gICAgICB9XG4gICAgICBzcXVhcmUuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIG9uU3F1YXJlQ2xpY2spO1xuICAgICAgYm9hcmRFbGVtZW50LmFwcGVuZENoaWxkKHNxdWFyZSk7XG4gICAgfVxuICB9XG59XG5cbmZ1bmN0aW9uIGdldFBpZWNlSW1hZ2VTcmMocGllY2UpIHtcbiAgcmV0dXJuIGBhc3NldHMvJHtwaWVjZS5jb2xvcn1fJHtwaWVjZS50eXBlfS5wbmdgO1xufVxuXG4vKiAtLS0tLSBDTElDSyBIQU5ETElORyAtLS0tLSAqL1xuZnVuY3Rpb24gb25TcXVhcmVDbGljayhlKSB7XG4gIGlmIChkcmFnZ2luZ1BpZWNlRWwpIHJldHVybjtcblxuICBjb25zdCByb3cgPSBwYXJzZUludChlLmN1cnJlbnRUYXJnZXQuZGF0YXNldC5yb3cpO1xuICBjb25zdCBjb2wgPSBwYXJzZUludChlLmN1cnJlbnRUYXJnZXQuZGF0YXNldC5jb2wpO1xuXG4gIGlmIChib2FyZFtyb3ddW2NvbF0gJiYgYm9hcmRbcm93XVtjb2xdLmNvbG9yID09PSBjdXJyZW50UGxheWVyKSB7XG4gICAgc2VsZWN0ZWRQaWVjZSA9IGJvYXJkW3Jvd11bY29sXTtcbiAgICBzZWxlY3RlZFBvcyA9IHsgcm93LCBjb2wgfTtcbiAgfSBlbHNlIGlmIChzZWxlY3RlZFBpZWNlKSB7XG4gICAgbGV0IG1vdmUgPSB7XG4gICAgICBmcm9tOiB7IHJvdzogc2VsZWN0ZWRQb3Mucm93LCBjb2w6IHNlbGVjdGVkUG9zLmNvbCB9LFxuICAgICAgdG86IHsgcm93LCBjb2wgfSxcbiAgICAgIHBpZWNlOiBzZWxlY3RlZFBpZWNlLFxuICAgIH07XG4gICAgaWYgKGlzTGVnYWxNb3ZlKGJvYXJkLCBtb3ZlLCBjdXJyZW50UGxheWVyKSkge1xuICAgICAgbWFrZU1vdmUobW92ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnNvbGUubG9nKFwiSWxsZWdhbCBtb3ZlIGF0dGVtcHRlZDpcIiwgbW92ZSk7XG4gICAgfVxuICAgIHNlbGVjdGVkUGllY2UgPSBudWxsO1xuICAgIHNlbGVjdGVkUG9zID0gbnVsbDtcbiAgfVxuICBkcmF3Qm9hcmQoKTtcbn1cblxuLyogLS0tLS0gRFJBRy1UTy1NT1ZFIEhBTkRMSU5HIC0tLS0tICovXG5mdW5jdGlvbiBvblBpZWNlTW91c2VEb3duKGUpIHtcbiAgY29uc3Qgc3F1YXJlID0gZS50YXJnZXQucGFyZW50RWxlbWVudDtcbiAgY29uc3Qgcm93ID0gcGFyc2VJbnQoc3F1YXJlLmRhdGFzZXQucm93KTtcbiAgY29uc3QgY29sID0gcGFyc2VJbnQoc3F1YXJlLmRhdGFzZXQuY29sKTtcblxuICBpZiAoYm9hcmRbcm93XVtjb2xdLmNvbG9yICE9PSBjdXJyZW50UGxheWVyKSByZXR1cm47XG5cbiAgc2VsZWN0ZWRQaWVjZSA9IGJvYXJkW3Jvd11bY29sXTtcbiAgc2VsZWN0ZWRQb3MgPSB7IHJvdywgY29sIH07XG4gIGRyYWdTdGFydFBvcyA9IHsgcm93LCBjb2wgfTtcblxuICBkcmFnZ2luZ1BpZWNlRWwgPSBlLnRhcmdldC5jbG9uZU5vZGUodHJ1ZSk7XG4gIGRyYWdnaW5nUGllY2VFbC5jbGFzc0xpc3QuYWRkKFwiZHJhZ2dpbmdcIik7XG4gIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZHJhZ2dpbmdQaWVjZUVsKTtcblxuICBjb25zdCByZWN0ID0gZS50YXJnZXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gIGRyYWdPZmZzZXQueCA9IGUuY2xpZW50WCAtIHJlY3QubGVmdDtcbiAgZHJhZ09mZnNldC55ID0gZS5jbGllbnRZIC0gcmVjdC50b3A7XG5cbiAgZHJhd0JvYXJkKCk7XG5cbiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlbW92ZVwiLCBvbk1vdXNlTW92ZSk7XG4gIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZXVwXCIsIG9uTW91c2VVcCk7XG59XG5cbmZ1bmN0aW9uIG9uTW91c2VNb3ZlKGUpIHtcbiAgaWYgKGRyYWdnaW5nUGllY2VFbCkge1xuICAgIGRyYWdnaW5nUGllY2VFbC5zdHlsZS5sZWZ0ID0gZS5jbGllbnRYIC0gZHJhZ09mZnNldC54ICsgXCJweFwiO1xuICAgIGRyYWdnaW5nUGllY2VFbC5zdHlsZS50b3AgPSBlLmNsaWVudFkgLSBkcmFnT2Zmc2V0LnkgKyBcInB4XCI7XG4gIH1cbn1cblxuZnVuY3Rpb24gb25Nb3VzZVVwKGUpIHtcbiAgaWYgKCFkcmFnZ2luZ1BpZWNlRWwpIHJldHVybjtcblxuICBjb25zdCBib2FyZFJlY3QgPSBib2FyZEVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gIGNvbnN0IHggPSBlLmNsaWVudFggLSBib2FyZFJlY3QubGVmdDtcbiAgY29uc3QgeSA9IGUuY2xpZW50WSAtIGJvYXJkUmVjdC50b3A7XG4gIGNvbnN0IGNvbCA9IE1hdGguZmxvb3IoeCAvIDgwKTtcbiAgY29uc3Qgcm93ID0gTWF0aC5mbG9vcih5IC8gODApO1xuXG4gIGlmIChyb3cgPj0gMCAmJiByb3cgPCA4ICYmIGNvbCA+PSAwICYmIGNvbCA8IDgpIHtcbiAgICBsZXQgbW92ZSA9IHtcbiAgICAgIGZyb206IHsgcm93OiBkcmFnU3RhcnRQb3Mucm93LCBjb2w6IGRyYWdTdGFydFBvcy5jb2wgfSxcbiAgICAgIHRvOiB7IHJvdywgY29sIH0sXG4gICAgICBwaWVjZTogc2VsZWN0ZWRQaWVjZSxcbiAgICB9O1xuICAgIC8vIERldGVjdCBjYXN0bGluZzogaWYga2luZyBtb3ZlcyB0d28gc3F1YXJlcyBob3Jpem9udGFsbHlcbiAgICBpZiAoXG4gICAgICBtb3ZlLnBpZWNlLnR5cGUgPT09IFwia2luZ1wiICYmXG4gICAgICBNYXRoLmFicyhtb3ZlLnRvLmNvbCAtIG1vdmUuZnJvbS5jb2wpID09PSAyXG4gICAgKSB7XG4gICAgICBtb3ZlLmNhc3RsZSA9IG1vdmUudG8uY29sID4gbW92ZS5mcm9tLmNvbCA/IFwia2luZ3NpZGVcIiA6IFwicXVlZW5zaWRlXCI7XG4gICAgfVxuICAgIGlmIChpc0xlZ2FsTW92ZShib2FyZCwgbW92ZSwgY3VycmVudFBsYXllcikpIHtcbiAgICAgIG1ha2VNb3ZlKG1vdmUpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zb2xlLmxvZyhcIklsbGVnYWwgbW92ZSBhdHRlbXB0ZWQgdmlhIGRyYWc6XCIsIG1vdmUpO1xuICAgIH1cbiAgfVxuXG4gIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoZHJhZ2dpbmdQaWVjZUVsKTtcbiAgZHJhZ2dpbmdQaWVjZUVsID0gbnVsbDtcbiAgZHJhZ1N0YXJ0UG9zID0gbnVsbDtcbiAgc2VsZWN0ZWRQaWVjZSA9IG51bGw7XG4gIHNlbGVjdGVkUG9zID0gbnVsbDtcbiAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1vdXNlbW92ZVwiLCBvbk1vdXNlTW92ZSk7XG4gIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZXVwXCIsIG9uTW91c2VVcCk7XG4gIGRyYXdCb2FyZCgpO1xufVxuXG4vKiAtLS0tLSBNQUtJTkcgTU9WRVMgLS0tLS0gKi9cbmZ1bmN0aW9uIG1ha2VNb3ZlKG1vdmUpIHtcbiAgaWYgKGlzQ2FzdGxpbmdNb3ZlKG1vdmUpKSB7XG4gICAgcGVyZm9ybUNhc3RsZShtb3ZlKTtcbiAgfSBlbHNlIGlmIChpc0VuUGFzc2FudE1vdmUobW92ZSkpIHtcbiAgICBwZXJmb3JtRW5QYXNzYW50KG1vdmUpO1xuICB9IGVsc2Uge1xuICAgIGJvYXJkW21vdmUudG8ucm93XVttb3ZlLnRvLmNvbF0gPSBtb3ZlLnBpZWNlO1xuICAgIGJvYXJkW21vdmUuZnJvbS5yb3ddW21vdmUuZnJvbS5jb2xdID0gbnVsbDtcbiAgICBpZiAobW92ZS5waWVjZS50eXBlID09PSBcInBhd25cIiAmJiBpc0xhc3RSYW5rKG1vdmUudG8sIG1vdmUucGllY2UuY29sb3IpKSB7XG4gICAgICBzaG93UHJvbW90aW9uTW9kYWwobW92ZSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICB9XG4gIG1vdmUucGllY2UuaGFzTW92ZWQgPSB0cnVlO1xuICBoYW5kbGVQYXduRG91YmxlU3RlcChtb3ZlKTtcbiAgbW92ZUhpc3RvcnkucHVzaChtb3ZlKTtcbiAgdXBkYXRlRmlmdHlNb3ZlQ291bnRlcihtb3ZlKTtcbiAgdXBkYXRlQm9hcmRIaXN0b3J5KCk7XG5cbiAgLy8gU3dpdGNoIHR1cm4uIGN1cnJlbnRQbGF5ZXIgYmVjb21lcyB0aGUgcGxheWVyIHdobyBpcyBhYm91dCB0byBtb3ZlLlxuICBjdXJyZW50UGxheWVyID0gZ2V0T3Bwb25lbnQoY3VycmVudFBsYXllcik7XG4gIHN0YXJ0Q2xvY2soKTtcblxuICAvLyBGSVhFRDogQ2hlY2sgZm9yIGNoZWNrbWF0ZSBvbiB0aGUgY3VycmVudCBwbGF5ZXIncyB0dXJuXG4gIGlmIChjaGVja0ZvckNoZWNrbWF0ZShib2FyZCwgY3VycmVudFBsYXllcikpIHtcbiAgICBhbGVydChcIkNoZWNrbWF0ZSEgXCIgKyBnZXRPcHBvbmVudChjdXJyZW50UGxheWVyKSArIFwiIHdpbnMuXCIpO1xuICAgIGNsZWFySW50ZXJ2YWwoY2xvY2tJbnRlcnZhbCk7XG4gICAgcmVzZXRHYW1lKCk7XG4gICAgcmV0dXJuO1xuICB9IGVsc2UgaWYgKGNoZWNrRm9yU3RhbGVtYXRlKGJvYXJkLCBjdXJyZW50UGxheWVyKSkge1xuICAgIGFsZXJ0KFwiU3RhbGVtYXRlIVwiKTtcbiAgICBjbGVhckludGVydmFsKGNsb2NrSW50ZXJ2YWwpO1xuICAgIHJlc2V0R2FtZSgpO1xuICAgIHJldHVybjtcbiAgfSBlbHNlIGlmIChpc1RocmVlZm9sZFJlcGV0aXRpb24oKSkge1xuICAgIGFsZXJ0KFwiRHJhdyBieSB0aHJlZWZvbGQgcmVwZXRpdGlvbiFcIik7XG4gICAgY2xlYXJJbnRlcnZhbChjbG9ja0ludGVydmFsKTtcbiAgICByZXNldEdhbWUoKTtcbiAgICByZXR1cm47XG4gIH0gZWxzZSBpZiAoaXNGaWZ0eU1vdmVSdWxlKCkpIHtcbiAgICBhbGVydChcIkRyYXcgYnkgZmlmdHktbW92ZSBydWxlIVwiKTtcbiAgICBjbGVhckludGVydmFsKGNsb2NrSW50ZXJ2YWwpO1xuICAgIHJlc2V0R2FtZSgpO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHNlbGVjdGVkUGllY2UgPSBudWxsO1xuICBzZWxlY3RlZFBvcyA9IG51bGw7XG4gIGRyYXdCb2FyZCgpO1xufVxuXG4vKiAtLS0tLSBNT1ZFIEdFTkVSQVRJT04gLS0tLS0gKi9cbmZ1bmN0aW9uIGdlbmVyYXRlTW92ZXNGb3JQaWVjZShib2FyZCwgcG9zKSB7XG4gIGxldCBwaWVjZSA9IGJvYXJkW3Bvcy5yb3ddW3Bvcy5jb2xdO1xuICBpZiAoIXBpZWNlKSByZXR1cm4gW107XG4gIGxldCBtb3ZlcyA9IFtdO1xuICBzd2l0Y2ggKHBpZWNlLnR5cGUpIHtcbiAgICBjYXNlIFwicGF3blwiOlxuICAgICAgbW92ZXMgPSBnZW5lcmF0ZVBhd25Nb3Zlcyhib2FyZCwgcG9zLCBwaWVjZSk7XG4gICAgICBicmVhaztcbiAgICBjYXNlIFwicm9va1wiOlxuICAgICAgLy8gRnJpZW5kbHkgcm9va3M6IHJlc3RyaWN0IG1vdmVzIHRvIHByaW1lIG51bWJlciBvZiBzcXVhcmVzLlxuICAgICAgbW92ZXMgPSBnZW5lcmF0ZVJvb2tNb3Zlcyhib2FyZCwgcG9zLCBwaWVjZSk7XG4gICAgICBicmVhaztcbiAgICBjYXNlIFwia25pZ2h0XCI6XG4gICAgICBtb3ZlcyA9IGdlbmVyYXRlS25pZ2h0TW92ZXMoYm9hcmQsIHBvcywgcGllY2UpO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSBcImJpc2hvcFwiOlxuICAgICAgbW92ZXMgPSBnZW5lcmF0ZUJpc2hvcE1vdmVzKGJvYXJkLCBwb3MsIHBpZWNlKTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgXCJxdWVlblwiOlxuICAgICAgLy8gRm9yIHF1ZWVuLCB1c2UgZGVmYXVsdCByb29rIG1vdmVzIChubyBwcmltZSByZXN0cmljdGlvbikgcGx1cyBiaXNob3AgbW92ZXMuXG4gICAgICBtb3ZlcyA9IGdlbmVyYXRlUm9va01vdmVzRGVmYXVsdChib2FyZCwgcG9zLCBwaWVjZSkuY29uY2F0KFxuICAgICAgICBnZW5lcmF0ZUJpc2hvcE1vdmVzKGJvYXJkLCBwb3MsIHBpZWNlKVxuICAgICAgKTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgXCJraW5nXCI6XG4gICAgICBtb3ZlcyA9IGdlbmVyYXRlS2luZ01vdmVzKGJvYXJkLCBwb3MsIHBpZWNlKTtcbiAgICAgIG1vdmVzID0gbW92ZXMuY29uY2F0KGdlbmVyYXRlQ2FzdGxpbmdNb3Zlcyhib2FyZCwgcG9zLCBwaWVjZSkpO1xuICAgICAgYnJlYWs7XG4gIH1cbiAgcmV0dXJuIG1vdmVzO1xufVxuXG5mdW5jdGlvbiBnZW5lcmF0ZVBhd25Nb3Zlcyhib2FyZCwgcG9zLCBwaWVjZSkge1xuICBsZXQgbW92ZXMgPSBbXTtcbiAgbGV0IGRpcmVjdGlvbiA9IHBpZWNlLmNvbG9yID09PSBcIndoaXRlXCIgPyAtMSA6IDE7XG4gIGxldCBzdGFydFJvdyA9IHBpZWNlLmNvbG9yID09PSBcIndoaXRlXCIgPyA2IDogMTtcbiAgbGV0IG5leHRSb3cgPSBwb3Mucm93ICsgZGlyZWN0aW9uO1xuICBpZiAoaXNJbkJvdW5kcyhuZXh0Um93LCBwb3MuY29sKSAmJiBib2FyZFtuZXh0Um93XVtwb3MuY29sXSA9PT0gbnVsbCkge1xuICAgIG1vdmVzLnB1c2goeyBmcm9tOiBwb3MsIHRvOiB7IHJvdzogbmV4dFJvdywgY29sOiBwb3MuY29sIH0sIHBpZWNlIH0pO1xuICAgIGlmIChcbiAgICAgIHBvcy5yb3cgPT09IHN0YXJ0Um93ICYmXG4gICAgICBpc0luQm91bmRzKG5leHRSb3cgKyBkaXJlY3Rpb24sIHBvcy5jb2wpICYmXG4gICAgICBib2FyZFtuZXh0Um93ICsgZGlyZWN0aW9uXVtwb3MuY29sXSA9PT0gbnVsbFxuICAgICkge1xuICAgICAgbW92ZXMucHVzaCh7XG4gICAgICAgIGZyb206IHBvcyxcbiAgICAgICAgdG86IHsgcm93OiBuZXh0Um93ICsgZGlyZWN0aW9uLCBjb2w6IHBvcy5jb2wgfSxcbiAgICAgICAgcGllY2UsXG4gICAgICB9KTtcbiAgICB9XG4gIH1cbiAgZm9yIChsZXQgZGMgb2YgWy0xLCAxXSkge1xuICAgIGxldCBuZXdDb2wgPSBwb3MuY29sICsgZGM7XG4gICAgaWYgKGlzSW5Cb3VuZHMobmV4dFJvdywgbmV3Q29sKSkge1xuICAgICAgaWYgKGJvYXJkW25leHRSb3ddW25ld0NvbF0gJiYgYm9hcmRbbmV4dFJvd11bbmV3Q29sXS5jb2xvciAhPT0gcGllY2UuY29sb3IpIHtcbiAgICAgICAgbW92ZXMucHVzaCh7IGZyb206IHBvcywgdG86IHsgcm93OiBuZXh0Um93LCBjb2w6IG5ld0NvbCB9LCBwaWVjZSB9KTtcbiAgICAgIH1cbiAgICAgIGlmIChcbiAgICAgICAgYm9hcmRbbmV4dFJvd11bbmV3Q29sXSA9PT0gbnVsbCAmJlxuICAgICAgICBlblBhc3NhbnRUYXJnZXQgJiZcbiAgICAgICAgZW5QYXNzYW50VGFyZ2V0LnJvdyA9PT0gbmV4dFJvdyAmJlxuICAgICAgICBlblBhc3NhbnRUYXJnZXQuY29sID09PSBuZXdDb2xcbiAgICAgICkge1xuICAgICAgICBtb3Zlcy5wdXNoKHsgZnJvbTogcG9zLCB0bzogeyByb3c6IG5leHRSb3csIGNvbDogbmV3Q29sIH0sIHBpZWNlLCBlblBhc3NhbnQ6IHRydWUgfSk7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIHJldHVybiBtb3Zlcztcbn1cblxuLyogTW9kaWZpZWQgUm9vayBNb3ZlczogRm9yIGZyaWVuZGx5IHJvb2tzLCBhbGxvdyBtb3ZlcyBvbmx5IGlmIHRoZSBudW1iZXIgb2Ygc3F1YXJlcyBtb3ZlZCBpcyBwcmltZSAoMiwgMywgNSwgb3IgNykgKi9cbmZ1bmN0aW9uIGdlbmVyYXRlUm9va01vdmVzKGJvYXJkLCBwb3MsIHBpZWNlKSB7XG4gIGxldCBtb3ZlcyA9IFtdO1xuICBsZXQgZGlyZWN0aW9ucyA9IFtcbiAgICBbMSwgMF0sXG4gICAgWy0xLCAwXSxcbiAgICBbMCwgMV0sXG4gICAgWzAsIC0xXSxcbiAgXTtcbiAgZGlyZWN0aW9ucy5mb3JFYWNoKChkKSA9PiB7XG4gICAgbGV0IHIgPSBwb3Mucm93O1xuICAgIGxldCBjID0gcG9zLmNvbDtcbiAgICBsZXQgc3RlcHMgPSAwO1xuICAgIHdoaWxlICh0cnVlKSB7XG4gICAgICByICs9IGRbMF07XG4gICAgICBjICs9IGRbMV07XG4gICAgICBzdGVwcysrO1xuICAgICAgaWYgKCFpc0luQm91bmRzKHIsIGMpKSBicmVhaztcbiAgICAgIGlmIChpc1ByaW1lKHN0ZXBzKSkge1xuICAgICAgICBpZiAoYm9hcmRbcl1bY10gPT09IG51bGwpIHtcbiAgICAgICAgICBtb3Zlcy5wdXNoKHsgZnJvbTogcG9zLCB0bzogeyByb3c6IHIsIGNvbDogYyB9LCBwaWVjZSB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpZiAoYm9hcmRbcl1bY10uY29sb3IgIT09IHBpZWNlLmNvbG9yKSB7XG4gICAgICAgICAgICBtb3Zlcy5wdXNoKHsgZnJvbTogcG9zLCB0bzogeyByb3c6IHIsIGNvbDogYyB9LCBwaWVjZSB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmIChib2FyZFtyXVtjXSAhPT0gbnVsbCkgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuICB9KTtcbiAgcmV0dXJuIG1vdmVzO1xufVxuXG4vKiBEZWZhdWx0IFJvb2sgTW92ZXMgZm9yIHF1ZWVuIG1vdmVzIGFuZCBlbmVteSBhdHRhY2sgZGV0ZWN0aW9uIChubyBwcmltZSByZXN0cmljdGlvbikgKi9cbmZ1bmN0aW9uIGdlbmVyYXRlUm9va01vdmVzRGVmYXVsdChib2FyZCwgcG9zLCBwaWVjZSkge1xuICBsZXQgbW92ZXMgPSBbXTtcbiAgbGV0IGRpcmVjdGlvbnMgPSBbXG4gICAgWzEsIDBdLFxuICAgIFstMSwgMF0sXG4gICAgWzAsIDFdLFxuICAgIFswLCAtMV0sXG4gIF07XG4gIGRpcmVjdGlvbnMuZm9yRWFjaCgoZCkgPT4ge1xuICAgIGxldCByID0gcG9zLnJvdztcbiAgICBsZXQgYyA9IHBvcy5jb2w7XG4gICAgd2hpbGUgKHRydWUpIHtcbiAgICAgIHIgKz0gZFswXTtcbiAgICAgIGMgKz0gZFsxXTtcbiAgICAgIGlmICghaXNJbkJvdW5kcyhyLCBjKSkgYnJlYWs7XG4gICAgICBpZiAoYm9hcmRbcl1bY10gPT09IG51bGwpIHtcbiAgICAgICAgbW92ZXMucHVzaCh7IGZyb206IHBvcywgdG86IHsgcm93OiByLCBjb2w6IGMgfSwgcGllY2UgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBtb3Zlcy5wdXNoKHsgZnJvbTogcG9zLCB0bzogeyByb3c6IHIsIGNvbDogYyB9LCBwaWVjZSB9KTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuICB9KTtcbiAgcmV0dXJuIG1vdmVzO1xufVxuXG5mdW5jdGlvbiBnZW5lcmF0ZUtuaWdodE1vdmVzKGJvYXJkLCBwb3MsIHBpZWNlKSB7XG4gIGxldCBtb3ZlcyA9IFtdO1xuICBsZXQgb2Zmc2V0cyA9IFtcbiAgICBbLTIsIC0xXSxcbiAgICBbLTIsIDFdLFxuICAgIFstMSwgLTJdLFxuICAgIFstMSwgMl0sXG4gICAgWzEsIC0yXSxcbiAgICBbMSwgMl0sXG4gICAgWzIsIC0xXSxcbiAgICBbMiwgMV0sXG4gIF07XG4gIG9mZnNldHMuZm9yRWFjaCgobykgPT4ge1xuICAgIGxldCByID0gcG9zLnJvdyArIG9bMF07XG4gICAgbGV0IGMgPSBwb3MuY29sICsgb1sxXTtcbiAgICBpZiAoaXNJbkJvdW5kcyhyLCBjKSAmJiAoIWJvYXJkW3JdW2NdIHx8IGJvYXJkW3JdW2NdLmNvbG9yICE9PSBwaWVjZS5jb2xvcikpIHtcbiAgICAgIG1vdmVzLnB1c2goeyBmcm9tOiBwb3MsIHRvOiB7IHJvdzogciwgY29sOiBjIH0sIHBpZWNlIH0pO1xuICAgIH1cbiAgfSk7XG4gIHJldHVybiBtb3Zlcztcbn1cblxuZnVuY3Rpb24gZ2VuZXJhdGVCaXNob3BNb3Zlcyhib2FyZCwgcG9zLCBwaWVjZSkge1xuICBsZXQgbW92ZXMgPSBbXTtcbiAgbGV0IGRpcmVjdGlvbnMgPSBbXG4gICAgWzEsIDFdLFxuICAgIFsxLCAtMV0sXG4gICAgWy0xLCAxXSxcbiAgICBbLTEsIC0xXSxcbiAgXTtcbiAgZGlyZWN0aW9ucy5mb3JFYWNoKChkKSA9PiB7XG4gICAgZm9yIChsZXQgc3RlcHMgPSAxOyBzdGVwcyA8IDg7IHN0ZXBzKyspIHtcbiAgICAgIGxldCByID0gcG9zLnJvdyArIGRbMF0gKiBzdGVwcztcbiAgICAgIGxldCBjID0gcG9zLmNvbCArIGRbMV0gKiBzdGVwcztcbiAgICAgIGlmICghaXNJbkJvdW5kcyhyLCBjKSkgYnJlYWs7XG5cbiAgICAgIC8vIFNraXAgaWYgZGVzdGluYXRpb24gaXMgb2NjdXBpZWQgYnkgYSBmcmllbmRseSBwaWVjZVxuICAgICAgbGV0IGRlc3RTcXVhcmUgPSBib2FyZFtyXVtjXTtcbiAgICAgIGlmIChkZXN0U3F1YXJlICYmIGRlc3RTcXVhcmUuY29sb3IgPT09IHBpZWNlLmNvbG9yKSBjb250aW51ZTtcblxuICAgICAgbGV0IHN0YW5kYXJkUGF0aFZhbGlkID0gdHJ1ZTtcbiAgICAgIGxldCBtb2RpZmllZFBhd25Db3VudCA9IDA7XG4gICAgICBsZXQgbW9kaWZpZWRQYXRoVmFsaWQgPSB0cnVlO1xuXG4gICAgICAvLyBDaGVjayBzdGFuZGFyZCBwYXRoIHZhbGlkaXR5IChhbGwgaW50ZXJtZWRpYXRlIHNxdWFyZXMgZW1wdHkpXG4gICAgICBmb3IgKGxldCBzID0gMTsgcyA8IHN0ZXBzOyBzKyspIHtcbiAgICAgICAgbGV0IGN1cnJlbnRSID0gcG9zLnJvdyArIGRbMF0gKiBzO1xuICAgICAgICBsZXQgY3VycmVudEMgPSBwb3MuY29sICsgZFsxXSAqIHM7XG4gICAgICAgIGlmIChib2FyZFtjdXJyZW50Ul1bY3VycmVudENdICE9PSBudWxsKSB7XG4gICAgICAgICAgc3RhbmRhcmRQYXRoVmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBDaGVjayBtb2RpZmllZCBwYXRoIHZhbGlkaXR5IChleGFjdGx5IG9uZSBwYXduIGluIGludGVybWVkaWF0ZSBzcXVhcmVzKVxuICAgICAgZm9yIChsZXQgcyA9IDE7IHMgPCBzdGVwczsgcysrKSB7XG4gICAgICAgIGxldCBjdXJyZW50UiA9IHBvcy5yb3cgKyBkWzBdICogcztcbiAgICAgICAgbGV0IGN1cnJlbnRDID0gcG9zLmNvbCArIGRbMV0gKiBzO1xuICAgICAgICBsZXQgc3F1YXJlID0gYm9hcmRbY3VycmVudFJdW2N1cnJlbnRDXTtcbiAgICAgICAgaWYgKHNxdWFyZSkge1xuICAgICAgICAgIGlmIChzcXVhcmUudHlwZSA9PT0gJ3Bhd24nKSB7XG4gICAgICAgICAgICBtb2RpZmllZFBhd25Db3VudCsrO1xuICAgICAgICAgICAgaWYgKG1vZGlmaWVkUGF3bkNvdW50ID4gMSkge1xuICAgICAgICAgICAgICBtb2RpZmllZFBhdGhWYWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbW9kaWZpZWRQYXRoVmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgbW9kaWZpZWRQYXRoVmFsaWQgPSBtb2RpZmllZFBhdGhWYWxpZCAmJiBtb2RpZmllZFBhd25Db3VudCA9PT0gMTtcblxuICAgICAgLy8gQWRkIG1vdmUgaWYgZWl0aGVyIHBhdGggaXMgdmFsaWRcbiAgICAgIGlmIChzdGFuZGFyZFBhdGhWYWxpZCB8fCBtb2RpZmllZFBhdGhWYWxpZCkge1xuICAgICAgICBtb3Zlcy5wdXNoKHsgZnJvbTogcG9zLCB0bzogeyByb3c6IHIsIGNvbDogYyB9LCBwaWVjZSB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuICByZXR1cm4gbW92ZXM7XG59XG5cbmZ1bmN0aW9uIGdlbmVyYXRlUXVlZW5Nb3Zlcyhib2FyZCwgcG9zLCBwaWVjZSkge1xuICAvLyBRdWVlbiBtb3ZlcyA9IGRlZmF1bHQgcm9vayBtb3ZlcyAobm8gcHJpbWUgcmVzdHJpY3Rpb24pICsgYmlzaG9wIG1vdmVzXG4gIHJldHVybiBnZW5lcmF0ZVJvb2tNb3Zlc0RlZmF1bHQoYm9hcmQsIHBvcywgcGllY2UpLmNvbmNhdChcbiAgICBnZW5lcmF0ZUJpc2hvcE1vdmVzKGJvYXJkLCBwb3MsIHBpZWNlKVxuICApO1xufVxuXG5mdW5jdGlvbiBnZW5lcmF0ZUtpbmdNb3Zlcyhib2FyZCwgcG9zLCBwaWVjZSkge1xuICBsZXQgbW92ZXMgPSBbXTtcbiAgZm9yIChsZXQgciA9IHBvcy5yb3cgLSAxOyByIDw9IHBvcy5yb3cgKyAxOyByKyspIHtcbiAgICBmb3IgKGxldCBjID0gcG9zLmNvbCAtIDE7IGMgPD0gcG9zLmNvbCArIDE7IGMrKykge1xuICAgICAgaWYgKHIgPT09IHBvcy5yb3cgJiYgYyA9PT0gcG9zLmNvbCkgY29udGludWU7XG4gICAgICBpZiAoaXNJbkJvdW5kcyhyLCBjKSAmJiAoIWJvYXJkW3JdW2NdIHx8IGJvYXJkW3JdW2NdLmNvbG9yICE9PSBwaWVjZS5jb2xvcikpIHtcbiAgICAgICAgbW92ZXMucHVzaCh7IGZyb206IHBvcywgdG86IHsgcm93OiByLCBjb2w6IGMgfSwgcGllY2UgfSk7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIHJldHVybiBtb3Zlcztcbn1cblxuZnVuY3Rpb24gZ2VuZXJhdGVDYXN0bGluZ01vdmVzKGJvYXJkLCBwb3MsIGtpbmcpIHtcbiAgbGV0IG1vdmVzID0gW107XG4gIGlmIChraW5nLmhhc01vdmVkKSByZXR1cm4gbW92ZXM7XG4gIGlmIChjYW5DYXN0bGUoYm9hcmQsIGtpbmcsIHsgc2lkZTogXCJraW5nc2lkZVwiLCBwb3MgfSkpIHtcbiAgICBtb3Zlcy5wdXNoKHtcbiAgICAgIGZyb206IHBvcyxcbiAgICAgIHRvOiB7IHJvdzogcG9zLnJvdywgY29sOiBwb3MuY29sICsgMiB9LFxuICAgICAgcGllY2U6IGtpbmcsXG4gICAgICBjYXN0bGU6IFwia2luZ3NpZGVcIixcbiAgICB9KTtcbiAgfVxuICBpZiAoY2FuQ2FzdGxlKGJvYXJkLCBraW5nLCB7IHNpZGU6IFwicXVlZW5zaWRlXCIsIHBvcyB9KSkge1xuICAgIG1vdmVzLnB1c2goe1xuICAgICAgZnJvbTogcG9zLFxuICAgICAgdG86IHsgcm93OiBwb3Mucm93LCBjb2w6IHBvcy5jb2wgLSAyIH0sXG4gICAgICBwaWVjZToga2luZyxcbiAgICAgIGNhc3RsZTogXCJxdWVlbnNpZGVcIixcbiAgICB9KTtcbiAgfVxuICByZXR1cm4gbW92ZXM7XG59XG5cbi8qIC0tLS0tIENBU1RMSU5HIExPR0lDIC0tLS0tICovXG5mdW5jdGlvbiBjYW5DYXN0bGUoYm9hcmQsIGtpbmcsIHsgc2lkZSwgcG9zIH0pIHtcbiAgbGV0IHJvdyA9IHBvcy5yb3c7XG4gIGlmIChraW5nLmhhc01vdmVkKSByZXR1cm4gZmFsc2U7XG4gIGlmIChzaWRlID09PSBcImtpbmdzaWRlXCIpIHtcbiAgICBsZXQgcm9vayA9IGJvYXJkW3Jvd11bN107XG4gICAgaWYgKCFyb29rIHx8IHJvb2sudHlwZSAhPT0gXCJyb29rXCIgfHwgcm9vay5oYXNNb3ZlZCkgcmV0dXJuIGZhbHNlO1xuICAgIGlmIChib2FyZFtyb3ddWzVdICE9PSBudWxsIHx8IGJvYXJkW3Jvd11bNl0gIT09IG51bGwpIHJldHVybiBmYWxzZTtcbiAgICBpZiAoXG4gICAgICAhaXNTcXVhcmVTYWZlRm9yS2luZyhib2FyZCwgeyByb3csIGNvbDogNCB9LCBraW5nLmNvbG9yKSB8fFxuICAgICAgIWlzU3F1YXJlU2FmZUZvcktpbmcoYm9hcmQsIHsgcm93LCBjb2w6IDUgfSwga2luZy5jb2xvcikgfHxcbiAgICAgICFpc1NxdWFyZVNhZmVGb3JLaW5nKGJvYXJkLCB7IHJvdywgY29sOiA2IH0sIGtpbmcuY29sb3IpXG4gICAgKVxuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIHJldHVybiB0cnVlO1xuICB9IGVsc2UgaWYgKHNpZGUgPT09IFwicXVlZW5zaWRlXCIpIHtcbiAgICBsZXQgcm9vayA9IGJvYXJkW3Jvd11bMF07XG4gICAgaWYgKCFyb29rIHx8IHJvb2sudHlwZSAhPT0gXCJyb29rXCIgfHwgcm9vay5oYXNNb3ZlZCkgcmV0dXJuIGZhbHNlO1xuICAgIGlmIChib2FyZFtyb3ddWzFdICE9PSBudWxsIHx8IGJvYXJkW3Jvd11bMl0gIT09IG51bGwgfHwgYm9hcmRbcm93XVszXSAhPT0gbnVsbClcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICBpZiAoXG4gICAgICAhaXNTcXVhcmVTYWZlRm9yS2luZyhib2FyZCwgeyByb3csIGNvbDogNCB9LCBraW5nLmNvbG9yKSB8fFxuICAgICAgIWlzU3F1YXJlU2FmZUZvcktpbmcoYm9hcmQsIHsgcm93LCBjb2w6IDMgfSwga2luZy5jb2xvcikgfHxcbiAgICAgICFpc1NxdWFyZVNhZmVGb3JLaW5nKGJvYXJkLCB7IHJvdywgY29sOiAyIH0sIGtpbmcuY29sb3IpXG4gICAgKVxuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIHJldHVybiB0cnVlO1xuICB9XG4gIHJldHVybiBmYWxzZTtcbn1cblxuZnVuY3Rpb24gaXNTcXVhcmVTYWZlRm9yS2luZyhib2FyZCwgcG9zLCBjb2xvcikge1xuICBsZXQgdGVtcEJvYXJkID0gY2xvbmVCb2FyZChib2FyZCk7XG4gIHRlbXBCb2FyZFtwb3Mucm93XVtwb3MuY29sXSA9IHsgdHlwZTogXCJraW5nXCIsIGNvbG9yLCBoYXNNb3ZlZDogdHJ1ZSB9O1xuICByZXR1cm4gaXNLaW5nU2FmZSh0ZW1wQm9hcmQsIGNvbG9yKTtcbn1cblxuLyogLS0tLS0gSEVMUEVSIEZVTkNUSU9OUyAtLS0tLSAqL1xuZnVuY3Rpb24gaXNJbkJvdW5kcyhyb3csIGNvbCkge1xuICByZXR1cm4gcm93ID49IDAgJiYgcm93IDwgOCAmJiBjb2wgPj0gMCAmJiBjb2wgPCA4O1xufVxuXG5mdW5jdGlvbiBjbG9uZUJvYXJkKGJvYXJkKSB7XG4gIHJldHVybiBib2FyZC5tYXAoKHJvdykgPT4gcm93Lm1hcCgoY2VsbCkgPT4gKGNlbGwgPyB7IC4uLmNlbGwgfSA6IG51bGwpKSk7XG59XG5cbmZ1bmN0aW9uIGlzS2luZ1NhZmUoYm9hcmQsIGNvbG9yKSB7XG4gIGxldCBraW5nUG9zID0gZmluZEtpbmcoYm9hcmQsIGNvbG9yKTtcbiAgaWYgKCFraW5nUG9zKSByZXR1cm4gZmFsc2U7XG4gIHJldHVybiAhaXNTcXVhcmVBdHRhY2tlZChib2FyZCwga2luZ1BvcywgZ2V0T3Bwb25lbnQoY29sb3IpKTtcbn1cblxuZnVuY3Rpb24gZmluZEtpbmcoYm9hcmQsIGNvbG9yKSB7XG4gIGZvciAobGV0IHIgPSAwOyByIDwgODsgcisrKSB7XG4gICAgZm9yIChsZXQgYyA9IDA7IGMgPCA4OyBjKyspIHtcbiAgICAgIGxldCBwaWVjZSA9IGJvYXJkW3JdW2NdO1xuICAgICAgaWYgKHBpZWNlICYmIHBpZWNlLnR5cGUgPT09IFwia2luZ1wiICYmIHBpZWNlLmNvbG9yID09PSBjb2xvcikge1xuICAgICAgICByZXR1cm4geyByb3c6IHIsIGNvbDogYyB9O1xuICAgICAgfVxuICAgIH1cbiAgfVxuICByZXR1cm4gbnVsbDtcbn1cblxuZnVuY3Rpb24gaXNTcXVhcmVBdHRhY2tlZChib2FyZCwgcG9zLCBhdHRhY2tlckNvbG9yKSB7XG4gIGZvciAobGV0IHIgPSAwOyByIDwgODsgcisrKSB7XG4gICAgZm9yIChsZXQgYyA9IDA7IGMgPCA4OyBjKyspIHtcbiAgICAgIGxldCBwaWVjZSA9IGJvYXJkW3JdW2NdO1xuICAgICAgaWYgKHBpZWNlICYmIHBpZWNlLmNvbG9yID09PSBhdHRhY2tlckNvbG9yKSB7XG4gICAgICAgIGxldCBtb3ZlcztcbiAgICAgICAgaWYgKHBpZWNlLnR5cGUgPT09IFwicm9va1wiKSB7XG4gICAgICAgICAgLy8gRm9yIGVuZW15IHJvb2tzLCB1c2UgZnVsbC1yYW5nZSBtb3ZlcyAoZGVmYXVsdCkgZm9yIGF0dGFjayBkZXRlY3Rpb24uXG4gICAgICAgICAgbW92ZXMgPSBnZW5lcmF0ZVJvb2tNb3Zlc0RlZmF1bHQoYm9hcmQsIHsgcm93OiByLCBjb2w6IGMgfSwgcGllY2UpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG1vdmVzID0gZ2VuZXJhdGVNb3Zlc0ZvclBpZWNlKGJvYXJkLCB7IHJvdzogciwgY29sOiBjIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZvciAobGV0IG1vdmUgb2YgbW92ZXMpIHtcbiAgICAgICAgICBpZiAobW92ZS50by5yb3cgPT09IHBvcy5yb3cgJiYgbW92ZS50by5jb2wgPT09IHBvcy5jb2wpIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG4gIHJldHVybiBmYWxzZTtcbn1cblxuZnVuY3Rpb24gZ2V0T3Bwb25lbnQoY29sb3IpIHtcbiAgcmV0dXJuIGNvbG9yID09PSBcIndoaXRlXCIgPyBcImJsYWNrXCIgOiBcIndoaXRlXCI7XG59XG5cbi8qIC0tLS0tIEVOIFBBU1NBTlQgTE9HSUMgLS0tLS0gKi9cbmZ1bmN0aW9uIGhhbmRsZVBhd25Eb3VibGVTdGVwKG1vdmUpIHtcbiAgaWYgKFxuICAgIG1vdmUucGllY2UudHlwZSA9PT0gXCJwYXduXCIgJiZcbiAgICBNYXRoLmFicyhtb3ZlLmZyb20ucm93IC0gbW92ZS50by5yb3cpID09PSAyXG4gICkge1xuICAgIGVuUGFzc2FudFRhcmdldCA9IHtcbiAgICAgIHJvdzogKG1vdmUuZnJvbS5yb3cgKyBtb3ZlLnRvLnJvdykgLyAyLFxuICAgICAgY29sOiBtb3ZlLmZyb20uY29sLFxuICAgIH07XG4gIH0gZWxzZSB7XG4gICAgZW5QYXNzYW50VGFyZ2V0ID0gbnVsbDtcbiAgfVxufVxuXG5mdW5jdGlvbiBpc0VuUGFzc2FudE1vdmUobW92ZSkge1xuICByZXR1cm4gKFxuICAgIG1vdmUucGllY2UudHlwZSA9PT0gXCJwYXduXCIgJiZcbiAgICBtb3ZlLmZyb20uY29sICE9PSBtb3ZlLnRvLmNvbCAmJlxuICAgIGJvYXJkW21vdmUudG8ucm93XVttb3ZlLnRvLmNvbF0gPT09IG51bGxcbiAgKTtcbn1cblxuZnVuY3Rpb24gcGVyZm9ybUVuUGFzc2FudChtb3ZlKSB7XG4gIGJvYXJkW21vdmUudG8ucm93XVttb3ZlLnRvLmNvbF0gPSBtb3ZlLnBpZWNlO1xuICBib2FyZFttb3ZlLmZyb20ucm93XVttb3ZlLmZyb20uY29sXSA9IG51bGw7XG4gIGxldCBjYXB0dXJlUm93ID0gbW92ZS5waWVjZS5jb2xvciA9PT0gXCJ3aGl0ZVwiID8gbW92ZS50by5yb3cgKyAxIDogbW92ZS50by5yb3cgLSAxO1xuICBib2FyZFtjYXB0dXJlUm93XVttb3ZlLnRvLmNvbF0gPSBudWxsO1xufVxuXG4vKiAtLS0tLSBDQVNUTElORyBIQU5ETElORyAtLS0tLSAqL1xuZnVuY3Rpb24gaXNDYXN0bGluZ01vdmUobW92ZSkge1xuICByZXR1cm4gKFxuICAgIG1vdmUucGllY2UudHlwZSA9PT0gXCJraW5nXCIgJiYgTWF0aC5hYnMobW92ZS50by5jb2wgLSBtb3ZlLmZyb20uY29sKSA9PT0gMlxuICApO1xufVxuXG5mdW5jdGlvbiBwZXJmb3JtQ2FzdGxlKG1vdmUpIHtcbiAgbGV0IHJvdyA9IG1vdmUuZnJvbS5yb3c7XG4gIGlmIChtb3ZlLmNhc3RsZSA9PT0gXCJraW5nc2lkZVwiKSB7XG4gICAgYm9hcmRbcm93XVs2XSA9IG1vdmUucGllY2U7XG4gICAgYm9hcmRbcm93XVs0XSA9IG51bGw7XG4gICAgbGV0IHJvb2sgPSBib2FyZFtyb3ddWzddO1xuICAgIGJvYXJkW3Jvd11bNV0gPSByb29rO1xuICAgIGJvYXJkW3Jvd11bN10gPSBudWxsO1xuICAgIHJvb2suaGFzTW92ZWQgPSB0cnVlO1xuICB9IGVsc2UgaWYgKG1vdmUuY2FzdGxlID09PSBcInF1ZWVuc2lkZVwiKSB7XG4gICAgYm9hcmRbcm93XVsyXSA9IG1vdmUucGllY2U7XG4gICAgYm9hcmRbcm93XVs0XSA9IG51bGw7XG4gICAgbGV0IHJvb2sgPSBib2FyZFtyb3ddWzBdO1xuICAgIGJvYXJkW3Jvd11bM10gPSByb29rO1xuICAgIGJvYXJkW3Jvd11bMF0gPSBudWxsO1xuICAgIHJvb2suaGFzTW92ZWQgPSB0cnVlO1xuICB9XG59XG5cbi8qIC0tLS0tIFBBV04gUFJPTU9USU9OIC0tLS0tICovXG5mdW5jdGlvbiBpc0xhc3RSYW5rKHBvcywgY29sb3IpIHtcbiAgcmV0dXJuIChjb2xvciA9PT0gXCJ3aGl0ZVwiICYmIHBvcy5yb3cgPT09IDApIHx8IChjb2xvciA9PT0gXCJibGFja1wiICYmIHBvcy5yb3cgPT09IDcpO1xufVxuXG5mdW5jdGlvbiBzaG93UHJvbW90aW9uTW9kYWwobW92ZSkge1xuICBwcm9tb3Rpb25Nb2RhbC5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xuICBwcm9tb3Rpb25Nb2RhbC5kYXRhc2V0LmZyb21Sb3cgPSBtb3ZlLmZyb20ucm93O1xuICBwcm9tb3Rpb25Nb2RhbC5kYXRhc2V0LmZyb21Db2wgPSBtb3ZlLmZyb20uY29sO1xuICBwcm9tb3Rpb25Nb2RhbC5kYXRhc2V0LnRvUm93ID0gbW92ZS50by5yb3c7XG4gIHByb21vdGlvbk1vZGFsLmRhdGFzZXQudG9Db2wgPSBtb3ZlLnRvLmNvbDtcbiAgcHJvbW90aW9uTW9kYWwuZGF0YXNldC5jb2xvciA9IG1vdmUucGllY2UuY29sb3I7XG4gIHByb21vdGlvbk1vZGFsLmRhdGFzZXQucGllY2VUeXBlID0gbW92ZS5waWVjZS50eXBlO1xufVxuXG5wcm9tb3Rpb25DaG9pY2VzLmZvckVhY2goKGNob2ljZSkgPT4ge1xuICBjaG9pY2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcbiAgICBsZXQgc2VsZWN0ZWRUeXBlID0gdGhpcy5kYXRhc2V0LnR5cGU7XG4gICAgbGV0IG1vdmUgPSB7XG4gICAgICBmcm9tOiB7XG4gICAgICAgIHJvdzogcGFyc2VJbnQocHJvbW90aW9uTW9kYWwuZGF0YXNldC5mcm9tUm93KSxcbiAgICAgICAgY29sOiBwYXJzZUludChwcm9tb3Rpb25Nb2RhbC5kYXRhc2V0LmZyb21Db2wpLFxuICAgICAgfSxcbiAgICAgIHRvOiB7XG4gICAgICAgIHJvdzogcGFyc2VJbnQocHJvbW90aW9uTW9kYWwuZGF0YXNldC50b1JvdyksXG4gICAgICAgIGNvbDogcGFyc2VJbnQocHJvbW90aW9uTW9kYWwuZGF0YXNldC50b0NvbCksXG4gICAgICB9LFxuICAgICAgcGllY2U6IHtcbiAgICAgICAgdHlwZTogcHJvbW90aW9uTW9kYWwuZGF0YXNldC5waWVjZVR5cGUsXG4gICAgICAgIGNvbG9yOiBwcm9tb3Rpb25Nb2RhbC5kYXRhc2V0LmNvbG9yLFxuICAgICAgfSxcbiAgICB9O1xuICAgIGJvYXJkW21vdmUudG8ucm93XVttb3ZlLnRvLmNvbF0gPSBjcmVhdGVQaWVjZShzZWxlY3RlZFR5cGUsIG1vdmUucGllY2UuY29sb3IpO1xuICAgIGJvYXJkW21vdmUuZnJvbS5yb3ddW21vdmUuZnJvbS5jb2xdID0gbnVsbDtcbiAgICBwcm9tb3Rpb25Nb2RhbC5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG4gICAgYm9hcmRbbW92ZS50by5yb3ddW21vdmUudG8uY29sXS5oYXNNb3ZlZCA9IHRydWU7XG4gICAgbW92ZUhpc3RvcnkucHVzaChtb3ZlKTtcbiAgICB1cGRhdGVGaWZ0eU1vdmVDb3VudGVyKG1vdmUpO1xuICAgIHVwZGF0ZUJvYXJkSGlzdG9yeSgpO1xuICAgIGlmIChjaGVja0ZvckNoZWNrbWF0ZShib2FyZCwgZ2V0T3Bwb25lbnQoY3VycmVudFBsYXllcikpKSB7XG4gICAgICBhbGVydChcIkNoZWNrbWF0ZSEgXCIgKyBnZXRPcHBvbmVudChjdXJyZW50UGxheWVyKSArIFwiIHdpbnMuXCIpO1xuICAgICAgY2xlYXJJbnRlcnZhbChjbG9ja0ludGVydmFsKTtcbiAgICAgIHJlc2V0R2FtZSgpO1xuICAgICAgcmV0dXJuO1xuICAgIH0gZWxzZSBpZiAoY2hlY2tGb3JTdGFsZW1hdGUoYm9hcmQsIGdldE9wcG9uZW50KGN1cnJlbnRQbGF5ZXIpKSkge1xuICAgICAgYWxlcnQoXCJTdGFsZW1hdGUhXCIpO1xuICAgICAgY2xlYXJJbnRlcnZhbChjbG9ja0ludGVydmFsKTtcbiAgICAgIHJlc2V0R2FtZSgpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjdXJyZW50UGxheWVyID0gZ2V0T3Bwb25lbnQoY3VycmVudFBsYXllcik7XG4gICAgc3RhcnRDbG9jaygpO1xuICAgIHNlbGVjdGVkUGllY2UgPSBudWxsO1xuICAgIHNlbGVjdGVkUG9zID0gbnVsbDtcbiAgICBkcmF3Qm9hcmQoKTtcbiAgfSk7XG59KTtcblxuLyogLS0tLS0gQk9BUkQgSElTVE9SWSAmIERSQVdJTkcgUlVMRVMgLS0tLS0gKi9cbmZ1bmN0aW9uIHNlcmlhbGl6ZUJvYXJkKGJvYXJkKSB7XG4gIHJldHVybiBib2FyZFxuICAgIC5tYXAoKHJvdykgPT5cbiAgICAgIHJvdy5tYXAoKGNlbGwpID0+IChjZWxsID8gY2VsbC50eXBlWzBdICsgY2VsbC5jb2xvclswXSA6IFwiICBcIikpLmpvaW4oXCJcIilcbiAgICApXG4gICAgLmpvaW4oXCJ8XCIpO1xufVxuXG5mdW5jdGlvbiB1cGRhdGVCb2FyZEhpc3RvcnkoKSB7XG4gIGJvYXJkSGlzdG9yeS5wdXNoKHNlcmlhbGl6ZUJvYXJkKGJvYXJkKSk7XG59XG5cbmZ1bmN0aW9uIGlzVGhyZWVmb2xkUmVwZXRpdGlvbigpIHtcbiAgbGV0IGNvdW50cyA9IHt9O1xuICBib2FyZEhpc3RvcnkuZm9yRWFjaCgoc3RhdGUpID0+IHtcbiAgICBjb3VudHNbc3RhdGVdID0gKGNvdW50c1tzdGF0ZV0gfHwgMCkgKyAxO1xuICB9KTtcbiAgcmV0dXJuIE9iamVjdC52YWx1ZXMoY291bnRzKS5zb21lKChjb3VudCkgPT4gY291bnQgPj0gMyk7XG59XG5cbmZ1bmN0aW9uIHVwZGF0ZUZpZnR5TW92ZUNvdW50ZXIobW92ZSkge1xuICBpZiAobW92ZS5waWVjZS50eXBlID09PSBcInBhd25cIiB8fCBib2FyZFttb3ZlLnRvLnJvd11bbW92ZS50by5jb2xdICE9PSBudWxsKSB7XG4gICAgZmlmdHlNb3ZlQ291bnRlciA9IDA7XG4gIH0gZWxzZSB7XG4gICAgZmlmdHlNb3ZlQ291bnRlcisrO1xuICB9XG59XG5cbmZ1bmN0aW9uIGlzRmlmdHlNb3ZlUnVsZSgpIHtcbiAgcmV0dXJuIGZpZnR5TW92ZUNvdW50ZXIgPj0gNTA7XG59XG5cbi8qIC0tLS0tIENIRUNLTUFURSAmIFNUQUxFTUFURSAtLS0tLSAqL1xuLy8gQ2hlY2ttYXRlOiB0aGUgY3VycmVudCBwbGF5ZXIncyBraW5nIGlzIGluIGNoZWNrIGFuZCBoYXMgbm8gbGVnYWwgbW92ZXMuXG5mdW5jdGlvbiBjaGVja0ZvckNoZWNrbWF0ZShib2FyZCwgY29sb3IpIHtcbiAgaWYgKCFpc0tpbmdTYWZlKGJvYXJkLCBjb2xvcikpIHtcbiAgICBsZXQgbW92ZXMgPSBnZW5lcmF0ZUFsbE1vdmVzKGJvYXJkLCBjb2xvcik7XG4gICAgbGV0IGxlZ2FsTW92ZXMgPSBtb3Zlcy5maWx0ZXIoKG0pID0+IGlzTGVnYWxNb3ZlKGJvYXJkLCBtLCBjb2xvcikpO1xuICAgIGlmIChsZWdhbE1vdmVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgY29uc29sZS5sb2coXCJDaGVja21hdGUgZGV0ZWN0ZWQgZm9yXCIsIGNvbG9yKTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgfVxuICByZXR1cm4gZmFsc2U7XG59XG5cbmZ1bmN0aW9uIGNoZWNrRm9yU3RhbGVtYXRlKGJvYXJkLCBjb2xvcikge1xuICBpZiAoaXNLaW5nU2FmZShib2FyZCwgY29sb3IpKSB7XG4gICAgbGV0IG1vdmVzID0gZ2VuZXJhdGVBbGxNb3Zlcyhib2FyZCwgY29sb3IpO1xuICAgIGxldCBsZWdhbE1vdmVzID0gbW92ZXMuZmlsdGVyKChtKSA9PiBpc0xlZ2FsTW92ZShib2FyZCwgbSwgY29sb3IpKTtcbiAgICBpZiAobGVnYWxNb3Zlcy5sZW5ndGggPT09IDApIHJldHVybiB0cnVlO1xuICB9XG4gIHJldHVybiBmYWxzZTtcbn1cblxuZnVuY3Rpb24gZ2VuZXJhdGVBbGxNb3Zlcyhib2FyZCwgY29sb3IpIHtcbiAgbGV0IG1vdmVzID0gW107XG4gIGZvciAobGV0IHIgPSAwOyByIDwgODsgcisrKSB7XG4gICAgZm9yIChsZXQgYyA9IDA7IGMgPCA4OyBjKyspIHtcbiAgICAgIGxldCBwaWVjZSA9IGJvYXJkW3JdW2NdO1xuICAgICAgaWYgKHBpZWNlICYmIHBpZWNlLmNvbG9yID09PSBjb2xvcikge1xuICAgICAgICBtb3ZlcyA9IG1vdmVzLmNvbmNhdChnZW5lcmF0ZU1vdmVzRm9yUGllY2UoYm9hcmQsIHsgcm93OiByLCBjb2w6IGMgfSkpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICByZXR1cm4gbW92ZXM7XG59XG5cbi8qIC0tLS0tIE1PVkUgVkFMSURBVElPTiAtLS0tLSAqL1xuZnVuY3Rpb24gaXNMZWdhbE1vdmUoYm9hcmQsIG1vdmUsIGNvbG9yKSB7XG4gIGxldCBtb3ZlcyA9IGdlbmVyYXRlTW92ZXNGb3JQaWVjZShib2FyZCwgbW92ZS5mcm9tKTtcbiAgbGV0IGxlZ2FsID0gbW92ZXMuc29tZShcbiAgICAobSkgPT4gbS50by5yb3cgPT09IG1vdmUudG8ucm93ICYmIG0udG8uY29sID09PSBtb3ZlLnRvLmNvbFxuICApO1xuICBpZiAoIWxlZ2FsKSB7XG4gICAgY29uc29sZS5sb2coXCJNb3ZlIG5vdCBpbiBnZW5lcmF0ZWQgbW92ZXM6XCIsIG1vdmUpO1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIGxldCBuZXdCb2FyZCA9IGNsb25lQm9hcmQoYm9hcmQpO1xuICBuZXdCb2FyZFttb3ZlLnRvLnJvd11bbW92ZS50by5jb2xdID0gbmV3Qm9hcmRbbW92ZS5mcm9tLnJvd11bbW92ZS5mcm9tLmNvbF07XG4gIG5ld0JvYXJkW21vdmUuZnJvbS5yb3ddW21vdmUuZnJvbS5jb2xdID0gbnVsbDtcblxuICBsZXQga2luZ1BvcyA9IGZpbmRLaW5nKG5ld0JvYXJkLCBjb2xvcik7XG4gIGlmICgha2luZ1Bvcykge1xuICAgIGNvbnNvbGUubG9nKFwiS2luZyBub3QgZm91bmQgYWZ0ZXIgbW92ZTpcIiwgbW92ZSk7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgaWYgKCFpc0tpbmdTYWZlKG5ld0JvYXJkLCBjb2xvcikpIHtcbiAgICBjb25zb2xlLmxvZyhcIktpbmcgd291bGQgYmUgaW4gY2hlY2sgYWZ0ZXIgbW92ZTpcIiwgbW92ZSwgXCJLaW5nIGF0OlwiLCBraW5nUG9zKTtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICByZXR1cm4gdHJ1ZTtcbn1cblxuLyogLS0tLS0gRU5EIEdBTUUgSU5JVElBTElaQVRJT04gLS0tLS0gKi9cbi8vIE9ubHkgaW5pdGlhbGl6ZSBpZiBydW5uaW5nIGluIGJyb3dzZXJcbmlmICh0eXBlb2YgcHJvY2VzcyA9PT0gJ3VuZGVmaW5lZCcgfHwgIXByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAndGVzdCcpIHtcbiAgaW5pdGlhbGl6ZUJvYXJkKCk7XG59XG5cblxuLy8gRXhwb3J0IGZvciBKZXN0IHRlc3Rpbmcgd2hpbGUgbWFpbnRhaW5pbmcgYnJvd3NlciBjb21wYXRpYmlsaXR5XG5pZiAodHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcgJiYgbW9kdWxlLmV4cG9ydHMpIHtcbiAgbW9kdWxlLmV4cG9ydHMgPSB7XG4gICAgaXNQcmltZSxcbiAgICBnZW5lcmF0ZVJvb2tNb3ZlcyxcbiAgICBnZW5lcmF0ZVBhd25Nb3ZlcyxcbiAgICBpc0xlZ2FsTW92ZSxcbiAgICBpbml0aWFsaXplQm9hcmQsXG4gICAgY2hlY2tGb3JDaGVja21hdGUsXG4gICAgaXNTcXVhcmVBdHRhY2tlZCxcbiAgICBzZXJpYWxpemVCb2FyZCxcbiAgICBjbG9uZUJvYXJkLFxuICAgIGdldE9wcG9uZW50LFxuICAgIHBlcmZvcm1DYXN0bGUsXG4gICAgY2FuQ2FzdGxlLFxuICAgIGlzRW5QYXNzYW50TW92ZSxcbiAgICBnZW5lcmF0ZU1vdmVzRm9yUGllY2UsXG4gICAgaXNJbkJvdW5kcyxcbiAgICBpc0tp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","map":{"version":3,"names":["boardElement","document","getElementById","promotionModal","promotionChoices","querySelectorAll","startGameBtn","gameModeSelect","whiteClockEl","blackClockEl","menuScreen","gameScreen","board","currentPlayer","selectedPiece","selectedPos","moveHistory","boardHistory","fiftyMoveCounter","enPassantTarget","whiteTime","blackTime","clockInterval","draggingPieceEl","dragOffset","x","y","dragStartPos","isPrime","n","i","Math","sqrt","startClock","clearInterval","setInterval","alert","resetGame","updateClockDisplay","innerText","formatTime","seconds","m","floor","s","addEventListener","initialTime","parseInt","value","style","display","initializeBoard","Array","fill","map","createPiece","drawBoard","updateBoardHistory","type","color","hasMoved","innerHTML","row","col","square","createElement","classList","add","dataset","isSquareAttacked","getOpponent","pieceEl","src","getPieceImageSrc","alt","onPieceMouseDown","appendChild","onSquareClick","piece","e","currentTarget","move","from","to","isLegalMove","makeMove","console","log","target","parentElement","cloneNode","body","rect","getBoundingClientRect","clientX","left","clientY","top","onMouseMove","onMouseUp","boardRect","abs","castle","removeChild","removeEventListener","isCastlingMove","performCastle","isEnPassantMove","performEnPassant","isLastRank","showPromotionModal","handlePawnDoubleStep","push","updateFiftyMoveCounter","checkForCheckmate","checkForStalemate","isThreefoldRepetition","isFiftyMoveRule","generateMovesForPiece","pos","moves","generatePawnMoves","generateRookMoves","generateKnightMoves","generateBishopMoves","generateRookMovesDefault","concat","generateKingMoves","generateCastlingMoves","direction","startRow","nextRow","isInBounds","dc","newCol","enPassant","directions","forEach","d","r","c","steps","offsets","o","destSquare","standardPathValid","modifiedPawnCount","modifiedPathValid","currentR","currentC","generateQueenMoves","king","canCastle","side","rook","isSquareSafeForKing","tempBoard","cloneBoard","isKingSafe","cell","kingPos","findKing","attackerColor","captureRow","fromRow","fromCol","toRow","toCol","pieceType","choice","selectedType","serializeBoard","join","counts","state","Object","values","some","count","generateAllMoves","legalMoves","filter","length","legal","newBoard","process","env","NODE_ENV","module","exports"],"sourceRoot":"/home/bayern/Chess_Temp/","sources":["gameController.js"],"sourcesContent":["/* \n  Modified Chess Game with Prime Rook Moves, Menu, Chess Clock, and Advanced Rules:\n  - Friendly rooks can only move a prime number of squares (allowed: 2, 3, 5, or 7).\n  - Queen moves remain standard.\n  - All other rules (castling, en passant, pawn promotion, etc.) remain unchanged.\n*/\n\n/* ----- DOM ELEMENTS ----- */\nconst boardElement = document.getElementById(\"chessboard\");\nconst promotionModal = document.getElementById(\"promotionModal\");\nconst promotionChoices = document.querySelectorAll(\".promotionChoice\");\nconst startGameBtn = document.getElementById(\"startGame\");\nconst gameModeSelect = document.getElementById(\"gameMode\");\nconst whiteClockEl = document.getElementById(\"whiteClock\");\nconst blackClockEl = document.getElementById(\"blackClock\");\nconst menuScreen = document.getElementById(\"menuScreen\");\nconst gameScreen = document.getElementById(\"gameScreen\");\n\n/* ----- GAME STATE VARIABLES ----- */\nlet board = [];\nlet currentPlayer = \"white\";\nlet selectedPiece = null;\nlet selectedPos = null;\nlet moveHistory = [];\nlet boardHistory = [];\nlet fiftyMoveCounter = 0;\nlet enPassantTarget = null;\n\n/* ----- CLOCK VARIABLES ----- */\nlet whiteTime = 0;\nlet blackTime = 0;\nlet clockInterval = null;\n\n/* ----- DRAGGING STATE ----- */\nlet draggingPieceEl = null;\nlet dragOffset = { x: 0, y: 0 };\nlet dragStartPos = null;\n\n/* ----- HELPER: Check if number is prime ----- */\nfunction isPrime(n) {\n  if (n < 2) return false;\n  for (let i = 2; i <= Math.sqrt(n); i++) {\n    if (n % i === 0) return false;\n  }\n  return true;\n}\n\n/* ----- CLOCK FUNCTIONS ----- */\nfunction startClock() {\n  clearInterval(clockInterval);\n  clockInterval = setInterval(() => {\n    if (currentPlayer === \"white\") {\n      whiteTime--;\n      if (whiteTime <= 0) {\n        clearInterval(clockInterval);\n        alert(\"Time's up! Black wins!\");\n        resetGame();\n        return;\n      }\n    } else {\n      blackTime--;\n      if (blackTime <= 0) {\n        clearInterval(clockInterval);\n        alert(\"Time's up! White wins!\");\n        resetGame();\n        return;\n      }\n    }\n    updateClockDisplay();\n  }, 1000);\n}\n\nfunction updateClockDisplay() {\n  whiteClockEl.innerText = formatTime(whiteTime);\n  blackClockEl.innerText = formatTime(blackTime);\n}\n\nfunction formatTime(seconds) {\n  let m = Math.floor(seconds / 60);\n  let s = seconds % 60;\n  return (m < 10 ? \"0\" + m : m) + \":\" + (s < 10 ? \"0\" + s : s);\n}\n\n/* ----- MENU AND GAME START ----- */\nstartGameBtn.addEventListener(\"click\", () => {\n  let initialTime = parseInt(gameModeSelect.value);\n  whiteTime = initialTime;\n  blackTime = initialTime;\n  updateClockDisplay();\n  menuScreen.style.display = \"none\";\n  gameScreen.style.display = \"block\";\n  initializeBoard();\n  startClock();\n});\n\n/* ----- INITIALIZATION ----- */\nfunction initializeBoard() {\n  board = Array(8)\n    .fill(null)\n    .map(() => Array(8).fill(null));\n  for (let i = 0; i < 8; i++) {\n    board[1][i] = createPiece(\"pawn\", \"black\");\n    board[6][i] = createPiece(\"pawn\", \"white\");\n  }\n  board[0][0] = createPiece(\"rook\", \"black\");\n  board[0][7] = createPiece(\"rook\", \"black\");\n  board[7][0] = createPiece(\"rook\", \"white\");\n  board[7][7] = createPiece(\"rook\", \"white\");\n  board[0][1] = createPiece(\"knight\", \"black\");\n  board[0][6] = createPiece(\"knight\", \"black\");\n  board[7][1] = createPiece(\"knight\", \"white\");\n  board[7][6] = createPiece(\"knight\", \"white\");\n  board[0][2] = createPiece(\"bishop\", \"black\");\n  board[0][5] = createPiece(\"bishop\", \"black\");\n  board[7][2] = createPiece(\"bishop\", \"white\");\n  board[7][5] = createPiece(\"bishop\", \"white\");\n  board[0][3] = createPiece(\"queen\", \"black\");\n  board[7][3] = createPiece(\"queen\", \"white\");\n  board[0][4] = createPiece(\"king\", \"black\");\n  board[7][4] = createPiece(\"king\", \"white\");\n\n  moveHistory = [];\n  boardHistory = [];\n  fiftyMoveCounter = 0;\n  enPassantTarget = null;\n  selectedPiece = null;\n  selectedPos = null;\n  currentPlayer = \"white\";\n\n  drawBoard();\n  updateBoardHistory();\n}\n\nfunction resetGame() {\n  clearInterval(clockInterval);\n  menuScreen.style.display = \"block\";\n  gameScreen.style.display = \"none\";\n  initializeBoard();\n}\n\n/* ----- PIECE CREATION ----- */\nfunction createPiece(type, color) {\n  return { type, color, hasMoved: false };\n}\n\n/* ----- DRAWING THE BOARD ----- */\nfunction drawBoard() {\n  boardElement.innerHTML = \"\";\n  for (let row = 0; row < 8; row++) {\n    for (let col = 0; col < 8; col++) {\n      let square = document.createElement(\"div\");\n      square.classList.add(\"square\");\n      square.dataset.row = row;\n      square.dataset.col = col;\n      square.classList.add((row + col) % 2 === 0 ? \"light\" : \"dark\");\n\n      if (selectedPos && selectedPos.row === row && selectedPos.col === col) {\n        square.classList.add(\"selected\");\n      }\n\n      if (board[row][col] && board[row][col].type === \"king\") {\n        if (isSquareAttacked(board, { row, col }, getOpponent(board[row][col].color))) {\n          square.classList.add(\"in-check\");\n        }\n      }\n\n      if (board[row][col]) {\n        let pieceEl = document.createElement(\"img\");\n        pieceEl.classList.add(\"piece-img\", board[row][col].color, board[row][col].type);\n        pieceEl.src = getPieceImageSrc(board[row][col]);\n        pieceEl.alt = board[row][col].type;\n        pieceEl.addEventListener(\"mousedown\", onPieceMouseDown);\n        square.appendChild(pieceEl);\n      }\n      square.addEventListener(\"click\", onSquareClick);\n      boardElement.appendChild(square);\n    }\n  }\n}\n\nfunction getPieceImageSrc(piece) {\n  return `assets/${piece.color}_${piece.type}.png`;\n}\n\n/* ----- CLICK HANDLING ----- */\nfunction onSquareClick(e) {\n  if (draggingPieceEl) return;\n\n  const row = parseInt(e.currentTarget.dataset.row);\n  const col = parseInt(e.currentTarget.dataset.col);\n\n  if (board[row][col] && board[row][col].color === currentPlayer) {\n    selectedPiece = board[row][col];\n    selectedPos = { row, col };\n  } else if (selectedPiece) {\n    let move = {\n      from: { row: selectedPos.row, col: selectedPos.col },\n      to: { row, col },\n      piece: selectedPiece,\n    };\n    if (isLegalMove(board, move, currentPlayer)) {\n      makeMove(move);\n    } else {\n      console.log(\"Illegal move attempted:\", move);\n    }\n    selectedPiece = null;\n    selectedPos = null;\n  }\n  drawBoard();\n}\n\n/* ----- DRAG-TO-MOVE HANDLING ----- */\nfunction onPieceMouseDown(e) {\n  const square = e.target.parentElement;\n  const row = parseInt(square.dataset.row);\n  const col = parseInt(square.dataset.col);\n\n  if (board[row][col].color !== currentPlayer) return;\n\n  selectedPiece = board[row][col];\n  selectedPos = { row, col };\n  dragStartPos = { row, col };\n\n  draggingPieceEl = e.target.cloneNode(true);\n  draggingPieceEl.classList.add(\"dragging\");\n  document.body.appendChild(draggingPieceEl);\n\n  const rect = e.target.getBoundingClientRect();\n  dragOffset.x = e.clientX - rect.left;\n  dragOffset.y = e.clientY - rect.top;\n\n  drawBoard();\n\n  document.addEventListener(\"mousemove\", onMouseMove);\n  document.addEventListener(\"mouseup\", onMouseUp);\n}\n\nfunction onMouseMove(e) {\n  if (draggingPieceEl) {\n    draggingPieceEl.style.left = e.clientX - dragOffset.x + \"px\";\n    draggingPieceEl.style.top = e.clientY - dragOffset.y + \"px\";\n  }\n}\n\nfunction onMouseUp(e) {\n  if (!draggingPieceEl) return;\n\n  const boardRect = boardElement.getBoundingClientRect();\n  const x = e.clientX - boardRect.left;\n  const y = e.clientY - boardRect.top;\n  const col = Math.floor(x / 80);\n  const row = Math.floor(y / 80);\n\n  if (row >= 0 && row < 8 && col >= 0 && col < 8) {\n    let move = {\n      from: { row: dragStartPos.row, col: dragStartPos.col },\n      to: { row, col },\n      piece: selectedPiece,\n    };\n    // Detect castling: if king moves two squares horizontally\n    if (\n      move.piece.type === \"king\" &&\n      Math.abs(move.to.col - move.from.col) === 2\n    ) {\n      move.castle = move.to.col > move.from.col ? \"kingside\" : \"queenside\";\n    }\n    if (isLegalMove(board, move, currentPlayer)) {\n      makeMove(move);\n    } else {\n      console.log(\"Illegal move attempted via drag:\", move);\n    }\n  }\n\n  document.body.removeChild(draggingPieceEl);\n  draggingPieceEl = null;\n  dragStartPos = null;\n  selectedPiece = null;\n  selectedPos = null;\n  document.removeEventListener(\"mousemove\", onMouseMove);\n  document.removeEventListener(\"mouseup\", onMouseUp);\n  drawBoard();\n}\n\n/* ----- MAKING MOVES ----- */\nfunction makeMove(move) {\n  if (isCastlingMove(move)) {\n    performCastle(move);\n  } else if (isEnPassantMove(move)) {\n    performEnPassant(move);\n  } else {\n    board[move.to.row][move.to.col] = move.piece;\n    board[move.from.row][move.from.col] = null;\n    if (move.piece.type === \"pawn\" && isLastRank(move.to, move.piece.color)) {\n      showPromotionModal(move);\n      return;\n    }\n  }\n  move.piece.hasMoved = true;\n  handlePawnDoubleStep(move);\n  moveHistory.push(move);\n  updateFiftyMoveCounter(move);\n  updateBoardHistory();\n\n  // Switch turn. currentPlayer becomes the player who is about to move.\n  currentPlayer = getOpponent(currentPlayer);\n  startClock();\n\n  // FIXED: Check for checkmate on the current player's turn\n  if (checkForCheckmate(board, currentPlayer)) {\n    alert(\"Checkmate! \" + getOpponent(currentPlayer) + \" wins.\");\n    clearInterval(clockInterval);\n    resetGame();\n    return;\n  } else if (checkForStalemate(board, currentPlayer)) {\n    alert(\"Stalemate!\");\n    clearInterval(clockInterval);\n    resetGame();\n    return;\n  } else if (isThreefoldRepetition()) {\n    alert(\"Draw by threefold repetition!\");\n    clearInterval(clockInterval);\n    resetGame();\n    return;\n  } else if (isFiftyMoveRule()) {\n    alert(\"Draw by fifty-move rule!\");\n    clearInterval(clockInterval);\n    resetGame();\n    return;\n  }\n\n  selectedPiece = null;\n  selectedPos = null;\n  drawBoard();\n}\n\n/* ----- MOVE GENERATION ----- */\nfunction generateMovesForPiece(board, pos) {\n  let piece = board[pos.row][pos.col];\n  if (!piece) return [];\n  let moves = [];\n  switch (piece.type) {\n    case \"pawn\":\n      moves = generatePawnMoves(board, pos, piece);\n      break;\n    case \"rook\":\n      // Friendly rooks: restrict moves to prime number of squares.\n      moves = generateRookMoves(board, pos, piece);\n      break;\n    case \"knight\":\n      moves = generateKnightMoves(board, pos, piece);\n      break;\n    case \"bishop\":\n      moves = generateBishopMoves(board, pos, piece);\n      break;\n    case \"queen\":\n      // For queen, use default rook moves (no prime restriction) plus bishop moves.\n      moves = generateRookMovesDefault(board, pos, piece).concat(\n        generateBishopMoves(board, pos, piece)\n      );\n      break;\n    case \"king\":\n      moves = generateKingMoves(board, pos, piece);\n      moves = moves.concat(generateCastlingMoves(board, pos, piece));\n      break;\n  }\n  return moves;\n}\n\nfunction generatePawnMoves(board, pos, piece) {\n  let moves = [];\n  let direction = piece.color === \"white\" ? -1 : 1;\n  let startRow = piece.color === \"white\" ? 6 : 1;\n  let nextRow = pos.row + direction;\n  if (isInBounds(nextRow, pos.col) && board[nextRow][pos.col] === null) {\n    moves.push({ from: pos, to: { row: nextRow, col: pos.col }, piece });\n    if (\n      pos.row === startRow &&\n      isInBounds(nextRow + direction, pos.col) &&\n      board[nextRow + direction][pos.col] === null\n    ) {\n      moves.push({\n        from: pos,\n        to: { row: nextRow + direction, col: pos.col },\n        piece,\n      });\n    }\n  }\n  for (let dc of [-1, 1]) {\n    let newCol = pos.col + dc;\n    if (isInBounds(nextRow, newCol)) {\n      if (board[nextRow][newCol] && board[nextRow][newCol].color !== piece.color) {\n        moves.push({ from: pos, to: { row: nextRow, col: newCol }, piece });\n      }\n      if (\n        board[nextRow][newCol] === null &&\n        enPassantTarget &&\n        enPassantTarget.row === nextRow &&\n        enPassantTarget.col === newCol\n      ) {\n        moves.push({ from: pos, to: { row: nextRow, col: newCol }, piece, enPassant: true });\n      }\n    }\n  }\n  return moves;\n}\n\n/* Modified Rook Moves: For friendly rooks, allow moves only if the number of squares moved is prime (2, 3, 5, or 7) */\nfunction generateRookMoves(board, pos, piece) {\n  let moves = [];\n  let directions = [\n    [1, 0],\n    [-1, 0],\n    [0, 1],\n    [0, -1],\n  ];\n  directions.forEach((d) => {\n    let r = pos.row;\n    let c = pos.col;\n    let steps = 0;\n    while (true) {\n      r += d[0];\n      c += d[1];\n      steps++;\n      if (!isInBounds(r, c)) break;\n      if (isPrime(steps)) {\n        if (board[r][c] === null) {\n          moves.push({ from: pos, to: { row: r, col: c }, piece });\n        } else {\n          if (board[r][c].color !== piece.color) {\n            moves.push({ from: pos, to: { row: r, col: c }, piece });\n          }\n          break;\n        }\n      } else {\n        if (board[r][c] !== null) break;\n      }\n    }\n  });\n  return moves;\n}\n\n/* Default Rook Moves for queen moves and enemy attack detection (no prime restriction) */\nfunction generateRookMovesDefault(board, pos, piece) {\n  let moves = [];\n  let directions = [\n    [1, 0],\n    [-1, 0],\n    [0, 1],\n    [0, -1],\n  ];\n  directions.forEach((d) => {\n    let r = pos.row;\n    let c = pos.col;\n    while (true) {\n      r += d[0];\n      c += d[1];\n      if (!isInBounds(r, c)) break;\n      if (board[r][c] === null) {\n        moves.push({ from: pos, to: { row: r, col: c }, piece });\n      } else {\n        moves.push({ from: pos, to: { row: r, col: c }, piece });\n        break;\n      }\n    }\n  });\n  return moves;\n}\n\nfunction generateKnightMoves(board, pos, piece) {\n  let moves = [];\n  let offsets = [\n    [-2, -1],\n    [-2, 1],\n    [-1, -2],\n    [-1, 2],\n    [1, -2],\n    [1, 2],\n    [2, -1],\n    [2, 1],\n  ];\n  offsets.forEach((o) => {\n    let r = pos.row + o[0];\n    let c = pos.col + o[1];\n    if (isInBounds(r, c) && (!board[r][c] || board[r][c].color !== piece.color)) {\n      moves.push({ from: pos, to: { row: r, col: c }, piece });\n    }\n  });\n  return moves;\n}\n\nfunction generateBishopMoves(board, pos, piece) {\n  let moves = [];\n  let directions = [\n    [1, 1],\n    [1, -1],\n    [-1, 1],\n    [-1, -1],\n  ];\n  directions.forEach((d) => {\n    for (let steps = 1; steps < 8; steps++) {\n      let r = pos.row + d[0] * steps;\n      let c = pos.col + d[1] * steps;\n      if (!isInBounds(r, c)) break;\n\n      // Skip if destination is occupied by a friendly piece\n      let destSquare = board[r][c];\n      if (destSquare && destSquare.color === piece.color) continue;\n\n      let standardPathValid = true;\n      let modifiedPawnCount = 0;\n      let modifiedPathValid = true;\n\n      // Check standard path validity (all intermediate squares empty)\n      for (let s = 1; s < steps; s++) {\n        let currentR = pos.row + d[0] * s;\n        let currentC = pos.col + d[1] * s;\n        if (board[currentR][currentC] !== null) {\n          standardPathValid = false;\n          break;\n        }\n      }\n\n      // Check modified path validity (exactly one pawn in intermediate squares)\n      for (let s = 1; s < steps; s++) {\n        let currentR = pos.row + d[0] * s;\n        let currentC = pos.col + d[1] * s;\n        let square = board[currentR][currentC];\n        if (square) {\n          if (square.type === 'pawn') {\n            modifiedPawnCount++;\n            if (modifiedPawnCount > 1) {\n              modifiedPathValid = false;\n              break;\n            }\n          } else {\n            modifiedPathValid = false;\n            break;\n          }\n        }\n      }\n      modifiedPathValid = modifiedPathValid && modifiedPawnCount === 1;\n\n      // Add move if either path is valid\n      if (standardPathValid || modifiedPathValid) {\n        moves.push({ from: pos, to: { row: r, col: c }, piece });\n      }\n    }\n  });\n  return moves;\n}\n\nfunction generateQueenMoves(board, pos, piece) {\n  // Queen moves = default rook moves (no prime restriction) + bishop moves\n  return generateRookMovesDefault(board, pos, piece).concat(\n    generateBishopMoves(board, pos, piece)\n  );\n}\n\nfunction generateKingMoves(board, pos, piece) {\n  let moves = [];\n  for (let r = pos.row - 1; r <= pos.row + 1; r++) {\n    for (let c = pos.col - 1; c <= pos.col + 1; c++) {\n      if (r === pos.row && c === pos.col) continue;\n      if (isInBounds(r, c) && (!board[r][c] || board[r][c].color !== piece.color)) {\n        moves.push({ from: pos, to: { row: r, col: c }, piece });\n      }\n    }\n  }\n  return moves;\n}\n\nfunction generateCastlingMoves(board, pos, king) {\n  let moves = [];\n  if (king.hasMoved) return moves;\n  if (canCastle(board, king, { side: \"kingside\", pos })) {\n    moves.push({\n      from: pos,\n      to: { row: pos.row, col: pos.col + 2 },\n      piece: king,\n      castle: \"kingside\",\n    });\n  }\n  if (canCastle(board, king, { side: \"queenside\", pos })) {\n    moves.push({\n      from: pos,\n      to: { row: pos.row, col: pos.col - 2 },\n      piece: king,\n      castle: \"queenside\",\n    });\n  }\n  return moves;\n}\n\n/* ----- CASTLING LOGIC ----- */\nfunction canCastle(board, king, { side, pos }) {\n  let row = pos.row;\n  if (king.hasMoved) return false;\n  if (side === \"kingside\") {\n    let rook = board[row][7];\n    if (!rook || rook.type !== \"rook\" || rook.hasMoved) return false;\n    if (board[row][5] !== null || board[row][6] !== null) return false;\n    if (\n      !isSquareSafeForKing(board, { row, col: 4 }, king.color) ||\n      !isSquareSafeForKing(board, { row, col: 5 }, king.color) ||\n      !isSquareSafeForKing(board, { row, col: 6 }, king.color)\n    )\n      return false;\n    return true;\n  } else if (side === \"queenside\") {\n    let rook = board[row][0];\n    if (!rook || rook.type !== \"rook\" || rook.hasMoved) return false;\n    if (board[row][1] !== null || board[row][2] !== null || board[row][3] !== null)\n      return false;\n    if (\n      !isSquareSafeForKing(board, { row, col: 4 }, king.color) ||\n      !isSquareSafeForKing(board, { row, col: 3 }, king.color) ||\n      !isSquareSafeForKing(board, { row, col: 2 }, king.color)\n    )\n      return false;\n    return true;\n  }\n  return false;\n}\n\nfunction isSquareSafeForKing(board, pos, color) {\n  let tempBoard = cloneBoard(board);\n  tempBoard[pos.row][pos.col] = { type: \"king\", color, hasMoved: true };\n  return isKingSafe(tempBoard, color);\n}\n\n/* ----- HELPER FUNCTIONS ----- */\nfunction isInBounds(row, col) {\n  return row >= 0 && row < 8 && col >= 0 && col < 8;\n}\n\nfunction cloneBoard(board) {\n  return board.map((row) => row.map((cell) => (cell ? { ...cell } : null)));\n}\n\nfunction isKingSafe(board, color) {\n  let kingPos = findKing(board, color);\n  if (!kingPos) return false;\n  return !isSquareAttacked(board, kingPos, getOpponent(color));\n}\n\nfunction findKing(board, color) {\n  for (let r = 0; r < 8; r++) {\n    for (let c = 0; c < 8; c++) {\n      let piece = board[r][c];\n      if (piece && piece.type === \"king\" && piece.color === color) {\n        return { row: r, col: c };\n      }\n    }\n  }\n  return null;\n}\n\nfunction isSquareAttacked(board, pos, attackerColor) {\n  for (let r = 0; r < 8; r++) {\n    for (let c = 0; c < 8; c++) {\n      let piece = board[r][c];\n      if (piece && piece.color === attackerColor) {\n        let moves;\n        if (piece.type === \"rook\") {\n          // For enemy rooks, use full-range moves (default) for attack detection.\n          moves = generateRookMovesDefault(board, { row: r, col: c }, piece);\n        } else {\n          moves = generateMovesForPiece(board, { row: r, col: c });\n        }\n        for (let move of moves) {\n          if (move.to.row === pos.row && move.to.col === pos.col) return true;\n        }\n      }\n    }\n  }\n  return false;\n}\n\nfunction getOpponent(color) {\n  return color === \"white\" ? \"black\" : \"white\";\n}\n\n/* ----- EN PASSANT LOGIC ----- */\nfunction handlePawnDoubleStep(move) {\n  if (\n    move.piece.type === \"pawn\" &&\n    Math.abs(move.from.row - move.to.row) === 2\n  ) {\n    enPassantTarget = {\n      row: (move.from.row + move.to.row) / 2,\n      col: move.from.col,\n    };\n  } else {\n    enPassantTarget = null;\n  }\n}\n\nfunction isEnPassantMove(move) {\n  return (\n    move.piece.type === \"pawn\" &&\n    move.from.col !== move.to.col &&\n    board[move.to.row][move.to.col] === null\n  );\n}\n\nfunction performEnPassant(move) {\n  board[move.to.row][move.to.col] = move.piece;\n  board[move.from.row][move.from.col] = null;\n  let captureRow = move.piece.color === \"white\" ? move.to.row + 1 : move.to.row - 1;\n  board[captureRow][move.to.col] = null;\n}\n\n/* ----- CASTLING HANDLING ----- */\nfunction isCastlingMove(move) {\n  return (\n    move.piece.type === \"king\" && Math.abs(move.to.col - move.from.col) === 2\n  );\n}\n\nfunction performCastle(move) {\n  let row = move.from.row;\n  if (move.castle === \"kingside\") {\n    board[row][6] = move.piece;\n    board[row][4] = null;\n    let rook = board[row][7];\n    board[row][5] = rook;\n    board[row][7] = null;\n    rook.hasMoved = true;\n  } else if (move.castle === \"queenside\") {\n    board[row][2] = move.piece;\n    board[row][4] = null;\n    let rook = board[row][0];\n    board[row][3] = rook;\n    board[row][0] = null;\n    rook.hasMoved = true;\n  }\n}\n\n/* ----- PAWN PROMOTION ----- */\nfunction isLastRank(pos, color) {\n  return (color === \"white\" && pos.row === 0) || (color === \"black\" && pos.row === 7);\n}\n\nfunction showPromotionModal(move) {\n  promotionModal.style.display = \"block\";\n  promotionModal.dataset.fromRow = move.from.row;\n  promotionModal.dataset.fromCol = move.from.col;\n  promotionModal.dataset.toRow = move.to.row;\n  promotionModal.dataset.toCol = move.to.col;\n  promotionModal.dataset.color = move.piece.color;\n  promotionModal.dataset.pieceType = move.piece.type;\n}\n\npromotionChoices.forEach((choice) => {\n  choice.addEventListener(\"click\", function () {\n    let selectedType = this.dataset.type;\n    let move = {\n      from: {\n        row: parseInt(promotionModal.dataset.fromRow),\n        col: parseInt(promotionModal.dataset.fromCol),\n      },\n      to: {\n        row: parseInt(promotionModal.dataset.toRow),\n        col: parseInt(promotionModal.dataset.toCol),\n      },\n      piece: {\n        type: promotionModal.dataset.pieceType,\n        color: promotionModal.dataset.color,\n      },\n    };\n    board[move.to.row][move.to.col] = createPiece(selectedType, move.piece.color);\n    board[move.from.row][move.from.col] = null;\n    promotionModal.style.display = \"none\";\n    board[move.to.row][move.to.col].hasMoved = true;\n    moveHistory.push(move);\n    updateFiftyMoveCounter(move);\n    updateBoardHistory();\n    if (checkForCheckmate(board, getOpponent(currentPlayer))) {\n      alert(\"Checkmate! \" + getOpponent(currentPlayer) + \" wins.\");\n      clearInterval(clockInterval);\n      resetGame();\n      return;\n    } else if (checkForStalemate(board, getOpponent(currentPlayer))) {\n      alert(\"Stalemate!\");\n      clearInterval(clockInterval);\n      resetGame();\n      return;\n    }\n    currentPlayer = getOpponent(currentPlayer);\n    startClock();\n    selectedPiece = null;\n    selectedPos = null;\n    drawBoard();\n  });\n});\n\n/* ----- BOARD HISTORY & DRAWING RULES ----- */\nfunction serializeBoard(board) {\n  return board\n    .map((row) =>\n      row.map((cell) => (cell ? cell.type[0] + cell.color[0] : \"  \")).join(\"\")\n    )\n    .join(\"|\");\n}\n\nfunction updateBoardHistory() {\n  boardHistory.push(serializeBoard(board));\n}\n\nfunction isThreefoldRepetition() {\n  let counts = {};\n  boardHistory.forEach((state) => {\n    counts[state] = (counts[state] || 0) + 1;\n  });\n  return Object.values(counts).some((count) => count >= 3);\n}\n\nfunction updateFiftyMoveCounter(move) {\n  if (move.piece.type === \"pawn\" || board[move.to.row][move.to.col] !== null) {\n    fiftyMoveCounter = 0;\n  } else {\n    fiftyMoveCounter++;\n  }\n}\n\nfunction isFiftyMoveRule() {\n  return fiftyMoveCounter >= 50;\n}\n\n/* ----- CHECKMATE & STALEMATE ----- */\n// Checkmate: the current player's king is in check and has no legal moves.\nfunction checkForCheckmate(board, color) {\n  if (!isKingSafe(board, color)) {\n    let moves = generateAllMoves(board, color);\n    let legalMoves = moves.filter((m) => isLegalMove(board, m, color));\n    if (legalMoves.length === 0) {\n      console.log(\"Checkmate detected for\", color);\n      return true;\n    }\n  }\n  return false;\n}\n\nfunction checkForStalemate(board, color) {\n  if (isKingSafe(board, color)) {\n    let moves = generateAllMoves(board, color);\n    let legalMoves = moves.filter((m) => isLegalMove(board, m, color));\n    if (legalMoves.length === 0) return true;\n  }\n  return false;\n}\n\nfunction generateAllMoves(board, color) {\n  let moves = [];\n  for (let r = 0; r < 8; r++) {\n    for (let c = 0; c < 8; c++) {\n      let piece = board[r][c];\n      if (piece && piece.color === color) {\n        moves = moves.concat(generateMovesForPiece(board, { row: r, col: c }));\n      }\n    }\n  }\n  return moves;\n}\n\n/* ----- MOVE VALIDATION ----- */\nfunction isLegalMove(board, move, color) {\n  let moves = generateMovesForPiece(board, move.from);\n  let legal = moves.some(\n    (m) => m.to.row === move.to.row && m.to.col === move.to.col\n  );\n  if (!legal) {\n    console.log(\"Move not in generated moves:\", move);\n    return false;\n  }\n\n  let newBoard = cloneBoard(board);\n  newBoard[move.to.row][move.to.col] = newBoard[move.from.row][move.from.col];\n  newBoard[move.from.row][move.from.col] = null;\n\n  let kingPos = findKing(newBoard, color);\n  if (!kingPos) {\n    console.log(\"King not found after move:\", move);\n    return false;\n  }\n\n  if (!isKingSafe(newBoard, color)) {\n    console.log(\"King would be in check after move:\", move, \"King at:\", kingPos);\n    return false;\n  }\n\n  return true;\n}\n\n/* ----- END GAME INITIALIZATION ----- */\n// Only initialize if running in browser\nif (typeof process === 'undefined' || !process.env.NODE_ENV === 'test') {\n  initializeBoard();\n}\n\n\n// Export for Jest testing while maintaining browser compatibility\nif (typeof module !== 'undefined' && module.exports) {\n  module.exports = {\n    isPrime,\n    generateRookMoves,\n    generatePawnMoves,\n    isLegalMove,\n    initializeBoard,\n    checkForCheckmate,\n    isSquareAttacked,\n    serializeBoard,\n    cloneBoard,\n    getOpponent,\n    performCastle,\n    canCastle,\n    isEnPassantMove,\n    generateMovesForPiece,\n    isInBounds,\n    isKingSafe,\n    createPiece,\n    enPassantTarget\n  };\n}"],"mappings":"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","ignoreList":[]}},"mtime":1743345741490}}